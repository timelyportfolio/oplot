// @observablehq/plot v0.6.13 Copyright 2020-2023 Observable, Inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3@7.8.5/dist/d3.min.js")):"function"==typeof define&&define.amd?define(["exports","d3@7.8.5/dist/d3.min.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Plot=t.Plot||{},t.d3)}(this,(function(t,e){"use strict";function n(t){return null!=t&&!Number.isNaN(t)}function r(t,r){return+n(r)-+n(t)||e.ascending(t,r)}function o(t,r){return+n(r)-+n(t)||e.descending(t,r)}function i(t){return null!=t&&""!=`${t}`}function a(t){return isFinite(t)?t:NaN}function l(t){return t>0&&isFinite(t)?t:NaN}function s(t){return t<0&&isFinite(t)?t:NaN}function c(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),r=t.getUTCMinutes(),o=t.getUTCSeconds(),i=t.getUTCMilliseconds();return`${a=t.getUTCFullYear(),a<0?`-${u(-a,6)}`:a>9999?`+${u(a,6)}`:u(a,4)}-${u(t.getUTCMonth()+1,2)}-${u(t.getUTCDate(),2)}${n||r||o||i?`T${u(n,2)}:${u(r,2)}${o||i?`:${u(o,2)}${i?`.${u(i,3)}`:""}`:""}Z`:""}`;var a}function u(t,e){return`${t}`.padStart(e,"0")}const f=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function h(t,e){return f.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const d=1e3,p=6e4,m=36e5,y=864e5,g=7*y,v=30*y,x=365*y,w=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",d],["5 seconds",5e3],["15 seconds",15e3],["30 seconds",3e4],["minute",p],["5 minutes",3e5],["15 minutes",9e5],["30 minutes",18e5],["hour",m],["3 hours",108e5],["6 hours",216e5],["12 hours",432e5],["day",y],["2 days",2*y],["week",g],["2 weeks",2*g],["month",v],["3 months",3*v],["6 months",6*v],["year",x],["2 years",2*x],["5 years",5*x],["10 years",10*x],["20 years",20*x],["50 years",50*x],["100 years",100*x]],b=new Map([["second",d],["minute",p],["hour",m],["day",y],["monday",g],["tuesday",g],["wednesday",g],["thursday",g],["friday",g],["saturday",g],["sunday",g],["week",g],["month",v],["year",x]]),k=new Map([["second",e.timeSecond],["minute",e.timeMinute],["hour",e.timeHour],["day",e.timeDay],["monday",e.timeMonday],["tuesday",e.timeTuesday],["wednesday",e.timeWednesday],["thursday",e.timeThursday],["friday",e.timeFriday],["saturday",e.timeSaturday],["sunday",e.timeSunday],["week",e.timeWeek],["month",e.timeMonth],["year",e.timeYear]]),$=new Map([["second",e.utcSecond],["minute",e.utcMinute],["hour",e.utcHour],["day",e.unixDay],["monday",e.utcMonday],["tuesday",e.utcTuesday],["wednesday",e.utcWednesday],["thursday",e.utcThursday],["friday",e.utcFriday],["saturday",e.utcSaturday],["sunday",e.utcSunday],["week",e.utcWeek],["month",e.utcMonth],["year",e.utcYear]]),M=Symbol("intervalDuration"),L=Symbol("intervalType");for(const[t,e]of k)e[M]=b.get(t),e[L]="time";for(const[t,e]of $)e[M]=b.get(t),e[L]="utc";const A=[["year",e.utcYear,"utc"],["month",e.utcMonth,"utc"],["day",e.unixDay,"utc",6*v],["hour",e.utcHour,"utc",3*y],["minute",e.utcMinute,"utc",216e5],["second",e.utcSecond,"utc",18e5]],S=[["year",e.timeYear,"time"],["month",e.timeMonth,"time"],["day",e.timeDay,"time",6*v],["hour",e.timeHour,"time",3*y],["minute",e.timeMinute,"time",216e5],["second",e.timeSecond,"time",18e5]],z=[A[0],S[0],A[1],S[1],A[2],S[2],...A.slice(3)];function O(t){let e=`${t}`.toLowerCase();e.endsWith("s")&&(e=e.slice(0,-1));let n=1;const r=/^(?:(\d+)\s+)/.exec(e);switch(r&&(e=e.slice(r[0].length),n=+r[1]),e){case"quarter":e="month",n*=3;break;case"half":e="month",n*=6}let o=$.get(e);if(!o)throw new Error(`unknown interval: ${t}`);if(n>1&&!o.every)throw new Error(`non-periodic interval: ${e}`);return[e,n]}function E(t){return C(O(t),"time")}function R(t){return C(O(t),"utc")}function C([t,e],n){let r=("time"===n?k:$).get(t);return e>1&&(r=r.every(e),r[M]=b.get(t)*e,r[L]=n),r}function T(t,n){if(!(n>1))return;const r=t[M];if(!w.some((([,t])=>t===r)))return;if(r%y==0&&y<r&&r<v)return;const[o]=w[e.bisector((([,t])=>Math.log(t))).center(w,Math.log(r*n))];return("time"===t[L]?E:R)(o)}function B(t,n,r){const o="time"===n?e.timeFormat:e.utcFormat;if(null==r)return o("year"===t?"%Y":"month"===t?"%Y-%m":"day"===t?"%Y-%m-%d":"hour"===t||"minute"===t?"%Y-%m-%dT%H:%M":"second"===t?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const i=function(t){return"left"===t||"right"===t?(t,e)=>`\n${t}\n${e}`:"top"===t?(t,e)=>`${e}\n${t}`:(t,e)=>`${t}\n${e}`}(r);switch(t){case"millisecond":return I(o(".%L"),o(":%M:%S"),i);case"second":return I(o(":%S"),o("%-I:%M"),i);case"minute":return I(o("%-I:%M"),o("%p"),i);case"hour":return I(o("%-I %p"),o("%b %-d"),i);case"day":return I(o("%-d"),o("%b"),i);case"month":return I(o("%b"),o("%Y"),i);case"year":return o("%Y")}throw new Error("unable to format time ticks")}function N(t,n,r){const o=e.max(e.pairs(n,((t,e)=>Math.abs(e-t))));if(o<1e3)return B("millisecond","utc",r);for(const[e,i,a,l]of function(t){return"time"===t?S:"utc"===t?A:z}(t)){if(o>l)break;if("hour"===e&&!o)break;if(n.every((t=>i.floor(t)>=t)))return B(e,a,r)}}function I(t,e,n){return(r,o,i)=>{const a=t(r,o),l=e(r,o),s=o-ee(i);return o!==s&&void 0!==i[s]&&l===e(i[s],s)?a:n(a,l)}}const P=Object.getPrototypeOf(Uint8Array),W=Object.prototype.toString,j=Symbol("reindex");function q(t,e,n){const r=typeof e;return"string"===r?F(t,_(e),n):"function"===r?F(t,e,n):"number"===r||e instanceof Date||"boolean"===r?ht(t,tt(e),n):"function"==typeof e?.transform?D(e.transform(t),n):function(t,e){return e?Lt(t,e):t}(D(e,n),t?.[j])}function F(t,e,n){return ht(t,n?.prototype instanceof P?function(t){return(e,n)=>rt(t(e,n))}(e):e,n)}function D(t,e){return void 0===e?ft(t):t instanceof e?t:e.prototype instanceof P&&!(t instanceof P)?e.from(t,rt):e.from(t)}const Y=[null],_=t=>e=>e[t],G={transform:Mt},X={transform:t=>t},U=()=>1,H=()=>!0,V=t=>null==t?t:`${t}`,Z=t=>null==t?t:+t,Q=t=>t?t[0]:void 0,J=t=>t?t[1]:void 0,K=t=>t?t[2]:void 0,tt=t=>()=>t;function et(t){const n=+`${t}`.slice(1)/100;return(t,r)=>e.quantile(t,n,r)}function nt(t){return t instanceof P?t:ht(t,rt,Float64Array)}function rt(t){return null==t?NaN:Number(t)}function ot(t){return ht(t,at)}function at(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?h(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function lt(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:Vt(t)?[void 0,t]:[t,void 0]}function st(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function ct(t,e,n){if(null!=t)return ut(t,e,n)}function ut(t,e,n){const r=`${t}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${e}: ${t}`);return r}function ft(t){return null==t||t instanceof Array||t instanceof P?t:Array.from(t)}function ht(t,e,n=Array){return null==t?t:t instanceof n?t.map(e):n.from(t,e)}function dt(t,e=Array){return t instanceof e?t.slice():e.from(t)}function pt({x:t,x1:e,x2:n}){return void 0!==t||void 0!==e||void 0!==n}function mt({y:t,y1:e,y2:n}){return void 0!==t||void 0!==e||void 0!==n}function yt(t){return pt(t)||mt(t)||void 0!==t.interval}function gt(t){return t?.toString===W}function vt(t){return gt(t)&&(void 0!==t.type||void 0!==t.domain)}function xt(t){return gt(t)&&"function"!=typeof t.transform}function wt(t){return xt(t)&&void 0===t.value&&void 0===t.channel}function bt(t,e,n,r=X){return void 0===e&&void 0===n?(e=0,n=void 0===t?r:t):void 0===e?e=void 0===t?0:t:void 0===n&&(n=void 0===t?0:t),[e,n]}function kt(t,e){return void 0===t&&void 0===e?[Q,J]:[t,e]}function $t({z:t,fill:e,stroke:n}={}){return void 0===t&&([t]=lt(e)),void 0===t&&([t]=lt(n)),t}function Mt(t){const e=t.length,n=new Uint32Array(e);for(let t=0;t<e;++t)n[t]=t;return n}function Lt(t,e){return ht(e,(e=>t[e]),t.constructor)}function At(t){return 1===t.length?(e,n)=>t(Lt(n,e)):t}function St(t,e,n){return t.subarray?t.subarray(e,n):t.slice(e,n)}function zt(t){return null!==t&&"object"==typeof t?t.valueOf():t}function Ot(t,e){if(void 0!==e[t])return e[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return e[t]}function Et(t){let e;return[{transform:()=>e,label:Ct(t)},t=>e=t]}function Rt(t){return null==t?[t]:Et(t)}function Ct(t,e){return"string"==typeof t?t:t&&void 0!==t.label?t.label:e}function Tt(t,e){return{transform(n){const r=t.transform(n),o=e.transform(n);return Yt(r)||Yt(o)?ht(r,((t,e)=>new Date((+r[e]+ +o[e])/2))):ht(r,((t,e)=>(+r[e]+ +o[e])/2),Float64Array)},label:t.label}}function Bt(t,e){const n=Nt(e?.interval,e?.type);return n?ht(t,n):t}function Nt(t,e){const r=It(t,e);return r&&(t=>n(t)?r.floor(t):t)}function It(t,n){if(null!=t){if("number"==typeof t){0<t&&t<1&&Number.isInteger(1/t)&&(t=-1/t);const n=Math.abs(t);return t<0?{floor:t=>Math.floor(t*n)/n,offset:t=>(t*n+1)/n,range:(t,r)=>e.range(Math.ceil(t*n),r*n).map((t=>t/n))}:{floor:t=>Math.floor(t/n)*n,offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>t*n))}}if("string"==typeof t)return("time"===n?E:R)(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function Pt(t,e){if((t=It(t,e))&&"function"!=typeof t.range)throw new Error("invalid interval: missing range method");return t}function Wt(t){return"function"==typeof t?.range}function jt(t){return void 0===t||xt(t)?t:{value:t}}function qt(t){return t&&"function"==typeof t[Symbol.iterator]}function Ft(t){for(const e of t)if(null!=e)return"object"!=typeof e||e instanceof Date}function Dt(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function Yt(t){for(const e of t)if(null!=e)return e instanceof Date}function _t(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&h(e)}function Gt(t){for(const e of t)if(null!=e){if("string"!=typeof e)return!1;if(e.trim())return!isNaN(e)}}function Xt(t){for(const e of t)if(null!=e)return"number"==typeof e}function Ut(t,e){let n;for(const r of t)if(null!=r){if(!e(r))return!1;n=!0}return n}const Ht=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function Vt(t){return"string"==typeof t&&(t=t.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(t)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(t)||Ht.has(t))}function Zt(t){return"number"==typeof t&&(0<=t&&t<=1||isNaN(t))}function Qt(t){return null==t||Jt(t)}function Jt(t){return/^\s*none\s*$/i.test(t)}function Kt(t,e){return ct(t,e,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function te(t="middle"){return Kt(t,"frameAnchor")}function ee(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}function ne(t){return qt(t)?function(t){console.warn("named iterables are deprecated; please use an object instead");const e=new Set;return Object.fromEntries(Array.from(t,(t=>{const{name:n}=t;if(null==n)throw new Error("missing name");const r=`${n}`;if("__proto__"===r)throw new Error(`illegal name: ${r}`);if(e.has(r))throw new Error(`duplicate name: ${r}`);return e.add(r),[n,t]})))}(t):t}const re=Symbol("position"),oe=Symbol("color"),ie=Symbol("radius"),ae=Symbol("length"),le=Symbol("opacity"),se=Symbol("symbol"),ce=Symbol("projection"),ue=new Map([["x",re],["y",re],["fx",re],["fy",re],["r",ie],["color",oe],["opacity",le],["symbol",se],["length",ae],["projection",ce]]);const fe=Math.sqrt(3),he=2/fe,de={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*he,o=r/2;t.moveTo(0,r),t.lineTo(n,o),t.lineTo(n,-o),t.lineTo(0,-r),t.lineTo(-n,-o),t.lineTo(-n,o),t.closePath()}},pe=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",de],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolTimes],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function me(t){return t&&"function"==typeof t.draw}function ye(t){return!!me(t)||"string"==typeof t&&pe.has(t.toLowerCase())}function ge(t){if(null==t||me(t))return t;const e=pe.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}function ve({filter:t,sort:e,reverse:n,transform:r,initializer:o,...i}={},a){if(void 0===r&&(null!=t&&(r=$e(t)),null==e||wt(e)||(r=we(r,Ae(e))),n&&(r=we(r,Me))),null!=a&&null!=o)throw new Error("transforms cannot be applied after initializers");return{...i,...(null===e||wt(e))&&{sort:e},transform:we(r,a)}}function xe({filter:t,sort:e,reverse:n,initializer:r,...o}={},i){return void 0===r&&(null!=t&&(r=$e(t)),null==e||wt(e)||(r=be(r,Ae(e))),n&&(r=be(r,Me))),{...o,...(null===e||wt(e))&&{sort:e},initializer:be(r,i)}}function we(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,o){return({data:n,facets:r}=t.call(this,n,r,o)),e.call(this,ft(n),r,o)}}function be(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,o,...i){let a,l,s,c,u,f;return({data:l=n,facets:s=r,channels:a}=t.call(this,n,r,o,...i)),({data:u=l,facets:f=s,channels:c}=e.call(this,l,s,{...o,...a},...i)),{data:u,facets:f,channels:{...a,...c}}}}function ke(t,e){return(null!=t.initializer?xe:ve)(t,e)}function $e(t){return(e,n)=>{const r=q(e,t);return{data:e,facets:n.map((t=>t.filter((t=>r[t]))))}}}function Me(t,e){return{data:t,facets:e.map((t=>t.slice().reverse()))}}function Le(t,{sort:e,...n}={}){return{...(xt(t)&&void 0!==t.channel?xe:ke)(n,Ae(t)),sort:wt(e)?e:null}}function Ae(t){return("function"==typeof t&&1!==t.length?Se:ze)(t)}function Se(t){return(e,n)=>{const r=(n,r)=>t(e[n],e[r]);return{data:e,facets:n.map((t=>t.slice().sort(r)))}}}function ze(t){let e,n;({channel:e,value:t,order:n}={...jt(t)});const i=e?.startsWith("-");if(i&&(e=e.slice(1)),void 0===n&&(n=i?o:r),"function"!=typeof n)switch(`${n}`.toLowerCase()){case"ascending":n=r;break;case"descending":n=o;break;default:throw new Error(`invalid order: ${n}`)}return(r,o,i)=>{let a;if(void 0===e)a=q(r,t);else{if(void 0===i)throw new Error("channel sort requires an initializer");if(a=i[e],!a)return{};a=a.value}const l=(t,e)=>n(a[t],a[e]);return{data:r,facets:o.map((t=>t.slice().sort(l)))}}}function Oe(t,e){return Te(null,null,t,e)}function Ee(t={y:"count"},e={}){const{x:n=X}=e;if(null==n)throw new Error("missing channel: x");return Te(n,null,t,e)}function Re(t={x:"count"},e={}){const{y:n=X}=e;if(null==n)throw new Error("missing channel: y");return Te(null,n,t,e)}function Ce(t={fill:"count"},e={}){let{x:n,y:r}=e;if([n,r]=kt(n,r),null==n)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return Te(n,r,t,e)}function Te(t,e,{data:n=Ze,filter:r,sort:o,reverse:i,...a}={},l={}){a=Fe(a,l),n=_e(n,X),o=null==o?void 0:De("sort",o,l),r=null==r?void 0:Ye("filter",r,l);const[s,c]=Rt(t),[u,f]=Rt(e),{z:h,fill:d,stroke:p,x1:m,x2:y,y1:g,y2:v,...x}=l,[w,b]=Rt(h),[k]=lt(d),[$]=lt(p),[M,L]=Rt(k),[A,S]=Rt($);return{..."z"in l&&{z:w||h},..."fill"in l&&{fill:M||d},..."stroke"in l&&{stroke:A||p},...ve(x,((l,s,u)=>{const d=Bt(q(l,t),u?.x),p=Bt(q(l,e),u?.y),m=q(l,h),y=q(l,k),g=q(l,$),v=Xe(a,{z:m,fill:y,stroke:g}),x=[],w=[],M=d&&c([]),A=p&&f([]),z=m&&b([]),O=y&&L([]),E=g&&S([]);let R=0;for(const t of a)t.initialize(l);o&&o.initialize(l),r&&r.initialize(l);for(const t of s){const e=[];for(const e of a)e.scope("facet",t);o&&o.scope("facet",t),r&&r.scope("facet",t);for(const[i,s]of We(t,v))for(const[t,c]of We(s,p))for(const[s,u]of We(c,d)){const c={data:l};if(d&&(c.x=s),p&&(c.y=t),!r||r.reduce(u,c)){e.push(R++),w.push(n.reduceIndex(u,l,c)),d&&M.push(s),p&&A.push(t),m&&z.push(v===m?i:m[u[0]]),y&&O.push(v===y?i:y[u[0]]),g&&E.push(v===g?i:g[u[0]]);for(const t of a)t.reduce(u,c);o&&o.reduce(u,c)}}x.push(e)}return Ue(x,o,i),{data:w,facets:x}})),...!Be(a,"x")&&(s?{x:s}:{x1:m,x2:y}),...!Be(a,"y")&&(u?{y:u}:{y1:g,y2:v}),...Object.fromEntries(a.map((({name:t,output:e})=>[t,e])))}}function Be(t,...e){for(const{name:n}of t)if(e.includes(n))return!0;return!1}function Ne(t,e,n=Ie){const r=Object.entries(t);return null!=e.title&&void 0===t.title&&r.push(["title",Je]),null!=e.href&&void 0===t.href&&r.push(["href",Qe]),r.filter((([,t])=>void 0!==t)).map((([t,r])=>null===r?function(t){return{name:t,initialize(){},scope(){},reduce(){}}}(t):n(t,r,e)))}function Ie(t,e,n,r=Pe){let o;gt(e)&&"reduce"in e&&(o=e.scale,e=e.reduce);const i=r(t,e,n),[a,l]=Et(i.label);let s;return{name:t,output:void 0===o?a:{value:a,scale:o},initialize(t){i.initialize(t),s=l([])},scope(t,e){i.scope(t,e)},reduce(t,e){s.push(i.reduce(t,e))}}}function Pe(t,e,n,r=je){const o=Ot(t,n),i=r(e,o);let a,l;return{label:Ct(i===tn?null:o,i.label),initialize(t){a=void 0===o?t:q(t,o),"data"===i.scope&&(l=i.reduceIndex(Mt(t),a))},scope(t,e){i.scope===t&&(l=i.reduceIndex(e,a))},reduce:(t,e)=>null==i.scope?i.reduceIndex(t,a,e):i.reduceIndex(t,a,l,e)}}function We(t,n){return n?e.sort(e.group(t,(t=>n[t])),Q):[[,t]]}function je(t,n,r=qe){if(null==t)return r(t);if("function"==typeof t.reduceIndex)return t;if("function"==typeof t.reduce&&gt(t))return function(t){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...t,reduceIndex:t.reduce.bind(t)}}(t);if("function"==typeof t)return o=t,{reduceIndex:(t,e,n)=>o(Lt(e,t),n)};var o;if(/^p\d{2}$/i.test(t))return He(et(t));switch(`${t}`.toLowerCase()){case"first":return Qe;case"last":return Ke;case"identity":return Ze;case"count":return tn;case"distinct":return en;case"sum":return null==n?tn:nn;case"proportion":return rn(n,"data");case"proportion-facet":return rn(n,"facet");case"deviation":return He(e.deviation);case"min":return He(e.min);case"min-index":return He(e.minIndex);case"max":return He(e.max);case"max-index":return He(e.maxIndex);case"mean":return Ve(e.mean);case"median":return Ve(e.median);case"variance":return He(e.variance);case"mode":return He(e.mode)}return r(t)}function qe(t){throw new Error(`invalid reduce: ${t}`)}function Fe(t,e){return Ne(t,e,De)}function De(t,e,n){return Ie(t,e,n,Ye)}function Ye(t,e,n){return Pe(t,e,n,_e)}function _e(t,e){return je(t,e,Ge)}function Ge(t){switch(`${t}`.toLowerCase()){case"x":return on;case"y":return an}throw new Error(`invalid group reduce: ${t}`)}function Xe(t,e){for(const n in e){const r=e[n];if(void 0!==r&&!t.some((t=>t.name===n)))return r}}function Ue(t,e,n){if(e){const n=e.output.transform(),o=(t,e)=>r(n[t],n[e]);t.forEach((t=>t.sort(o)))}n&&t.forEach((t=>t.reverse()))}function He(t){return{reduceIndex:(e,n)=>t(e,(t=>n[t]))}}function Ve(t){return{reduceIndex(e,n){const r=t(e,(t=>n[t]));return Yt(n)?new Date(r):r}}}const Ze={reduceIndex:(t,e)=>Lt(e,t)},Qe={reduceIndex:(t,e)=>e[t[0]]},Je={reduceIndex(t,n){const r=e.sort(e.rollup(t,(t=>t.length),(t=>n[t])),J),o=r.slice(-5).reverse();if(o.length<r.length){const t=r.slice(0,-4);o[4]=[`… ${t.length.toLocaleString("en-US")} more`,e.sum(t,J)]}return o.map((([t,e])=>`${t} (${e.toLocaleString("en-US")})`)).join("\n")}},Ke={reduceIndex:(t,e)=>e[t[t.length-1]]},tn={label:"Frequency",reduceIndex:t=>t.length},en={label:"Distinct",reduceIndex(t,n){const r=new e.InternSet;for(const e of t)r.add(n[e]);return r.size}},nn=He(e.sum);function rn(t,n){return null==t?{scope:n,label:"Frequency",reduceIndex:(t,e,n=1)=>t.length/n}:{scope:n,reduceIndex:(t,n,r=1)=>e.sum(t,(t=>n[t]))/r}}const on={reduceIndex:(t,e,{x:n})=>n},an={reduceIndex:(t,e,{y:n})=>n};function ln(t,{scale:e,type:n,value:r,filter:o,hint:i,label:a=Ct(r)},l){return void 0===i&&"function"==typeof r?.transform&&(i=r.hint),un(l,{scale:e,type:n,value:q(t,r),label:a,filter:o,hint:i})}function sn(t,e){return Object.fromEntries(Object.entries(t).map((([t,n])=>[t,ln(e,n,t)])))}function cn(t,e){const n=Object.fromEntries(Object.entries(t).map((([t,{scale:n,value:r}])=>{const o=null==n?null:e[n];return[t,null==o?r:ht(r,o)]})));return n.channels=t,n}function un(t,e){const{scale:n,value:r}=e;if(!0===n||"auto"===n)switch(t){case"fill":case"stroke":case"color":e.scale=!0!==n&&Ut(r,Vt)?null:"color";break;case"fillOpacity":case"strokeOpacity":case"opacity":e.scale=!0!==n&&Ut(r,Zt)?null:"opacity";break;case"symbol":!0!==n&&Ut(r,ye)?(e.scale=null,e.value=ht(r,ge)):e.scale="symbol";break;default:e.scale=ue.has(t)?t:null}else if(!1===n)e.scale=null;else if(null!=n&&!ue.has(n))throw new Error(`unknown scale: ${n}`);return e}function fn(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function hn(t,e){const n=t.original;if(n===t)return e;const r=e.value,o=e.value=[];for(let e=0;e<n.length;++e){const i=r[n[e][0]];for(const n of t[e])o[n]=i}return e}function dn(t,e,n){const r=pn(t,e);return ht(pn(t,n),((t,e)=>Math.abs(t-r[e])),Float64Array)}function pn(t,e,n){let r=t[e];if(r||void 0===n||(r=t[n]),r)return r.value;throw new Error(`missing channel: ${e}`)}function mn(t){if(null==t||"function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"ascending":return yn;case"descending":return gn}throw new Error(`invalid order: ${t}`)}function yn([t,e],[n,o]){return r(e,o)||r(t,n)}function gn([t,e],[n,i]){return o(e,i)||r(t,n)}function vn(t,e){let n=t[e];if(n){for(;n.source;)n=n.source;return null===n.source?null:n}}function xn(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}const wn=xn((t=>new Intl.NumberFormat(t))),bn=xn(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{month:e}}))),kn=xn(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{weekday:e}})));function $n(t){return c(t,"Invalid Date")}const Mn=function(t="en-US"){const e=function(t="en-US"){const e=wn(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t);return t=>(t instanceof Date?$n:"number"==typeof t?e:V)(t)}();let Ln,An=0;function Sn(t){t!==Ln&&(Ln=t,console.warn(t),++An)}const zn=("undefined"!=typeof window?window.devicePixelRatio>1:"undefined"==typeof it)?0:.5;let On=0;function En(){return"plot-clip-"+ ++On}function Rn(t,{title:e,href:n,ariaLabel:r,ariaDescription:o,ariaHidden:i,target:a,fill:l,fillOpacity:s,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:y,opacity:g,mixBlendMode:v,imageFilter:x,paintOrder:w,pointerEvents:b,shapeRendering:k,channels:$},{ariaLabel:M,fill:L="currentColor",fillOpacity:A,stroke:S="none",strokeOpacity:z,strokeWidth:O,strokeLinecap:E,strokeLinejoin:R,strokeMiterlimit:C,paintOrder:T}){null===L&&(l=null,s=null),null===S&&(c=null,f=null),Qt(L)?Qt(S)||Qt(l)&&!$?.fill||(S="none"):!Qt(S)||Qt(c)&&!$?.stroke||(L="none");const[B,N]=lt(l,L),[I,P]=st(s,A),[W,j]=lt(c,S),[q,F]=st(f,z),[D,Y]=st(g);Jt(j)||(void 0===u&&(u=O),void 0===d&&(d=E),void 0===h&&(h=R),void 0!==p||/^\s*round\s*$/i.test(h)||(p=C),Jt(N)||void 0!==w||(w=T));const[_,G]=st(u);return null!==L&&(t.fill=_n(N,"currentColor"),t.fillOpacity=Gn(P,1)),null!==S&&(t.stroke=_n(j,"none"),t.strokeWidth=Gn(G,1),t.strokeOpacity=Gn(F,1),t.strokeLinejoin=_n(h,"miter"),t.strokeLinecap=_n(d,"butt"),t.strokeMiterlimit=Gn(p,4),t.strokeDasharray=_n(m,"none"),t.strokeDashoffset=_n(y,"0")),t.target=V(a),t.ariaLabel=V(M),t.ariaDescription=V(o),t.ariaHidden=V(i),t.opacity=Gn(Y,1),t.mixBlendMode=_n(v,"normal"),t.imageFilter=_n(x,"none"),t.paintOrder=_n(w,"normal"),t.pointerEvents=_n(b,"auto"),t.shapeRendering=_n(k,"auto"),{title:{value:e,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:B,scale:"auto",optional:!0},fillOpacity:{value:I,scale:"auto",optional:!0},stroke:{value:W,scale:"auto",optional:!0},strokeOpacity:{value:q,scale:"auto",optional:!0},strokeWidth:{value:_,optional:!0},opacity:{value:D,scale:"auto",optional:!0}}}function Cn(t,e){e&&t.text((t=>Mn(e[t])))}function Tn(t,e){e&&t.text((([t])=>Mn(e[t])))}function Bn(t,{target:e,tip:n},{ariaLabel:r,title:o,fill:a,fillOpacity:l,stroke:s,strokeOpacity:c,strokeWidth:u,opacity:f,href:h}){r&&Dn(t,"aria-label",(t=>r[t])),a&&Dn(t,"fill",(t=>a[t])),l&&Dn(t,"fill-opacity",(t=>l[t])),s&&Dn(t,"stroke",(t=>s[t])),c&&Dn(t,"stroke-opacity",(t=>c[t])),u&&Dn(t,"stroke-width",(t=>u[t])),f&&Dn(t,"opacity",(t=>f[t])),h&&Fn(t,(t=>h[t]),e),n||function(t,e){e&&t.filter((t=>i(e[t]))).append("title").call(Cn,e)}(t,o)}function Nn(t,{target:e,tip:n},{ariaLabel:r,title:o,fill:a,fillOpacity:l,stroke:s,strokeOpacity:c,strokeWidth:u,opacity:f,href:h}){r&&Dn(t,"aria-label",(([t])=>r[t])),a&&Dn(t,"fill",(([t])=>a[t])),l&&Dn(t,"fill-opacity",(([t])=>l[t])),s&&Dn(t,"stroke",(([t])=>s[t])),c&&Dn(t,"stroke-opacity",(([t])=>c[t])),u&&Dn(t,"stroke-width",(([t])=>u[t])),f&&Dn(t,"opacity",(([t])=>f[t])),h&&Fn(t,(([t])=>h[t]),e),n||function(t,e){e&&t.filter((([t])=>i(e[t]))).append("title").call(Tn,e)}(t,o)}function In(t,n,r){const o=e.group(t,(t=>n[t]));return void 0===r&&o.size>1+t.length>>1&&Sn("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),o.values()}function*Pn(t,e,r,o){const{z:i}=r,{z:a}=o,l=function({ariaLabel:t,title:e,fill:n,fillOpacity:r,stroke:o,strokeOpacity:i,strokeWidth:a,opacity:l,href:s},{tip:c}){return[t,c?void 0:e,n,r,o,i,a,l,s].filter((t=>void 0!==t))}(o,r),s=[...e,...l];for(const e of a?In(t,a,i):[t]){let t,r;t:for(const o of e){for(const t of s)if(!n(t[o])){r&&r.push(-1);continue t}if(void 0!==t){r.push(o);for(let e=0;e<l.length;++e){if(zt(l[e][o])!==t[e]){yield r,t=l.map((t=>zt(t[o]))),r=[o];continue t}}}else r&&(yield r),t=l.map((t=>zt(t[o]))),r=[o]}r&&(yield r)}}function Wn(t){return!0===t?t="frame":!1===t?t=null:null!=t&&(t=ut(t,"clip",["frame","sphere"])),t}function jn(t,n,r,o){!function(t,n,r,o){let i;const{clip:a=o.clip}=n;switch(a){case"frame":{const{width:e,height:n,marginLeft:a,marginRight:l,marginTop:s,marginBottom:c}=r,u=En();i=`url(#${u})`,t=Qn("svg:g",o).call((t=>t.append("svg:clipPath").attr("id",u).append("rect").attr("x",a).attr("y",s).attr("width",e-l-a).attr("height",n-s-c))).each((function(){this.appendChild(t.node()),t.node=()=>this}));break}case"sphere":{const{projection:n}=o;if(!n)throw new Error('the "sphere" clip option requires a projection');const r=En();i=`url(#${r})`,t.append("clipPath").attr("id",r).append("path").attr("d",e.geoPath(n)({type:"Sphere"}));break}}Dn(t,"aria-label",n.ariaLabel),Dn(t,"aria-description",n.ariaDescription),Dn(t,"aria-hidden",n.ariaHidden),Dn(t,"clip-path",i)}(t,n,r,o),Dn(t,"fill",n.fill),Dn(t,"fill-opacity",n.fillOpacity),Dn(t,"stroke",n.stroke),Dn(t,"stroke-width",n.strokeWidth),Dn(t,"stroke-opacity",n.strokeOpacity),Dn(t,"stroke-linejoin",n.strokeLinejoin),Dn(t,"stroke-linecap",n.strokeLinecap),Dn(t,"stroke-miterlimit",n.strokeMiterlimit),Dn(t,"stroke-dasharray",n.strokeDasharray),Dn(t,"stroke-dashoffset",n.strokeDashoffset),Dn(t,"shape-rendering",n.shapeRendering),Dn(t,"filter",n.imageFilter),Dn(t,"paint-order",n.paintOrder);const{pointerEvents:i=(!1===o.pointerSticky?"none":void 0)}=n;Dn(t,"pointer-events",i)}function qn(t,e){!function(t,e,n){null!=n&&t.style(e,n)}(t,"mix-blend-mode",e.mixBlendMode),Dn(t,"opacity",e.opacity)}function Fn(t,n,r){t.each((function(t){const o=n(t);if(null!=o){const t=this.ownerDocument.createElementNS(e.namespaces.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(e.namespaces.xlink,"href",o),null!=r&&t.setAttribute("target",r),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function Dn(t,e,n){null!=n&&t.attr(e,n)}function Yn(t,e,{x:n,y:r},o=zn,i=zn){o+=e.dx,i+=e.dy,n?.bandwidth&&(o+=n.bandwidth()/2),r?.bandwidth&&(i+=r.bandwidth()/2),(o||i)&&t.attr("transform",`translate(${o},${i})`)}function _n(t,e){if((t=V(t))!==e)return t}function Gn(t,e){if((t=Z(t))!==e)return t}const Xn=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function Un(t){if(void 0===t)return"plot-d6a7b5";if(t=`${t}`,!Xn.test(t))throw new Error(`invalid class name: ${t}`);return t}function Hn(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function Vn({frameAnchor:t},{width:e,height:n,marginTop:r,marginRight:o,marginBottom:i,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?e-o:(a+e-o)/2,/^top/.test(t)?r:/^bottom/.test(t)?n-i:(r+n-i)/2]}function Zn(t={}){const{document:e=("undefined"!=typeof window?window.document:void 0),clip:n}=t;return{document:e,clip:Wn(n)}}function Qn(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}const Jn=Math.PI,Kn=2*Jn,tr=.618;function er({projection:t,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n}={},l){if(null==t)return;if("function"==typeof t.stream)return t;let s,c,u="frame";if(gt(t)){let e;if(({type:t,domain:c,inset:e,insetTop:r=(void 0!==e?e:r),insetRight:o=(void 0!==e?e:o),insetBottom:i=(void 0!==e?e:i),insetLeft:a=(void 0!==e?e:a),clip:u=u,...s}=t),null==t)return}"function"!=typeof t&&({type:t}=nr(t));const{width:f,height:h,marginLeft:d,marginRight:p,marginTop:m,marginBottom:y}=l,g=f-d-p-a-o,v=h-m-y-r-i;if(t=t?.({width:g,height:v,clip:u,...s}),null==t)return;u=function(t,n,r,o,i){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return e.geoClipRectangle(n,r,o,i);throw new Error(`unknown projection clip type: ${t}`)}(u,d,m,f-p,h-y);let x,w=d+a,b=m+r;if(null!=c){const[[n,r],[o,i]]=e.geoPath(t).bounds(c),a=Math.min(g/(o-n),v/(i-r));a>0?(w-=(a*(n+o)-g)/2,b-=(a*(r+i)-v)/2,x=e.geoTransform({point(t,e){this.stream.point(t*a+w,e*a+b)}})):Sn("Warning: the projection could not be fit to the specified domain; using the default scale.")}return x??=0===w&&0===b?ir():e.geoTransform({point(t,e){this.stream.point(t+w,e+b)}}),{stream:e=>t.stream(x.stream(u(e)))}}function nr(t){switch(`${t}`.toLowerCase()){case"albers-usa":return rr(e.geoAlbersUsa,.7463,.4673);case"albers":return or(e.geoAlbers,.7463,.4673);case"azimuthal-equal-area":return rr(e.geoAzimuthalEqualArea,4,4);case"azimuthal-equidistant":return rr(e.geoAzimuthalEquidistant,Kn,Kn);case"conic-conformal":return or(e.geoConicConformal,Kn,Kn);case"conic-equal-area":return or(e.geoConicEqualArea,6.1702,2.9781);case"conic-equidistant":return or(e.geoConicEquidistant,7.312,3.6282);case"equal-earth":return rr(e.geoEqualEarth,5.4133,2.6347);case"equirectangular":return rr(e.geoEquirectangular,Kn,Jn);case"gnomonic":return rr(e.geoGnomonic,3.4641,3.4641);case"identity":return{type:ir};case"reflect-y":return{type:ar};case"mercator":return rr(e.geoMercator,Kn,Kn);case"orthographic":return rr(e.geoOrthographic,2,2);case"stereographic":return rr(e.geoStereographic,2,2);case"transverse-mercator":return rr(e.geoTransverseMercator,Kn,Kn);default:throw new Error(`unknown projection type: ${t}`)}}function rr(t,e,n){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:l})=>{const s=t();return null!=a&&s.precision?.(a),null!=i&&s.rotate?.(i),"number"==typeof l&&s.clipAngle?.(l),s.scale(Math.min(r/e,o/n)),s.translate([r/2,o/2]),s},aspectRatio:n/e}}function or(t,e,n){const{type:r,aspectRatio:o}=rr(t,e,n);return{type:t=>{const{parallels:e,domain:n,width:o,height:i}=t,a=r(t);return null!=e&&(a.parallels(e),void 0===n&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const ir=tt({stream:t=>t}),ar=tt(e.geoTransform({point(t,e){this.stream.point(t,-e)}}));function lr(t,e,n,r){const o=n[t],i=n[e],a=o.length,l=n[t]=new Float64Array(a).fill(NaN),s=n[e]=new Float64Array(a).fill(NaN);let c;const u=r.stream({point(t,e){l[c]=t,s[c]=e}});for(c=0;c<a;++c)u.point(o[c],i[c])}function sr({projection:t}={}){return null!=t&&("function"==typeof t.stream||(gt(t)&&(t=t.type),null!=t))}function cr(t,e,{projection:n}){const{x:r,y:o}=t;let i={};return r&&(i.x=r),o&&(i.y=o),i=cn(i,e),n&&"x"===r?.scale&&"y"===o?.scale&&lr("x","y",i,n),r&&(i.x=nt(i.x)),o&&(i.y=nt(i.y)),i}function ur(t){const n=[],r=[],o={scale:"x",value:n},i={scale:"y",value:r},a={point(t,e){n.push(t),r.push(e)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const n of t.value)e.geoStream(n,a);return[o,i]}const fr=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["observable10",["#4269d0","#efb118","#ff725c","#6cc5b0","#3ca951","#ff8ab7","#a463f2","#97bbf5","#9c6b4e","#9498a0"]],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10]]);const hr=new Map([...fr,["brbg",pr(e.schemeBrBG,e.interpolateBrBG)],["prgn",pr(e.schemePRGn,e.interpolatePRGn)],["piyg",pr(e.schemePiYG,e.interpolatePiYG)],["puor",pr(e.schemePuOr,e.interpolatePuOr)],["rdbu",pr(e.schemeRdBu,e.interpolateRdBu)],["rdgy",pr(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",pr(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",pr(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",pr(e.schemeSpectral,e.interpolateSpectral)],["burd",mr(e.schemeRdBu,e.interpolateRdBu)],["buylrd",mr(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",dr(e.schemeBlues,e.interpolateBlues)],["greens",dr(e.schemeGreens,e.interpolateGreens)],["greys",dr(e.schemeGreys,e.interpolateGreys)],["oranges",dr(e.schemeOranges,e.interpolateOranges)],["purples",dr(e.schemePurples,e.interpolatePurples)],["reds",dr(e.schemeReds,e.interpolateReds)],["turbo",yr(e.interpolateTurbo)],["viridis",yr(e.interpolateViridis)],["magma",yr(e.interpolateMagma)],["inferno",yr(e.interpolateInferno)],["plasma",yr(e.interpolatePlasma)],["cividis",yr(e.interpolateCividis)],["cubehelix",yr(e.interpolateCubehelixDefault)],["warm",yr(e.interpolateWarm)],["cool",yr(e.interpolateCool)],["bugn",dr(e.schemeBuGn,e.interpolateBuGn)],["bupu",dr(e.schemeBuPu,e.interpolateBuPu)],["gnbu",dr(e.schemeGnBu,e.interpolateGnBu)],["orrd",dr(e.schemeOrRd,e.interpolateOrRd)],["pubu",dr(e.schemePuBu,e.interpolatePuBu)],["pubugn",dr(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",dr(e.schemePuRd,e.interpolatePuRd)],["rdpu",dr(e.schemeRdPu,e.interpolateRdPu)],["ylgn",dr(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",dr(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",dr(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",dr(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",gr(e.interpolateRainbow)],["sinebow",gr(e.interpolateSinebow)]]);function dr(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function pr(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function mr(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function yr(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function gr(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function vr(t){const e=`${t}`.toLowerCase();if(!hr.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return hr.get(e)}function xr(t,e){const n=vr(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const wr=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function br(t){const e=`${t}`.toLowerCase();if(!wr.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return wr.get(e)}const kr=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);const $r=t=>e=>t(1-e),Mr=[0,1],Lr=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function Ar(t){const e=`${t}`.toLowerCase();if(!Lr.has(e))throw new Error(`unknown interpolator: ${e}`);return Lr.get(e)}function Sr(t,n,r,{type:o,nice:i,clamp:a,zero:l,domain:s=Rr(t,r),unknown:c,round:u,scheme:f,interval:h,range:d=(ue.get(t)===ie?Tr(r,s):ue.get(t)===ae?Br(r,s):ue.get(t)===le?Mr:void 0),interpolate:p=(ue.get(t)===oe?null==f&&void 0!==d?e.interpolateRgb:br(void 0!==f?f:"cyclical"===o?"rainbow":"turbo"):u?e.interpolateRound:e.interpolateNumber),reverse:m}){if(h=Pt(h,o),"cyclical"!==o&&"sequential"!==o||(o="linear"),"function"!=typeof p&&(p=Ar(p)),m=!!m,void 0!==d){if((s=ft(s)).length!==(d=ft(d)).length){if(1===p.length)throw new Error("invalid piecewise interpolator");p=e.piecewise(p,d),d=void 0}}if(1===p.length?(m&&(p=$r(p),m=!1),void 0===d&&2===(d=Float64Array.from(s,((t,e)=>e/(s.length-1)))).length&&(d=Mr),n.interpolate((d===Mr?tt:Pr)(p))):n.interpolate(p),l){const[t,n]=e.extent(s);(t>0||n<0)&&(ee(s=dt(s))!==Math.sign(t)?s[s.length-1]=0:s[0]=0)}return m&&(s=e.reverse(s)),n.domain(s).unknown(c),i&&(n.nice(function(t,e){return!0===t?void 0:"number"==typeof t?t:function(t,e){if((t=Pt(t,e))&&"function"!=typeof t.ceil)throw new Error("invalid interval: missing ceil method");return t}(t,e)}(i,o)),s=n.domain()),void 0!==d&&n.range(d),a&&n.clamp(a),{type:o,domain:s,range:d,scale:n,interpolate:p,interval:h}}function zr(t,n,{exponent:r=1,...o}){return Sr(t,e.scalePow().exponent(r),n,{...o,type:"pow"})}function Or(t,n,{domain:r=[0],unknown:o,scheme:i="rdylbu",interpolate:a,range:l=(void 0!==a?e.quantize(a,r.length+1):ue.get(t)===oe?xr(i,r.length+1):void 0),reverse:s}){const c=ee(r=ft(r));if(!isNaN(c)&&!function(t,n){for(let r=1,o=t.length,i=t[0];r<o;++r){const o=e.descending(i,i=t[r]);if(0!==o&&o!==n)return!1}return!0}(r,c))throw new Error(`the ${t} scale has a non-monotonic domain`);return s&&(l=e.reverse(l)),{type:"threshold",scale:e.scaleThreshold(c<0?e.reverse(r):r,void 0===l?[]:l).unknown(o),domain:r,range:l}}function Er(t,n=a){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function Rr(t,e){const n=ue.get(t);return(n===ie||n===le||n===ae?Cr:Er)(e)}function Cr(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,a))):1]}function Tr(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const o=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,l))),i=n.map((t=>3*Math.sqrt(t/o))),a=30/e.max(i);return a<1?i.map((t=>t*a)):i}function Br(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),o=n.map((t=>12*t/r)),i=60/e.max(o);return i<1?o.map((t=>t*i)):o}function Nr(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n>0)return Er(t,l);if(n<0)return Er(t,s)}return[1,10]}function Ir(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function Pr(t){return(e,n)=>r=>t(e+r*(n-e))}function Wr(t,n,r,o,{type:i,nice:a,clamp:l,domain:s=Er(o),unknown:c,pivot:u=0,scheme:f,range:h,symmetric:d=!0,interpolate:p=(ue.get(t)===oe?null==f&&void 0!==h?e.interpolateRgb:br(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:m}){u=+u,s=ft(s);let[y,g]=s;if(s.length>2&&Sn(`Warning: the diverging ${t} scale domain contains extra elements.`),e.descending(y,g)<0&&([y,g]=[g,y],m=!m),y=Math.min(y,u),g=Math.max(g,u),"function"!=typeof p&&(p=Ar(p)),void 0!==h&&(p=1===p.length?Pr(p)(...h):e.piecewise(p,h)),m&&(p=$r(p)),d){const t=r.apply(u),e=t-r.apply(y),n=r.apply(g)-t;e<n?y=r.invert(t-n):e>n&&(g=r.invert(t+e))}return n.domain([y,u,g]).unknown(c).interpolator(p),l&&n.clamp(l),a&&n.nice(a),{type:i,domain:[y,g],pivot:u,interpolate:p,scale:n}}function jr(t,n,{exponent:r=1,...o}){return Wr(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?Yr:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...o,type:"diverging-pow"})}function qr(t,n,{constant:r=1,...o}){return Wr(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,o)}const Fr={apply:t=>t,invert:t=>t},Dr={apply:Math.log,invert:Math.exp},Yr={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function _r(t,e,n,r){return Sr(t,e,n,r)}const Gr=Symbol("ordinal");function Xr(t,n,r,{type:o,interval:i,domain:a,range:l,reverse:s,hint:c}){return i=Pt(i,o),void 0===a&&(a=Vr(r,i,t)),"categorical"!==o&&o!==Gr||(o="ordinal"),s&&(a=e.reverse(a)),a=n.domain(a).domain(),void 0!==l&&("function"==typeof l&&(l=l(a)),n.range(l)),{type:o,domain:a,range:l,scale:n,hint:c,interval:i}}function Ur(t,n,{type:r,interval:o,domain:i,range:a,scheme:l,unknown:s,...c}){let u;if(o=Pt(o,r),void 0===i&&(i=Vr(n,o,t)),ue.get(t)===se)u=function(t){return{fill:Zr(t,"fill"),stroke:Zr(t,"stroke")}}(n),a=void 0===a?function(t){return Qt(t.fill)?e.symbolsStroke:e.symbolsFill}(u):ht(a,ge);else if(ue.get(t)===oe&&(void 0!==a||"ordinal"!==r&&r!==Gr||(a=function(t,e="greys"){const n=new Set,[r,o]=xr(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(o);else{if(!1!==e)return;n.add(r)}return[...n]}(i,l),void 0!==a&&(l=void 0)),void 0===l&&void 0===a&&(l="ordinal"===r?"turbo":"observable10"),void 0!==l))if(void 0!==a){const t=br(l),n=a[0],r=a[1]-a[0];a=({length:o})=>e.quantize((e=>t(n+r*e)),o)}else a=vr(l);if(s===e.scaleImplicit)throw new Error(`implicit unknown on ${t} scale is not supported`);return Xr(t,e.scaleOrdinal().unknown(s),n,{...c,type:r,domain:i,range:a,hint:u})}function Hr(t,e,n,r){let{round:o}=n;return void 0!==o&&t.round(o=!!o),(t=Xr(r,t,e,n)).round=o,t}function Vr(t,n,o){const i=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)i.add(t)}if(void 0!==n){const[t,r]=e.extent(i).map(n.floor,n);return n.range(t,n.offset(r))}if(i.size>1e4&&ue.get(o)===re)throw new Error(`implicit ordinal domain of ${o} scale has more than 10,000 values`);return e.sort(i,r)}function Zr(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function Qr(t,{label:e,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n,round:l,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,facet:{label:p=e}={},...m}={}){const y={};for(const[n,g]of t){const t=m[n],v=so(n,g,{round:ue.get(n)===re?l:void 0,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,...t});if(v){let{label:l=("fx"===n||"fy"===n?p:e),percent:s,transform:c,inset:u,insetTop:f=(void 0!==u?u:"y"===n?r:0),insetRight:h=(void 0!==u?u:"x"===n?o:0),insetBottom:d=(void 0!==u?u:"y"===n?i:0),insetLeft:m=(void 0!==u?u:"x"===n?a:0)}=t||{};if(null==c)c=void 0;else if("function"!=typeof c)throw new Error("invalid scale transform; not a function");v.percent=!!s,v.label=void 0===l?Kr(g,v):l,v.transform=c,"x"===n||"fx"===n?(v.insetLeft=+m,v.insetRight=+h):"y"!==n&&"fy"!==n||(v.insetTop=+f,v.insetBottom=+d),y[n]=v}}return y}function Jr(t){const e={},n={scales:e};for(const[r,o]of Object.entries(t)){const{scale:t,type:i,interval:a,label:l}=o;e[r]=xo(o),n[r]=t,t.type=i,null!=a&&(t.interval=a),null!=l&&(t.label=l)}return n}function Kr(t=[],e){let n;for(const{label:e}of t)if(void 0!==e)if(void 0===n)n=e;else if(n!==e)return;if(void 0!==n)return!po(e)&&e.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function to(t){return Math.sign(ee(t.domain()))*Math.sign(ee(t.range()))}function eo(t){const{marginTop:e,marginRight:n,marginBottom:r,marginLeft:o,width:i,height:a,facet:{marginTop:l,marginRight:s,marginBottom:c,marginLeft:u}}=t;return{marginTop:Math.max(e,l),marginRight:Math.max(n,s),marginBottom:Math.max(r,c),marginLeft:Math.max(o,u),width:i,height:a}}function no({fx:t,fy:e},n){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=eo(n);return{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:t?t.scale.bandwidth()+a+o:l,height:e?e.scale.bandwidth()+r+i:s,facet:{width:l,height:s}}}function ro(t,e){if(void 0===t.range){const{insetLeft:n,insetRight:r}=t,{width:o,marginLeft:i=0,marginRight:a=0}=e,l=i+n,s=o-a-r;t.range=[l,Math.max(l,s)],po(t)||(t.range=ao(t)),t.scale.range(t.range)}io(t)}function oo(t,e){if(void 0===t.range){const{insetTop:n,insetBottom:r}=t,{height:o,marginTop:i=0,marginBottom:a=0}=e,l=i+n,s=o-a-r;t.range=[Math.max(l,s),l],po(t)?t.range.reverse():t.range=ao(t),t.scale.range(t.range)}io(t)}function io(t){void 0===t.round&&function({type:t}){return"point"===t||"band"===t}(t)&&function({scale:t}){const e=t.domain().length,[n,r]=t.range(),o=t.paddingInner?t.paddingInner():1,i=t.paddingOuter?t.paddingOuter():t.padding(),a=e-o,l=Math.abs(r-n)/Math.max(1,a+2*i);return(l-Math.floor(l))*a}(t)<=30&&t.scale.round(!0)}function ao(t){const e=t.scale.domain().length+mo(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},((t,o)=>n+o/(e-1)*(r-n)))}function lo(t,e,n){return so(t,void 0===n?void 0:[{hint:n}],{...e})}function so(t,n=[],r={}){const o=function(t,e,{type:n,domain:r,range:o,scheme:i,pivot:a,projection:l}){if(n=uo(n),"fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==l||(n=fo);for(const t of e){const e=uo(t.type);if(void 0!==e)if(void 0===n)n=e;else if(n!==e)throw new Error(`scale incompatible with channel: ${n} !== ${e}`)}if(n===fo)return;if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const s=ue.get(t);if(s===ie)return"sqrt";if(s===le||s===ae)return"linear";if(s===se)return"ordinal";if((r||o||[]).length>2)return ho(s);if(void 0!==r){if(Dt(r))return ho(s);if(Yt(r))return"utc"}else{const t=e.map((({value:t})=>t)).filter((t=>void 0!==t));if(t.some(Dt))return ho(s);if(t.some(Yt))return"utc"}if(s===oe){if(null!=a||function(t){return null!=t&&kr.has(`${t}`.toLowerCase())}(i))return"diverging";if(function(t){return null!=t&&fr.has(`${t}`.toLowerCase())}(i))return"categorical"}return"linear"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&po({type:o})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(Yt)?Sn(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${co(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${co(o)}".`):e.some(_t)?Sn(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${co(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${co(o)}".`):e.some(Gt)&&Sn(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${co(o)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${co(o)}".`)}switch(r.type=o,o){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=go(n,r,nt);break;case"identity":switch(ue.get(t)){case re:r=go(n,r,nt);break;case se:r=go(n,r,vo)}break;case"utc":case"time":r=go(n,r,ot)}switch(o){case"diverging":return function(t,n,r){return Wr(t,e.scaleDiverging(),Fr,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return jr(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return jr(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:o=1,domain:i=Er(n,o<0?s:l),...a}){return Wr(t,e.scaleDivergingLog().base(r=+r),Dr,n,{domain:i,pivot:o,...a})}(t,n,r);case"diverging-symlog":return qr(t,n,r);case"categorical":case"ordinal":case Gr:return Ur(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return Sr(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return zr(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return Or(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:o=(void 0===r?5:(r=[...r]).length),n:i=o,scheme:a="rdylbu",domain:l=Ir(n),unknown:s,interpolate:c,reverse:u}){return void 0===r&&(r=void 0!==c?e.quantize(c,i):ue.get(t)===oe?xr(a,i):void 0),l.length>0&&(l=e.scaleQuantile(l,void 0===r?{length:i}:r).quantiles()),Or(t,0,{domain:l,range:r,reverse:u,unknown:s})}(t,n,r);case"quantize":return function(t,n,{range:r,n:o=(void 0===r?5:(r=[...r]).length),scheme:i="rdylbu",domain:a=Rr(t,n),unknown:l,interpolate:s,reverse:c}){const[u,f]=e.extent(a);let h;return void 0===r?(h=e.ticks(u,f,o),h[0]<=u&&h.splice(0,1),h[h.length-1]>=f&&h.pop(),o=h.length+1,r=void 0!==s?e.quantize(s,o):ue.get(t)===oe?xr(i,o):void 0):(h=e.quantize(e.interpolateNumber(u,f),o+1).slice(1,-1),u instanceof Date&&(h=h.map((t=>new Date(t))))),ee(ft(a))<0&&h.reverse(),Or(t,0,{domain:h,range:r,reverse:c,unknown:l})}(t,n,r);case"pow":return zr(t,n,r);case"log":return function(t,n,{base:r=10,domain:o=Nr(n),...i}){return Sr(t,e.scaleLog().base(r),n,{...i,domain:o})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...o}){return Sr(t,e.scaleSymlog().constant(r),n,o)}(t,n,r);case"utc":return function(t,n,r){return _r(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return _r(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:o=.5,...i}){return Hr(e.scalePoint().align(r).padding(o),n,i,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:o=.1,paddingInner:i=o,paddingOuter:a=("fx"===t||"fy"===t?0:o),...l}){return Hr(e.scaleBand().align(r).paddingInner(i).paddingOuter(a),n,l,t)}(t,n,r);case"identity":return function(t){return{type:"identity",scale:(n=ue.get(t),n===re||n===ie||n===ae||n===le?e.scaleIdentity():t=>t)};var n}(t);case void 0:return;default:throw new Error(`unknown scale type: ${o}`)}}function co(t){return"symbol"==typeof t?t.description:t}function uo(t){return"string"==typeof t?`${t}`.toLowerCase():t}const fo={toString:()=>"projection"};function ho(t){switch(t){case re:return"point";case oe:return Gr;default:return"ordinal"}}function po({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===Gr}function mo({type:t}){return"threshold"===t}function yo(t){if(void 0===t)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,o=e.length;r<o;++r)if(t(e[r])-n)return!1;return!0}function go(t,{domain:e,...n},r){for(const n of t)void 0!==n.value&&(void 0===e&&(e=n.value?.domain),n.value=r(n.value));return{domain:void 0===e?e:r(e),...n}}function vo(t){return ht(t,ge)}function xo({scale:t,type:e,domain:n,range:r,interpolate:o,interval:i,transform:a,percent:l,pivot:s}){if("identity"===e)return{type:"identity",apply:t=>t,invert:t=>t};const c=t.unknown?t.unknown():void 0;return{type:e,domain:dt(n),...void 0!==r&&{range:dt(r)},...void 0!==a&&{transform:a},...l&&{percent:l},...void 0!==c&&{unknown:c},...void 0!==i&&{interval:i},...void 0!==o&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...void 0!==s&&{pivot:s,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:e=>t(e),...t.invert&&{invert:e=>t.invert(e)}}}function wo({x:t,y:e,fy:n,fx:r},{projection:o,aspectRatio:i},{width:a,marginTopDefault:l,marginRightDefault:s,marginBottomDefault:c,marginLeftDefault:u}){const f=n?n.scale.domain().length:1,h=function(t){if("function"==typeof t?.stream)return tr;if(gt(t)&&(t=t.type),null!=t){if("function"!=typeof t){const{aspectRatio:e}=nr(t);if(e)return e}return tr}}(o);if(h){const t=(1.1*f-.1)/(1.1*(r?r.scale.domain().length:1)-.1)*h,e=Math.max(.1,Math.min(10,t));return Math.round((a-u-s)*e+l+c)}const d=e?po(e)?e.scale.domain().length:Math.max(7,17/f):1;if(null!=i){if(i=+i,!(isFinite(i)&&i>0))throw new Error(`invalid aspectRatio: ${i}`);const o=bo("y",e)/(bo("x",t)*i),f=r?r.scale.bandwidth():1,h=n?n.scale.bandwidth():1;return(o*(f*(a-u-s)-t.insetLeft-t.insetRight)+e.insetTop+e.insetBottom)/h+l+c}return!(!e&&!n)*Math.max(1,Math.min(60,d*f))*20+30*!!r+60}function bo(t,n){if(!n)throw new Error(`aspectRatio requires ${t} scale`);const{type:r,domain:o}=n;let i;switch(r){case"linear":case"utc":case"time":i=Number;break;case"pow":{const t=n.scale.exponent();i=e=>Math.pow(e,t);break}case"log":i=Math.log;break;case"point":case"band":return o.length;default:throw new Error(`unsupported ${t} scale for aspectRatio: ${r}`)}const[a,l]=e.extent(o);return Math.abs(i(l)-i(a))}function ko(t,{fx:n,fy:r}){const o=Mt(t),i=n?.value,a=r?.value;return n&&r?e.rollup(o,(t=>(t.fx=i[t[0]],t.fy=a[t[0]],t)),(t=>i[t]),(t=>a[t])):n?e.rollup(o,(t=>(t.fx=i[t[0]],t)),(t=>i[t])):e.rollup(o,(t=>(t.fy=a[t[0]],t)),(t=>a[t]))}function $o(t){const n=[],r=new Uint32Array(e.sum(t,(t=>t.length)));for(const e of t){let o=0;for(const n of t)e!==n&&(r.set(n,o),o+=n.length);n.push(r.slice(0,o))}return n}const Mo=new Map([["top",Oo],["right",Co],["bottom",Eo],["left",Ro],["top-left",To(Oo,Ro)],["top-right",To(Oo,Co)],["bottom-left",To(Eo,Ro)],["bottom-right",To(Eo,Co)],["top-empty",function(t,{y:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=So(e,r);if(i>0)return zo(t,n,e[i-1])}],["right-empty",function(t,{x:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=So(e,n);if(i<e.length-1)return zo(t,e[i+1],r)}],["bottom-empty",function(t,{y:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=So(e,r);if(i<e.length-1)return zo(t,n,e[i+1])}],["left-empty",function(t,{x:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=So(e,n);if(i>0)return zo(t,e[i-1],r)}],["empty",function(t,e,{empty:n}){return n}]]);const Lo=new WeakMap;function Ao(t){let n=Lo.get(t);return n||Lo.set(t,n=new e.InternMap(ht(t,((t,e)=>[t,e])))),n}function So(t,e){return Ao(t).get(e)}function zo(t,e,n){return function(t,e,n){return e=zt(e),n=zt(n),t.find((t=>Object.is(zt(t.x),e)&&Object.is(zt(t.y),n)))}(t,e,n)?.empty}function Oo(t,{y:e},{y:n}){return!e||0===So(e,n)}function Eo(t,{y:e},{y:n}){return!e||So(e,n)===e.length-1}function Ro(t,{x:e},{x:n}){return!e||0===So(e,n)}function Co(t,{x:e},{x:n}){return!e||So(e,n)===e.length-1}function To(t,e){return function(){return t.apply(null,arguments)&&e.apply(null,arguments)}}function Bo(t,{channels:{fx:e,fy:n},groups:r}){return e&&n?t.map((({x:t,y:e})=>r.get(t)?.get(e)??[])):e?t.map((({x:t})=>r.get(t)??[])):t.map((({y:t})=>r.get(t)??[]))}class No{constructor(t,e={},n={},r){const{facet:o="auto",facetAnchor:i,fx:a,fy:l,sort:s,dx:c=0,dy:u=0,margin:f=0,marginTop:h=f,marginRight:d=f,marginBottom:p=f,marginLeft:m=f,clip:y=r?.clip,channels:g,tip:v,render:x}=n;if(this.data=t,this.sort=wt(s)?s:null,this.initializer=xe(n).initializer,this.transform=this.initializer?n.transform:ve(n).transform,null===o||!1===o?this.facet=null:(this.facet=ut(!0===o?"include":o,"facet",["auto","include","exclude","super"]),this.fx=t===Y&&"string"==typeof a?[a]:a,this.fy=t===Y&&"string"==typeof l?[l]:l),this.facetAnchor=function(t){if(null==t)return null;const e=Mo.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid facet anchor: ${t}`)}(i),e=ne(e),void 0!==g&&(e={...Wo(g),...e}),void 0!==r&&(e={...Rn(this,n,r),...e}),this.channels=Object.fromEntries(Object.entries(e).map((([e,n])=>{if(xt(n.value)){const{value:t,label:e=n.label,scale:r=n.scale}=n.value;n={...n,label:e,scale:r,value:t}}if(t===Y&&"string"==typeof n.value){const{value:t}=n;n={...n,value:[t]}}return[e,n]})).filter((([t,{value:e,optional:n}])=>{if(null!=e)return!0;if(n)return!1;throw new Error(`missing channel value: ${t}`)}))),this.dx=+c,this.dy=+u,this.marginTop=+h,this.marginRight=+d,this.marginBottom=+p,this.marginLeft=+m,this.clip=Wn(y),this.tip=function(t){return!0===t?"xy":!1===t||null==t?null:"string"==typeof t?ut(t,"tip",["x","y","xy"]):t}(v),"super"===this.facet){if(a||l)throw new Error("super-faceting cannot use fx or fy");for(const t in this.channels){const{scale:n}=e[t];if("x"===n||"y"===n)throw new Error("super-faceting cannot use x or y")}}null!=x&&(this.render=Po(x,this.render))}initialize(t,n,r){let o=ft(this.data);void 0===t&&null!=o&&(t=[Mt(o)]);const i=t;null!=this.transform&&(({facets:t,data:o}=this.transform(o,t,r)),o=ft(o)),void 0!==t&&(t.original=i);const a=sn(this.channels,o);return null!=this.sort&&function(t,n,r,o,i){const{order:a,reverse:l,reduce:s=!0,limit:c}=i;for(const u in i){if(!ue.has(u))continue;let{value:f,order:h=a,reverse:d=l,reduce:p=s,limit:m=c}=jt(i[u]);const y=f?.startsWith("-");if(y&&(f=f.slice(1)),h=void 0===h?y!==("width"===f||"height"===f)?gn:yn:mn(h),null==p||!1===p)continue;const g="fx"===u||"fy"===u?hn(n,o[u]):fn(r,u);if(!g)throw new Error(`missing channel for scale: ${u}`);const v=g.value,[x=0,w=1/0]=qt(m)?m:m<0?[m]:[0,m];if(null==f)g.domain=()=>{let t=Array.from(new e.InternSet(v));return d&&(t=t.reverse()),0===x&&w===1/0||(t=t.slice(x,w)),t};else{const n="data"===f?t:"height"===f?dn(r,"y1","y2"):"width"===f?dn(r,"x1","x2"):pn(r,f,"y"===f?"y2":"x"===f?"x2":void 0),o=je(!0===p?"max":p,n);g.domain=()=>{let t=e.rollups(Mt(v),(t=>o.reduceIndex(t,n)),(t=>v[t]));return h&&t.sort(h),d&&t.reverse(),0===x&&w===1/0||(t=t.slice(x,w)),t.map(Q)}}}}(o,t,a,n,this.sort),{data:o,facets:t,channels:a}}filter(t,e,r){for(const o in e){const{filter:i=n}=e[o];if(null!==i){const e=r[o];t=t.filter((t=>i(e[t])))}}return t}project(t,e,n){for(const r in t)if("x"===t[r].scale&&/^x|x$/.test(r)){const o=r.replace(/^x|x$/,"y");o in t&&"y"===t[o].scale&&lr(r,o,e,n.projection)}}scale(t,e,n){const r=cn(t,e);return n.projection&&this.project(t,r,n),r}}function Io(...t){return t.plot=No.prototype.plot,t}function Po(t,e){if(null==t)return null===e?void 0:e;if(null==e)return null===t?void 0:t;if("function"!=typeof t)throw new TypeError(`invalid render transform: ${t}`);if("function"!=typeof e)throw new TypeError(`invalid render transform: ${e}`);return function(n,r,o,i,a,l){return t.call(this,n,r,o,i,a,((t,n,r,o,i)=>e.call(this,t,n,r,o,i,l)))}}function Wo(t){return Object.fromEntries(Object.entries(ne(t)).map((([t,e])=>(void 0===(e="string"==typeof e?{value:e,label:t}:jt(e)).filter&&null==e.scale&&(e={...e,filter:null}),[t,e]))))}function jo(t,e){return!0===t?.tip?{...t,tip:e}:gt(t?.tip)&&void 0===t.tip.pointer?{...t,tip:{...t.tip,pointer:e}}:t}const qo=new WeakMap;function Fo(t,n,{x:r,y:o,px:i,py:a,maxRadius:l=40,channels:s,render:c,...u}={}){return l=+l,null!=i&&(r??=null,s={...s,px:{value:i,scale:"x"}}),null!=a&&(o??=null,s={...s,py:{value:a,scale:"y"}}),{x:r,y:o,channels:s,...u,render:Po((function(r,o,i,a,s,c){const u=(s={...s,pointerSticky:!1}).ownerSVGElement,{data:f}=s.getMarkState(this);let h=qo.get(u);h||qo.set(u,h={sticky:!1,roots:[],renders:[]});let d=h.renders.push(T)-1;const{x:p,y:m,fx:y,fy:g}=o;let v=y?y(r.fx)-a.marginLeft:0,x=g?g(r.fy)-a.marginTop:0;p?.bandwidth&&(v+=p.bandwidth()/2),m?.bandwidth&&(x+=m.bandwidth()/2);const w=null!=r.fi;let b;if(w){let t=h.facetStates;t||(h.facetStates=t=new Map),b=t.get(this),b||t.set(this,b=new Map)}const[k,$]=Vn(this,a),{px:M,py:L}=i,A=M?t=>M[t]:Go(i,k),S=L?t=>L[t]:Xo(i,$);let z,O,E,R;function C(t,e){if(w){if(R&&(R=cancelAnimationFrame(R)),null!=t)return b.set(r.fi,e),void(R=requestAnimationFrame((()=>{R=null;for(const[n,o]of b)if(o<e||o===e&&n<r.fi){t=null;break}T(t)})));b.delete(r.fi)}T(t)}function T(t){if(z===t&&E===h.sticky)return;z=t,E=s.pointerSticky=h.sticky;const e=null==z?[]:[z];w&&(e.fx=r.fx,e.fy=r.fy,e.fi=r.fi);const n=c(e,o,i,a,s);if(O){if(w){const t=O.parentNode,e=O.getAttribute("transform"),r=n.getAttribute("transform");e?n.setAttribute("transform",e):n.removeAttribute("transform"),r?t.setAttribute("transform",r):t.removeAttribute("transform"),n.removeAttribute("aria-label"),n.removeAttribute("aria-description"),n.removeAttribute("aria-hidden")}O.replaceWith(n)}return h.roots[d]=O=n,null==z&&b?.size>1||s.dispatchValue(null==z?null:f[z]),n}function B(o){if(h.sticky||"mouse"===o.pointerType&&1===o.buttons)return;let[i,s]=e.pointer(o);i-=v,s-=x;const c=i<a.marginLeft||i>a.width-a.marginRight?1:t,u=s<a.marginTop||s>a.height-a.marginBottom?1:n;let f=null,d=l*l;for(const t of r){const e=c*(A(t)-i),n=u*(S(t)-s),r=e*e+n*n;r<=d&&(f=t,d=r)}if(null!=f&&(1!==t||1!==n)){const t=A(f)-i,e=S(f)-s;d=t*t+e*e}C(f,d)}return u.addEventListener("pointerenter",B),u.addEventListener("pointermove",B),u.addEventListener("pointerdown",(function(t){"mouse"===t.pointerType&&null!=z&&(h.sticky&&h.roots.some((e=>e?.contains(t.target)))||(h.sticky?(h.sticky=!1,h.renders.forEach((t=>t(null)))):(h.sticky=!0,T(z)),t.stopImmediatePropagation()))})),u.addEventListener("pointerleave",(function(t){"mouse"===t.pointerType&&(h.sticky||C(null))})),T(null)}),c)}}function Do(t){return Fo(1,1,t)}function Yo(t){return Fo(1,.01,t)}function _o(t){return Fo(.01,1,t)}function Go({x1:t,x2:e,x:n=t},r){return t&&e?n=>(t[n]+e[n])/2:n?t=>n[t]:()=>r}function Xo({y1:t,y2:e,y:n=t},r){return t&&e?n=>(t[n]+e[n])/2:n?t=>n[t]:()=>r}function Uo(t){return po(t)&&void 0===t.interval?void 0:"tabular-nums"}const Ho=Math.PI/180;function Vo(t,{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:o=e}={}){t.markerStart=Zo(n),t.markerMid=Zo(r),t.markerEnd=Zo(o)}function Zo(t){if(null==t||!1===t)return null;if(!0===t)return Ko;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return Qo("auto");case"arrow-reverse":return Qo("auto-start-reverse");case"dot":return Jo;case"circle":case"circle-fill":return Ko;case"circle-stroke":return ti;case"tick":return ei("auto");case"tick-x":return ei(90);case"tick-y":return ei(0)}throw new Error(`invalid marker: ${t}`)}function Qo(t){return(e,n)=>Qn("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",t).attr("fill","none").attr("stroke",e).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function Jo(t,e){return Qn("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function Ko(t,e){return Qn("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function ti(t,e){return Qn("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function ei(t){return(e,n)=>Qn("svg:marker",n).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",t).attr("stroke",e).call((t=>t.append("path").attr("d","M0,-3v6"))).node()}let ni=0;function ri(t,e,{stroke:n},r){return ii(t,e,n&&(t=>n[t]),r)}function oi(t,e,{stroke:n},r){return ii(t,e,n&&(([t])=>n[t]),r)}function ii(t,{markerStart:e,markerMid:n,markerEnd:r,stroke:o},i=(()=>o),a){const l=new Map;function s(t){return function(e){const n=i(e);let r=l.get(t);r||l.set(t,r=new Map);let o=r.get(n);if(!o){const e=this.parentNode.insertBefore(t(n,a),this),i="plot-marker-"+ ++ni;e.setAttribute("id",i),r.set(n,o=`url(#${i})`)}return o}}e&&t.attr("marker-start",s(e)),n&&t.attr("marker-mid",s(n)),r&&t.attr("marker-end",s(r))}function ai({inset:t,insetLeft:e,insetRight:n,...r}={}){return[e,n]=si(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function li({inset:t,insetTop:e,insetBottom:n,...r}={}){return[e,n]=si(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function si(t,e,n){return void 0===t&&void 0===e&&void 0===n?zn?[1,0]:[.5,.5]:[e,n]}function ci(t,{interval:e}){return(t={...jt(t)}).interval=It(void 0===t.interval?e:t.interval),t}function ui(t,e,n,r){const{[t]:o,[`${t}1`]:i,[`${t}2`]:a}=n,{value:l,interval:s}=ci(o,n);if(null==l||null==s&&!r)return n;const c=Ct(o);if(null==s){let e;const o={transform:t=>e||(e=q(t,l)),label:c};return{...n,[t]:void 0,[`${t}1`]:void 0===i?o:i,[`${t}2`]:void 0!==a||i===a&&r?a:o}}let u,f;function h(t){return void 0!==f&&t===u?f:f=ht(q(u=t,l),(t=>s.floor(t)))}return e({...n,[t]:void 0,[`${t}1`]:void 0===i?{transform:h,label:c}:i,[`${t}2`]:void 0===a?{transform:t=>h(t).map((t=>s.offset(t))),label:c}:a})}function fi(t,e,n){const{[t]:r}=n,{value:o,interval:i}=ci(r,n);return null==o||null==i?n:e({...n,[t]:{label:Ct(r),transform:t=>{const e=ht(q(t,o),(t=>i.floor(t))),n=e.map((t=>i.offset(t)));return e.map(Yt(e)?(t,e)=>null==t||isNaN(t=+t)||null==(e=n[e])||isNaN(e=+e)?void 0:new Date((t+e)/2):(t,e)=>null==t||null==(e=n[e])?NaN:(+t+ +e)/2)}}})}function hi(t={}){return ui("x",ai,t,!0)}function di(t={}){return ui("y",li,t,!0)}function pi(t={}){return ui("x",ai,t)}function mi(t={}){return ui("y",li,t)}function yi(t={}){return fi("x",ai,t)}function gi(t={}){return fi("y",li,t)}const vi={ariaLabel:"rule",fill:null,stroke:"currentColor"};class xi extends No{constructor(t,e={}){const{x:n,y1:r,y2:o,inset:i=0,insetTop:a=i,insetBottom:l=i}=e;super(t,{x:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},jo(e,"x"),vi),this.insetTop=Z(a),this.insetBottom=Z(l),Vo(this,e)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y1:s,y2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetTop:y,insetBottom:g}=this;return Qn("svg:g",o).call(jn,this,r,o).call(Yn,this,{x:l&&i},zn,0).call((e=>e.selectAll().data(t).enter().append("line").call(qn,this).attr("x1",l?t=>l[t]:(p+u-d)/2).attr("x2",l?t=>l[t]:(p+u-d)/2).attr("y1",s&&!yo(a)?t=>s[t]+y:h+y).attr("y2",c&&!yo(a)?a.bandwidth?t=>c[t]+a.bandwidth()-g:t=>c[t]-g:f-m-g).call(Bn,this,n).call(ri,this,n,o))).node()}}class wi extends No{constructor(t,e={}){const{x1:n,x2:r,y:o,inset:i=0,insetRight:a=i,insetLeft:l=i}=e;super(t,{y:{value:o,scale:"y",optional:!0},x1:{value:n,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},jo(e,"y"),vi),this.insetRight=Z(a),this.insetLeft=Z(l),Vo(this,e)}render(t,e,n,r,o){const{x:i,y:a}=e,{y:l,x1:s,x2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetLeft:y,insetRight:g}=this;return Qn("svg:g",o).call(jn,this,r,o).call(Yn,this,{y:l&&a},0,zn).call((e=>e.selectAll().data(t).enter().append("line").call(qn,this).attr("x1",s&&!yo(i)?t=>s[t]+y:p+y).attr("x2",c&&!yo(i)?i.bandwidth?t=>c[t]+i.bandwidth()-g:t=>c[t]-g:u-d-g).attr("y1",l?t=>l[t]:(h+f-m)/2).attr("y2",l?t=>l[t]:(h+f-m)/2).call(Bn,this,n).call(ri,this,n,o))).node()}}function bi(t,e){let{x:n=X,y:r,y1:o,y2:i,...a}=mi(e);return[o,i]=$i(r,o,i),new xi(t,{...a,x:n,y1:o,y2:i})}function ki(t,e){let{y:n=X,x:r,x1:o,x2:i,...a}=pi(e);return[o,i]=$i(r,o,i),new wi(t,{...a,y:n,x1:o,x2:i})}function $i(t,e,n){if(null==t){if(void 0===e){if(void 0!==n)return[0,n]}else if(void 0===n)return[0,e]}else{if(void 0===e)return void 0===n?[0,t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}function Mi(t,...e){let n=e.length;for(let r=0,o=!0;r<n;++r)"function"!=typeof e[r]&&(o&&(t=t.slice(),o=!1),t.splice(r,2,t[r]+e[r]+t[r+1]),e.splice(r,1),--r,--n);return r=>{let o=t[0];for(let i=0;i<n;++i)o+=e[i](r)+t[i+1];return o}}const Li={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},Ai="­";class Si extends No{constructor(t,e={}){const{x:n,y:r,text:o=(qt(t)&&Ft(t)?X:G),frameAnchor:a,textAnchor:l=(/right$/i.test(a)?"end":/left$/i.test(a)?"start":"middle"),lineAnchor:s=(/^top/i.test(a)?"top":/^bottom/i.test(a)?"bottom":"middle"),lineHeight:c=1,lineWidth:u=1/0,textOverflow:f,monospace:h,fontFamily:d=(h?"ui-monospace, monospace":void 0),fontSize:p,fontStyle:m,fontVariant:y,fontWeight:g,rotate:v}=e,[x,w]=st(v,0),[b,k]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),Bi.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(p);var $;if(super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:b,optional:!0},rotate:{value:($=x,null==$?null:{transform:t=>q(t,$,Float64Array),label:Ct($)}),optional:!0},text:{value:o,filter:i,optional:!0}},e,Li),this.rotate=w,this.textAnchor=_n(l,"middle"),this.lineAnchor=ut(s,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+c,this.lineWidth=+u,this.textOverflow=zi(f),this.monospace=!!h,this.fontFamily=V(d),this.fontSize=k,this.fontStyle=V(m),this.fontVariant=V(y),this.fontWeight=V(g),this.frameAnchor=te(a),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${u}`);this.splitLines=ji(this),this.clipLine=qi(this)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y:s,rotate:c,text:u,title:f,fontSize:h}=n,{rotate:d}=this,[p,m]=Vn(this,r);return Qn("svg:g",o).call(jn,this,r,o).call(Ti,this,u,r).call(Yn,this,{x:l&&i,y:s&&a}).call((e=>e.selectAll().data(t).enter().append("text").call(qn,this).call(Oi,this,u,f).attr("transform",Mi`translate(${l?t=>l[t]:p},${s?t=>s[t]:m})${c?t=>` rotate(${c[t]})`:d?` rotate(${d})`:""}`).call(Dn,"font-size",h&&(t=>h[t])).call(Bn,this,n))).node()}}function zi(t){return null==t?null:ut(t,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function Oi(t,n,r,o){if(!r)return;const{lineAnchor:i,lineHeight:a,textOverflow:l,splitLines:s,clipLine:c}=n;t.each((function(t){const n=s(Mn(r[t])??"").map(c),u=n.length,f="top"===i?.71:"bottom"===i?1-u:(164-100*u)/200;if(u>1){let t=0;for(let r=0;r<u;++r){if(++t,!n[r])continue;const o=this.ownerDocument.createElementNS(e.namespaces.svg,"tspan");o.setAttribute("x",0),r===t-1?o.setAttribute("y",(f+r)*a+"em"):o.setAttribute("dy",t*a+"em"),o.textContent=n[r],this.appendChild(o),t=0}}else f&&this.setAttribute("y",f*a+"em"),this.textContent=n[0];if(l&&!o&&n[0]!==r[t]){const n=this.ownerDocument.createElementNS(e.namespaces.svg,"title");n.textContent=r[t],this.appendChild(n)}}))}function Ei(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=kt(e,n)),new Si(t,{...r,x:e,y:n})}function Ri(t,{x:e=X,...n}={}){return new Si(t,gi({...n,x:e}))}function Ci(t,{y:e=X,...n}={}){return new Si(t,yi({...n,y:e}))}function Ti(t,e,n){Dn(t,"text-anchor",e.textAnchor),Dn(t,"font-family",e.fontFamily),Dn(t,"font-size",e.fontSize),Dn(t,"font-style",e.fontStyle),Dn(t,"font-variant",void 0===e.fontVariant?function(t){return t&&(Xt(t)||Yt(t))?"tabular-nums":void 0}(n):e.fontVariant),Dn(t,"font-weight",e.fontWeight)}const Bi=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function Ni(t,e,n){const r=[];let o,i=0;for(const[a,l,s]of function*(t){let e=0,n=0;const r=t.length;for(;n<r;){let r=1;switch(t[n]){case Ai:case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];" "===t[++n];);e=n;break;case"\r":"\n"===t[n+1]&&++r;case"\n":yield[e,n,!0],n+=r,e=n;break;default:++n}}yield[e,n,!0]}(t))void 0===o&&(o=a),i>o&&n(t,o,l)>e&&(r.push(t.slice(o,i)+(t[i-1]===Ai?"-":"")),o=a),s?(r.push(t.slice(o,l)),o=void 0):i=l;return r}const Ii={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47,"…":82};function Pi(t,e=0,n=t.length){let r=0;for(let o=e;o<n;o=Ui(t,o))r+=Ii[t[o]]??(Vi(t,o)?120:Ii.e);return r}function Wi(t,e=0,n=t.length){let r=0;for(let o=e;o<n;o=Ui(t,o))r+=Vi(t,o)?126:63;return r}function ji({monospace:t,lineWidth:e,textOverflow:n}){if(null!=n||e==1/0)return t=>t.split(/\r\n?|\n/g);const r=t?Wi:Pi,o=100*e;return t=>Ni(t,o,r)}function qi({monospace:t,lineWidth:e,textOverflow:n}){if(null==n||e==1/0)return t=>t;const r=t?Wi:Pi,o=100*e;switch(n){case"clip-start":return t=>_i(t,o,r,"");case"clip-end":return t=>Yi(t,o,r,"");case"ellipsis-start":return t=>_i(t,o,r,Fi);case"ellipsis-middle":return t=>function(t,e,n,r){t=t.trim();const o=n(t);if(o<=e)return t;const i=n(r)/2,[a,l]=Di(t,e/2,n,i),[s]=Di(t,o-e/2-l+i,n,-i);return s<0?r:t.slice(0,a).trimEnd()+r+t.slice(Ui(t,s)).trimStart()}(t,o,r,Fi);case"ellipsis-end":return t=>Yi(t,o,r,Fi)}}const Fi="…";function Di(t,e,n,r){const o=[];let i=0;for(let a=0,l=0,s=t.length;a<s;a=l){l=Ui(t,a);const s=n(t,a,l);if(i+s>e){for(i+=r;i>e&&a>0;)l=a,a=o.pop(),i-=n(t,a,l);return[a,e-i]}i+=s,o.push(a)}return[-1,0]}function Yi(t,e,n,r){t=t.trim();const o=n(r),[i]=Di(t,e,n,o);return i<0?t:t.slice(0,i).trimEnd()+r}function _i(t,e,n,r){const o=n(t=t.trim());if(o<=e)return t;const i=n(r),[a]=Di(t,o-e+i,n,-i);return a<0?r:r+t.slice(Ui(t,a)).trimStart()}const Gi=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,Xi=/\p{Extended_Pictographic}/uy;function Ui(t,e){return e+=function(t,e){const n=t.charCodeAt(e);if(n>=55296&&n<56320){const n=t.charCodeAt(e+1);return n>=56320&&n<57344}return!1}(t,e)?2:1,function(t,e){return!Hi(t,e)&&(Gi.lastIndex=e,Gi.test(t))}(t,e)&&(e=Gi.lastIndex),function(t,e){return 8205===t.charCodeAt(e)}(t,e)?Ui(t,e+1):e}function Hi(t,e){return t.charCodeAt(e)<128}function Vi(t,e){return!Hi(t,e)&&(Xi.lastIndex=e,Xi.test(t))}const Zi={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},Qi=3.5,Ji=5*Qi,Ki={draw(t,e,n){const r=e*n/Ji;t.moveTo(0,0),t.lineTo(0,-e),t.moveTo(-r,r-e),t.lineTo(0,-e),t.lineTo(r,r-e)}},ta={draw(t,e,n){t.moveTo(-n,0),t.lineTo(0,-e),t.lineTo(n,0)}},ea=new Map([["arrow",Ki],["spike",ta]]);class na extends No{constructor(t,e={}){const{x:n,y:r,r:o=Qi,length:i,rotate:a,shape:l=Ki,anchor:s="middle",frameAnchor:c}=e,[u,f]=st(i,12),[h,d]=st(a,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:u,scale:"length",optional:!0},rotate:{value:h,optional:!0}},e,Zi),this.r=+o,this.length=f,this.rotate=d,this.shape=function(t){if(function(t){return t&&"function"==typeof t.draw}(t))return t;const e=ea.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid shape: ${t}`)}(l),this.anchor=ut(s,"anchor",["start","middle","end"]),this.frameAnchor=te(c)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,length:u,rotate:f}=r,{length:h,rotate:d,anchor:p,shape:m,r:y}=this,[g,v]=Vn(this,o);return Qn("svg:g",i).call(jn,this,o,i).call(Yn,this,{x:s&&a,y:c&&l}).call((n=>n.selectAll().data(t).enter().append("path").call(qn,this).attr("transform",Mi`translate(${s?t=>s[t]:g},${c?t=>c[t]:v})${f?t=>` rotate(${f[t]})`:d?` rotate(${d})`:""}${"start"===p?"":"end"===p?u?t=>` translate(0,${u[t]})`:` translate(0,${h})`:u?t=>` translate(0,${u[t]/2})`:` translate(0,${h/2})`}`).attr("d",u?t=>{const n=e.pathRound();return m.draw(n,u[t],y),n}:(()=>{const t=e.pathRound();return m.draw(t,h,y),t})()).call(Bn,this,r))).node()}}function ra(t,e={}){let{x:n,y:r,...o}=e;return void 0===e.frameAnchor&&([n,r]=kt(n,r)),new na(t,{...o,x:n,y:r})}function oa(t,e={}){const{x:n=X,...r}=e;return new na(t,{...r,x:n})}function ia(t,e={}){const{y:n=X,...r}=e;return new na(t,{...r,y:n})}function aa(t,e){return arguments.length<2&&!qt(t)&&(e=t,t=null),void 0===e&&(e={}),[t,e]}function la({anchor:t}={},e){return void 0===t?e[0]:ut(t,"anchor",e)}function sa(t){return la(t,["left","right"])}function ca(t){return la(t,["right","left"])}function ua(t){return la(t,["bottom","top"])}function fa(t){return la(t,["top","bottom"])}function ha(){const[t,e]=aa(...arguments);return ya("y",sa(e),t,e)}function da(){const[t,e]=aa(...arguments);return ya("fy",ca(e),t,e)}function pa(){const[t,e]=aa(...arguments);return ga("x",ua(e),t,e)}function ma(){const[t,e]=aa(...arguments);return ga("fx",fa(e),t,e)}function ya(t,e,n,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("y"===t?6:0),tickPadding:m,tickRotate:y,x:g,margin:v,marginTop:x=(void 0===v?20:v),marginRight:w=(void 0===v?"right"===e?40:0:v),marginBottom:b=(void 0===v?20:v),marginLeft:k=(void 0===v?"left"===e?40:0:v),label:$,labelAnchor:M,labelArrow:L,labelOffset:A,...S}){return p=Z(p),m=Z(m),y=Z(y),void 0!==M&&(M=ut(M,"labelAnchor",["center","top","bottom"])),L=Ia(L),Io(p&&!Qt(i)?function(t,e,n,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=e+("y"===t?"-empty":""),frameAnchor:l=e,tickSize:s,inset:c=0,insetLeft:u=c,insetRight:f=c,dx:h=0,y:d=("y"===t?void 0:null),...p}){return Aa(ia,t,e,`${t}-axis tick`,n,{strokeWidth:r,strokeLinecap:o,strokeLinejoin:i,facetAnchor:a,frameAnchor:l,y:d,...p,dx:"left"===e?+h-zn+ +u:+h+zn-f,anchor:"start",length:s,shape:"left"===e?Ca:Ta})}(t,e,n,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,x:g,...S}):null,Qt(s)?null:function(t,e,n,{facetAnchor:r=e+("y"===t?"-empty":""),frameAnchor:o=e,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>60?4*Math.cos(a*Ho):0),text:s,textAnchor:c=(Math.abs(a)>60?"middle":"left"===e?"end":"start"),lineAnchor:u=(a>60?"top":a<-60?"bottom":"middle"),fontVariant:f,inset:h=0,insetLeft:d=h,insetRight:p=h,dx:m=0,y:y=("y"===t?void 0:null),...g}){return Aa(Ci,t,e,`${t}-axis tick label`,n,{facetAnchor:r,frameAnchor:o,text:s,textAnchor:c,lineAnchor:u,fontVariant:f,rotate:a,y:y,...g,dx:"left"===e?+m-i-l+ +d:+m+ +i+ +l-p},(function(t,n,r,o,i){void 0===f&&(this.fontVariant=Ba(t)),void 0===s&&(i.text=Sa(t,n,r,o,e))}))}(t,e,n,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,x:g,marginTop:x,marginRight:w,marginBottom:b,marginLeft:k,...S}),Qt(s)||null===$?null:Ei([],La({fill:s,fillOpacity:c,...S},(function(n,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="y"===t&&a.inset||a,h=M??(l.bandwidth?"center":"top"),d=A??("right"===e?c:f)-3;return"center"===h?(this.textAnchor=void 0,this.lineAnchor="right"===e?"bottom":"top",this.frameAnchor=e,this.rotate=-90):(this.textAnchor="right"===e?"end":"start",this.lineAnchor=h,this.frameAnchor=`${h}-${e}`,this.rotate=0),this.dy="top"===h?3-s:"bottom"===h?u-3:0,this.dx="right"===e?d:-d,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[Na(t,l,{anchor:e,label:$,labelAnchor:h,labelArrow:L})]}}}}))))}function ga(t,e,n,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("x"===t?6:0),tickPadding:m,tickRotate:y,y:g,margin:v,marginTop:x=(void 0===v?"top"===e?30:0:v),marginRight:w=(void 0===v?20:v),marginBottom:b=(void 0===v?"bottom"===e?30:0:v),marginLeft:k=(void 0===v?20:v),label:$,labelAnchor:M,labelArrow:L,labelOffset:A,...S}){return p=Z(p),m=Z(m),y=Z(y),void 0!==M&&(M=ut(M,"labelAnchor",["center","left","right"])),L=Ia(L),Io(p&&!Qt(i)?function(t,e,n,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=e+("x"===t?"-empty":""),frameAnchor:l=e,tickSize:s,inset:c=0,insetTop:u=c,insetBottom:f=c,dy:h=0,x:d=("x"===t?void 0:null),...p}){return Aa(oa,t,e,`${t}-axis tick`,n,{strokeWidth:r,strokeLinejoin:i,strokeLinecap:o,facetAnchor:a,frameAnchor:l,x:d,...p,dy:"bottom"===e?+h-zn-f:+h+zn+ +u,anchor:"start",length:s,shape:"bottom"===e?Ea:Ra})}(t,e,n,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,y:g,...S}):null,Qt(s)?null:function(t,e,n,{facetAnchor:r=e+("x"===t?"-empty":""),frameAnchor:o=e,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>=10?4*Math.cos(a*Ho):0),text:s,textAnchor:c=(Math.abs(a)>=10?a<0^"bottom"===e?"start":"end":"middle"),lineAnchor:u=(Math.abs(a)>=10?"middle":"bottom"===e?"top":"bottom"),fontVariant:f,inset:h=0,insetTop:d=h,insetBottom:p=h,dy:m=0,x:y=("x"===t?void 0:null),...g}){return Aa(Ri,t,e,`${t}-axis tick label`,n,{facetAnchor:r,frameAnchor:o,text:void 0===s?null:s,textAnchor:c,lineAnchor:u,fontVariant:f,rotate:a,x:y,...g,dy:"bottom"===e?+m+ +i+ +l-p:+m-i-l+ +d},(function(t,n,r,o,i){void 0===f&&(this.fontVariant=Ba(t)),void 0===s&&(i.text=Sa(t,n,r,o,e))}))}(t,e,n,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,y:g,marginTop:x,marginRight:w,marginBottom:b,marginLeft:k,...S}),Qt(s)||null===$?null:Ei([],La({fill:s,fillOpacity:c,...S},(function(n,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="x"===t&&a.inset||a,h=M??(l.bandwidth?"center":"right"),d=A??("top"===e?s:u)-3;return"center"===h?(this.frameAnchor=e,this.textAnchor=void 0):(this.frameAnchor=`${e}-${h}`,this.textAnchor="right"===h?"end":"start"),this.lineAnchor=e,this.dy="top"===e?-d:d,this.dx="right"===h?c-3:"left"===h?3-f:0,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[Na(t,l,{anchor:e,label:$,labelAnchor:h,labelArrow:L})]}}}}))))}function va(){const[t,e]=aa(...arguments);return ka("y",sa(e),t,e)}function xa(){const[t,e]=aa(...arguments);return ka("fy",ca(e),t,e)}function wa(){const[t,e]=aa(...arguments);return $a("x",ua(e),t,e)}function ba(){const[t,e]=aa(...arguments);return $a("fx",fa(e),t,e)}function ka(t,e,n,{y:r=("y"===t?void 0:null),x:o=null,x1:i=("left"===e?o:null),x2:a=("right"===e?o:null),...l}){return Aa(ki,t,e,`${t}-grid`,n,{y:r,x1:i,x2:a,...Ma(l)})}function $a(t,e,n,{x:r=("x"===t?void 0:null),y:o=null,y1:i=("top"===e?o:null),y2:a=("bottom"===e?o:null),...l}){return Aa(bi,t,e,`${t}-grid`,n,{x:r,y1:i,y2:a,...Ma(l)})}function Ma({color:t="currentColor",opacity:e=.1,stroke:n=t,strokeOpacity:r=e,strokeWidth:o=1,...i}){return{stroke:n,strokeOpacity:r,strokeWidth:o,...i}}function La({fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:o,fontVariant:i,fontWeight:a,monospace:l,pointerEvents:s,shapeRendering:c,clip:u=!1},f){return[,t]=lt(t),[,e]=st(e),{facet:"super",x:null,y:null,fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:o,fontVariant:i,fontWeight:a,monospace:l,pointerEvents:s,shapeRendering:c,clip:u,initializer:f}}function Aa(t,n,r,o,i,a,l){let s;const c=xe(a).initializer,u=t(i,xe({...a,initializer:function(t,r,o,i,c,u){const f=null==t&&("fx"===n||"fy"===n),{[n]:h}=i;if(!h)throw new Error(`missing scale: ${n}`);const d=h.domain();let{interval:p,ticks:m,tickFormat:y,tickSpacing:g=("x"===n?80:35)}=a;if("string"==typeof m&&Pa(h)&&(p=m,m=void 0),void 0===m&&(m=Pt(p,h.type)??function(t,n){const[r,o]=e.extent(t.range());return(o-r)/n}(h,g)),null==t){if(qt(m))t=ft(m);else if(Wt(m))t=Oa(m,...e.extent(d));else if(h.interval){let n=h.interval;if(h.ticks){const[r,o]=e.extent(d);n=T(n,(o-r)/n[M]/m)??n,t=Oa(n,r,o)}else{n=T(n,(t=d).length/m)??n,n!==h.interval&&(t=Oa(n,...e.extent(t)))}if(n===h.interval){const e=Math.round(t.length/m);e>1&&(t=t.filter(((t,n)=>n%e==0)))}}else t=h.ticks?h.ticks(m):d;if(!h.ticks&&t.length&&t!==d){const r=new e.InternSet(d);(t=t.filter((t=>r.has(t)))).length||Sn(`Warning: the ${n}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}"y"===n||"x"===n?r=[Mt(t)]:s[n]={scale:n,value:X}}l?.call(this,h,t,m,y,s);const v=Object.fromEntries(Object.entries(s).map((([e,n])=>[e,{...n,value:q(t,n.value)}])));return f&&(r=u.filterFacets(t,v)),{data:t,facets:r,channels:v}}},c));return null==i?(s=u.channels,u.channels={}):s={},u.ariaLabel=o,void 0===u.clip&&(u.clip=!1),u}function Sa(t,e,n,r,o){return{value:za(t,e,n,r,o)}}function za(t,n,r,o,i){return"function"==typeof o?o:void 0===o&&n&&Yt(n)?N(t.type,n,i)??Mn:t.tickFormat?t.tickFormat("number"==typeof r?r:null,o):void 0===o?Mn:"string"==typeof o?(Yt(t.domain())?e.utcFormat:e.format)(o):tt(o)}function Oa(t,e,n){return t.range(e,t.offset(t.floor(n)))}const Ea={draw(t,e){t.moveTo(0,0),t.lineTo(0,e)}},Ra={draw(t,e){t.moveTo(0,0),t.lineTo(0,-e)}},Ca={draw(t,e){t.moveTo(0,0),t.lineTo(-e,0)}},Ta={draw(t,e){t.moveTo(0,0),t.lineTo(e,0)}};function Ba(t){return t.bandwidth&&!t.interval?void 0:"tabular-nums"}function Na(t,e,{anchor:n,label:r=e.label,labelAnchor:o,labelArrow:i}={}){if(!(null==r||r.inferred&&Pa(e)&&/^(date|time|year)$/i.test(r))){if(r=String(r),"auto"===i&&(i=(!e.bandwidth||e.interval)&&!/[↑↓→←]/.test(r)),!i)return r;if(!0===i){const n=to(e);n&&(i=/x$/.test(t)||"center"===o?/x$/.test(t)===n<0?"left":"right":n<0?"up":"down")}switch(i){case"left":return`← ${r}`;case"right":return`${r} →`;case"up":return"right"===n?`${r} ↑`:`↑ ${r}`;case"down":return"right"===n?`${r} ↓`:`↓ ${r}`}return r}}function Ia(t="auto"){return!Qt(t)&&("boolean"==typeof t?t:ut(t,"labelArrow",["auto","up","right","down","left"]))}function Pa(t){return Yt(t.domain())}function Wa(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function ja(t,e={},n){let{columns:r,tickFormat:o,fontVariant:i=Uo(t),swatchSize:a=15,swatchWidth:l=a,swatchHeight:s=a,marginLeft:c=0,className:u,style:f,width:h}=e;const d=Zn(e);u=Un(u),o=za(t.scale,t.domain,void 0,o);const p=Qn("div",d).attr("class",`${u}-swatches ${u}-swatches-${null!=r?"columns":"wrap"}`);let m;return null!=r?(m=`:where(.${u}-swatches-columns .${u}-swatch) {\n  display: flex;\n  align-items: center;\n  break-inside: avoid;\n  padding-bottom: 1px;\n}\n:where(.${u}-swatches-columns .${u}-swatch::before) {\n  flex-shrink: 0;\n}\n:where(.${u}-swatches-columns .${u}-swatch-label) {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}`,p.style("columns",r).selectAll().data(t.domain).enter().append("div").attr("class",`${u}-swatch`).call(n,t,l,s).call((t=>t.append("div").attr("class",`${u}-swatch-label`).attr("title",o).text(o)))):(m=`:where(.${u}-swatches-wrap) {\n  display: flex;\n  align-items: center;\n  min-height: 33px;\n  flex-wrap: wrap;\n}\n:where(.${u}-swatches-wrap .${u}-swatch) {\n  display: inline-flex;\n  align-items: center;\n  margin-right: 1em;\n}`,p.selectAll().data(t.domain).enter().append("span").attr("class",`${u}-swatch`).call(n,t,l,s).append((function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))}))),p.call((t=>t.insert("style","*").text(`:where(.${u}-swatches) {\n  font-family: system-ui, sans-serif;\n  font-size: 10px;\n  margin-bottom: 0.5em;\n}\n:where(.${u}-swatch > svg) {\n  margin-right: 0.5em;\n  overflow: visible;\n}\n${m}`))).style("margin-left",c?+c+"px":null).style("width",void 0===h?null:+h+"px").style("font-variant",_n(i,"normal")).call(Hn,f).node()}const qa=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:o=(void 0!==t.hint?.stroke?t.hint.stroke:Qt(n)?"currentColor":"none"),strokeOpacity:i=1,strokeWidth:a=1.5,r:l=4.5,...s}={},c){const[u,f]=lt(n),[h,d]=lt(o),p=Wa(c,u),m=Wa(c,h),y=l*l*Math.PI;return r=st(r)[1],i=st(i)[1],a=st(a)[1],ja(t,s,((n,o,l,s)=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("width",l).attr("height",s).attr("fill","color"===u?t=>p.scale(t):f).attr("fill-opacity",r).attr("stroke","color"===h?t=>m.scale(t):d).attr("stroke-opacity",i).attr("stroke-width",a).append("path").attr("d",(n=>{const r=e.pathRound();return t.scale(n).draw(r,y),r}))))}],["color",Da],["opacity",function({type:t,interpolate:n,...r},{legend:o=!0,color:i=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===o&&(o="ramp");if("ramp"!==`${o}`.toLowerCase())throw new Error(`${o} opacity legends are not supported`);return Da({type:t,...r,interpolate:Ya(i)},{legend:o,...a})}]]);function Fa({className:t,...e},{label:n,ticks:r,tickFormat:o}={},i){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const o=r[e];n===t?n={...n,[e]:o}:n[e]=o}return n}(i,{className:t,...e},{label:n,ticks:r,tickFormat:o})}function Da(t,{legend:n=!0,...r}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,{opacity:e,...n}={}){if(!po(t)&&!mo(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return ja(t,n,((t,n,r,o)=>t.append("svg").attr("width",r).attr("height",o).attr("fill",n.scale).attr("fill-opacity",st(e)[1]).append("rect").attr("width","100%").attr("height","100%")))}(t,r);case"ramp":return function(t,n){let{label:r=t.label,tickSize:o=6,width:i=240,height:a=44+o,marginTop:l=18,marginRight:s=0,marginBottom:c=16+o,marginLeft:u=0,style:f,ticks:h=(i-u-s)/64,tickFormat:d,fontVariant:p=Uo(t),round:m=!0,opacity:y,className:g}=n;const v=Zn(n);g=Un(g),y=st(y)[1],null===d&&(d=()=>null);const x=Qn("svg",v).attr("class",`${g}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",a).attr("viewBox",`0 0 ${i} ${a}`).call((t=>t.append("style").text(`:where(.${g}-ramp) {\n  display: block;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n  overflow: visible;\n}\n:where(.${g}-ramp text) {\n  white-space: pre;\n}`))).call(Hn,f);let w,b=t=>t.selectAll(".tick line").attr("y1",l+c-a);const k=m?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:$,domain:M,range:L,interpolate:A,scale:S,pivot:z}=t;if(A){const t=void 0===L?A:e.piecewise(1===A.length?Pr(A):A,L);w=k(S.copy(),e.quantize(e.interpolateNumber(u,i-s),Math.min(M.length+(void 0!==z),void 0===L?1/0:L.length)));const n=256,r=v.document.createElement("canvas");r.width=n,r.height=1;const o=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)o.fillStyle=t(e/r),o.fillRect(e,0,1,1);x.append("image").attr("opacity",y).attr("x",u).attr("y",l).attr("width",i-u-s).attr("height",a-l-c).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===$){const t=M,n=void 0===d?t=>t:"string"==typeof d?e.format(d):d;w=k(e.scaleLinear().domain([-1,L.length-1]),[u,i-s]),x.append("g").attr("fill-opacity",y).selectAll().data(L).enter().append("rect").attr("x",((t,e)=>w(e-1))).attr("y",l).attr("width",((t,e)=>w(e)-w(e-1))).attr("height",a-l-c).attr("fill",(t=>t)),h=ht(t,((t,e)=>e)),d=e=>n(t[e],e)}else w=k(e.scaleBand().domain(M),[u,i-s]),x.append("g").attr("fill-opacity",y).selectAll().data(M).enter().append("rect").attr("x",w).attr("y",l).attr("width",Math.max(0,w.bandwidth()-1)).attr("height",a-l-c).attr("fill",S),b=()=>{};return x.append("g").attr("transform",`translate(0,${a-c})`).call(e.axisBottom(w).ticks(Array.isArray(h)?null:h,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(o).tickValues(Array.isArray(h)?h:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",_n(p,"normal")).call(b).call((t=>t.select(".domain").remove())),void 0!==r&&x.append("text").attr("x",u).attr("y",l-6).attr("fill","currentColor").attr("font-weight","bold").text(r),x.node()}(t,r);default:throw new Error(`unknown legend type: ${n}`)}}function Ya(t){const{r:n,g:r,b:o}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${o},${t})`}const _a={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},Ga={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};class Xa extends No{constructor(t={}){const{anchor:e=null,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n,rx:l,ry:s}=t;super(Y,void 0,t,null==e?_a:Ga),this.anchor=ct(e,"anchor",["top","right","bottom","left"]),this.insetTop=Z(r),this.insetRight=Z(o),this.insetBottom=Z(i),this.insetLeft=Z(a),this.rx=Z(l),this.ry=Z(s)}render(t,e,n,r,o){const{marginTop:i,marginRight:a,marginBottom:l,marginLeft:s,width:c,height:u}=r,{anchor:f,insetTop:h,insetRight:d,insetBottom:p,insetLeft:m,rx:y,ry:g}=this,v=s+m,x=c-a-d,w=i+h,b=u-l-p;return Qn(f?"svg:line":"svg:rect",o).datum(0).call(jn,this,r,o).call(qn,this).call(Bn,this,n).call(Yn,this,{}).call("left"===f?t=>t.attr("x1",v).attr("x2",v).attr("y1",w).attr("y2",b):"right"===f?t=>t.attr("x1",x).attr("x2",x).attr("y1",w).attr("y2",b):"top"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",w).attr("y2",w):"bottom"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",b).attr("y2",b):t=>t.attr("x",v).attr("y",w).attr("width",x-v).attr("height",b-w).attr("rx",y).attr("ry",g)).node()}}function Ua(t){return new Xa(t)}const Ha={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},Va=new Set(["geometry","href","src","ariaLabel","scales"]);class Za extends No{constructor(t,e={}){e.tip&&(e={...e,tip:!1}),void 0===e.title&&qt(t)&&Ft(t)&&(e={...e,title:X});const{x:n,y:r,x1:o,x2:i,y1:a,y2:l,anchor:s,preferredAnchor:c="bottom",monospace:u,fontFamily:f=(u?"ui-monospace, monospace":void 0),fontSize:h,fontStyle:d,fontVariant:p,fontWeight:m,lineHeight:y=1,lineWidth:g=20,frameAnchor:v,format:x,textAnchor:w="start",textOverflow:b,textPadding:k=8,title:$,pointerSize:M=12,pathFilter:L="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=e;super(t,{x:{value:null!=o&&null!=i?null:n,scale:"x",optional:!0},y:{value:null!=a&&null!=l?null:r,scale:"y",optional:!0},x1:{value:o,scale:"x",optional:null==i},y1:{value:a,scale:"y",optional:null==l},x2:{value:i,scale:"x",optional:null==o},y2:{value:l,scale:"y",optional:null==a},title:{value:$,optional:!0}},e,Ha),this.anchor=Kt(s,"anchor"),this.preferredAnchor=Kt(c,"preferredAnchor"),this.frameAnchor=te(v),this.textAnchor=_n(w,"middle"),this.textPadding=+k,this.pointerSize=+M,this.pathFilter=V(L),this.lineHeight=+y,this.lineWidth=+g,this.textOverflow=zi(b),this.monospace=!!u,this.fontFamily=V(f),this.fontSize=Z(h),this.fontStyle=V(d),this.fontVariant=V(p),this.fontWeight=V(m);for(const t in Ha)t in this.channels&&(this[t]=Ha[t]);this.splitLines=ji(this),this.clipLine=qi(this),this.format={...x}}render(t,n,r,o,i){const a=this,{x:l,y:s,fx:c,fy:u}=n,{ownerSVGElement:f,document:h}=i,{anchor:d,monospace:p,lineHeight:m,lineWidth:y}=this,{textPadding:g,pointerSize:v,pathFilter:x}=this,{marginTop:w,marginLeft:b}=o,{x1:k,y1:$,x2:M,y2:L,x:A=k??M,y:S=$??L}=r,z=c?c(t.fx)-b:0,O=u?u(t.fy)-w:0,[E,R]=Vn(this,o),C=Go(r,E),T=Xo(r,R),B=p?Wi:Pi,N=B(Fi);let I,P;"title"in r?(I=r.channels,P=tl):(I=Ja.call(this,r,n),P=el);const W=Qn("svg:g",i).call(jn,this,o,i).call(Ti,this).call(Yn,this,{x:A&&l,y:S&&s}).call((o=>o.selectAll().data(t).enter().append("g").attr("transform",(t=>`translate(${Math.round(C(t))},${Math.round(T(t))})`)).call(qn,this).call((t=>t.append("path").attr("filter",x))).call((o=>o.append("text").each((function(o){const i=e.select(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const l=P.call(a,o,t,I,n,r);if("string"==typeof l)for(const t of a.splitLines(l))j(i,{value:a.clipLine(t)});else{const t=new Set;for(const e of l){const{label:n=""}=e;n&&t.has(n)||(t.add(n),j(i,e))}}}))))));function j(t,{label:e,value:n,color:r,opacity:o}){e??="",n??="";const i=null!=r||null!=o;let a,l=100*y;const[s]=Di(e,l,B,N);if(s>=0)e=e.slice(0,s).trimEnd()+Fi,a=n.trim(),n="";else{(e||!n&&!i)&&(n=" "+n);const[t]=Di(n,l-B(e),B,N);t>=0&&(a=n.trim(),n=n.slice(0,t).trimEnd()+Fi)}const c=t.append("tspan").attr("x",0).attr("dy",`${m}em`).text("​");e&&c.append("tspan").attr("font-weight","bold").text(e),n&&c.append((()=>h.createTextNode(n))),i&&c.append("tspan").text(" ■").attr("fill",r).attr("fill-opacity",o).style("user-select","none"),a&&c.append("title").text(a)}function q(){const{width:t,height:e}=o.facet??o;W.selectChildren().each((function(n){let{x:r,width:o,height:i}=this.getBBox();o=Math.round(o),i=Math.round(i);let l=d;if(void 0===l){const r=C(n)+z,s=T(n)+O,c=r+o+v+2*g<t,u=r-o-v-2*g>0,f=s+i+v+2*g<e,h=s-i-v-2*g>0;l=c&&u?f&&h?a.preferredAnchor:h?"bottom":"top":f&&h?c?"left":"right":(c||u)&&(f||h)?`${h?"bottom":"top"}-${c?"left":"right"}`:a.preferredAnchor}const s=this.firstChild,c=this.lastChild;if(s.setAttribute("d",function(t,e,n,r,o){const i=r+2*n,a=o+2*n;switch(t){case"middle":return`M${-i/2},${-a/2}h${i}v${a}h${-i}z`;case"top-left":return`M0,0l${e},${e}h${i-e}v${a}h${-i}z`;case"top":return`M0,0l${e/2},${e/2}h${(i-e)/2}v${a}h${-i}v${-a}h${(i-e)/2}z`;case"top-right":return`M0,0l${-e},${e}h${e-i}v${a}h${i}z`;case"right":return`M0,0l${-e/2},${-e/2}v${e/2-a/2}h${-i}v${a}h${i}v${e/2-a/2}z`;case"bottom-left":return`M0,0l${e},${-e}h${i-e}v${-a}h${-i}z`;case"bottom":return`M0,0l${e/2},${-e/2}h${(i-e)/2}v${-a}h${-i}v${a}h${(i-e)/2}z`;case"bottom-right":return`M0,0l${-e},${-e}h${e-i}v${-a}h${i}z`;case"left":return`M0,0l${e/2},${-e/2}v${e/2-a/2}h${i}v${a}h${-i}v${e/2-a/2}z`}}(l,v,g,o,i)),r)for(const t of c.childNodes)t.setAttribute("x",-r);c.setAttribute("y",+function(t,e,n){return/^top(?:-|$)/.test(t)?.94-n:-.29-e*n}(l,c.childNodes.length,m).toFixed(6)+"em"),c.setAttribute("transform",`translate(${function(t,e,n,r,o){switch(t){case"middle":return[-r/2,o/2];case"top-left":return[n,e+n];case"top":return[-r/2,e/2+n];case"top-right":return[-r-n,e+n];case"right":return[-e/2-r-n,o/2];case"bottom-left":return[n,-e-n];case"bottom":return[-r/2,-e/2-n];case"bottom-right":return[-r-n,-e-n];case"left":return[n+e/2,o/2]}}(l,v,g,o,i)})`)})),W.attr("visibility",null)}return t.length&&(W.attr("visibility","hidden"),f.isConnected?Promise.resolve().then(q):"undefined"!=typeof requestAnimationFrame&&requestAnimationFrame(q)),W.node()}}function Qa(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=kt(e,n)),new Za(t,{...r,x:e,y:n})}function Ja({channels:t},n){const r={};let o=this.format;o=Ka(o,t,"x"),o=Ka(o,t,"y"),this.format=o;for(const e in o){const n=o[e];if(null!==n&&!1!==n)if("fx"===e||"fy"===e)r[e]=!0;else{const n=vn(t,e);n&&(r[e]=n)}}for(const e in t){if(e in r||e in o||Va.has(e))continue;const n=vn(t,e);n&&(r[e]=n)}this.facet&&(n.fx&&!("fx"in o)&&(r.fx=!0),n.fy&&!("fy"in o)&&(r.fy=!0));for(const t in r){const o=this.format[t];if("string"==typeof o){const i=r[t]?.value??n[t]?.domain()??[];this.format[t]=(Yt(i)?e.utcFormat:e.format)(o)}else if(void 0===o||!0===o){const e=n[t];this.format[t]=e?.bandwidth?za(e,e.domain()):Mn}}return r}function Ka(t,e,n){if(!(n in t))return t;const r=`${n}1`,o=`${n}2`;if(!(!(r in t)&&r in e||!(o in t)&&o in e))return t;const i=Object.entries(t),a=t[n];return i.splice(i.findIndex((([t])=>t===n))+1,0,[r,a],[o,a]),Object.fromEntries(i)}function tl(t,e,{title:n}){return Mn(n.value[t],t)}function*el(t,e,r,o,i){for(const a in r){if("fx"===a||"fy"===a){yield{label:ol(o,r,a),value:this.format[a](e[a],t)};continue}if("x1"===a&&"x2"in r)continue;if("y1"===a&&"y2"in r)continue;const l=r[a];if("x2"===a&&"x1"in r)yield{label:rl(o,r,"x"),value:nl(this.format.x2,r.x1,l,t)};else if("y2"===a&&"y1"in r)yield{label:rl(o,r,"y"),value:nl(this.format.y2,r.y1,l,t)};else{const e=l.value[t],s=l.scale;if(!n(e)&&null==s)continue;yield{label:ol(o,r,a),value:this.format[a](e,t),color:"color"===s?i[a][t]:null,opacity:"opacity"===s?i[a][t]:null}}}}function nl(t,e,n,r){return n.hint?.length?`${t(n.value[r]-e.value[r],r)}`:`${t(e.value[r],r)}–${t(n.value[r],r)}`}function rl(t,e,n){const r=ol(t,e,`${n}1`,n),o=ol(t,e,`${n}2`,n);return r===o?r:`${r}–${o}`}function ol(t,e,n,r=n){const o=e[n],i=t[o?.scale??n];return String(i?.label??o?.label??r)}function il(t={}){const{facet:n,style:r,title:o,subtitle:i,caption:a,ariaLabel:l,ariaDescription:s}=t,c=Un(t.className),u=void 0===t.marks?[]:ll(t.marks);u.push(...function(t){const e=[];for(const n of t){let t=n.tip;if(t){!0===t?t={}:"string"==typeof t&&(t={pointer:t});let{pointer:r,preferredAnchor:o}=t;r=/^x$/i.test(r)?Yo:/^y$/i.test(r)?_o:Do,t=r(yl(n,t)),t.title=null,void 0===o&&(t.preferredAnchor=r===_o?"left":"bottom");const i=Qa(n.data,t);i.facet=n.facet,i.facetAnchor=n.facetAnchor,e.push(i)}}return e}(u));const f=function(t,e){if(null==t)return;const{x:n,y:r}=t;if(null==n&&null==r)return;const o=ft(t.data);if(null==o)throw new Error("missing facet data");const i={};null!=n&&(i.fx=ln(o,{value:n,scale:"fx"}));null!=r&&(i.fy=ln(o,{value:r,scale:"fy"}));ul(i,e);const a=ko(o,i);return{channels:i,groups:a,data:t.data}}(n,t),h=new Map;for(const e of u){const n=ml(e,f,t);n&&h.set(e,n)}const d=new Map;f&&dl(d,[f],t),dl(d,h,t);const p=ll(function(t,e,n){let{projection:r,x:o={},y:i={},fx:a={},fy:l={},axis:s,grid:c,facet:u={},facet:{axis:f=s,grid:h}=u,x:{axis:d=s,grid:p=(null===d?null:c)}=o,y:{axis:m=s,grid:y=(null===m?null:c)}=i,fx:{axis:g=f,grid:v=(null===g?null:h)}=a,fy:{axis:x=f,grid:w=(null===x?null:h)}=l}=n;(r||!vt(o)&&!bl("x",t))&&(d=p=null);(r||!vt(i)&&!bl("y",t))&&(m=y=null);e.has("fx")||(g=v=null);e.has("fy")||(x=w=null);void 0===d&&(d=!wl(t,"x"));void 0===m&&(m=!wl(t,"y"));void 0===g&&(g=!wl(t,"fx"));void 0===x&&(x=!wl(t,"fy"));!0===d&&(d="bottom");!0===m&&(m="left");!0===g&&(g="top"===d||null===d?"bottom":"top");!0===x&&(x="right"===m||null===m?"left":"right");const b=[];return vl(b,w,xa,l),gl(b,x,da,"right","left",u,l),vl(b,v,ba,a),gl(b,g,ma,"top","bottom",u,a),vl(b,y,va,i),gl(b,m,ha,"left","right",n,i),vl(b,p,wa,o),gl(b,d,pa,"bottom","top",n,o),b}(u,d,t));for(const e of p){const n=ml(e,f,t);n&&h.set(e,n)}u.unshift(...p);let m=function(t,n){const{fx:r,fy:o}=Qr(t,n),i=r?.scale.domain(),a=o?.scale.domain();return i&&a?e.cross(i,a).map((([t,e],n)=>({x:t,y:e,i:n}))):i?i.map(((t,e)=>({x:t,i:e}))):a?a.map(((t,e)=>({y:t,i:e}))):void 0}(d,t);if(void 0!==m){const t=f?Bo(m,f):void 0;for(const e of u){if(null===e.facet||"super"===e.facet)continue;const n=h.get(e);void 0!==n&&(n.facetsIndex=null!=e.fx||null!=e.fy?Bo(m,n):t)}const e=new Set;for(const{facetsIndex:t}of h.values())t?.forEach(((t,n)=>{t?.length>0&&e.add(n)}));m.forEach(0<e.size&&e.size<m.length?(t,n)=>t.empty=!e.has(n):t=>t.empty=!1);for(const t of u)if("exclude"===t.facet){const e=h.get(t);void 0!==e&&(e.facetsIndex=$o(e.facetsIndex))}}for(const e of ue.keys())vt(t[e])&&"fx"!==e&&"fy"!==e&&d.set(e,[]);const y=new Map;for(const e of u){if(y.has(e))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:n,channels:r}=h.get(e)??{},{data:o,facets:i,channels:a}=e.initialize(n,r,t);ul(a,t),y.set(e,{data:o,facets:i,channels:a})}const g=Qr(dl(d,y,t),t),v=function(t,e,n={}){let r=.5-zn,o=.5+zn,i=.5+zn,a=.5-zn;for(const{marginTop:t,marginRight:n,marginBottom:l,marginLeft:s}of e)t>r&&(r=t),n>o&&(o=n),l>i&&(i=l),s>a&&(a=s);let{margin:l,marginTop:s=(void 0!==l?l:r),marginRight:c=(void 0!==l?l:o),marginBottom:u=(void 0!==l?l:i),marginLeft:f=(void 0!==l?l:a)}=n;s=+s,c=+c,u=+u,f=+f;let{width:h=640,height:d=wo(t,n,{width:h,marginTopDefault:r,marginRightDefault:o,marginBottomDefault:i,marginLeftDefault:a})+Math.max(0,s-r+u-i)}=n;h=+h,d=+d;const p={width:h,height:d,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f};if(t.fx||t.fy){let{margin:t,marginTop:e=(void 0!==t?t:s),marginRight:r=(void 0!==t?t:c),marginBottom:o=(void 0!==t?t:u),marginLeft:i=(void 0!==t?t:f)}=n.facet??{};e=+e,r=+r,o=+o,i=+i,p.facet={marginTop:e,marginRight:r,marginBottom:o,marginLeft:i}}return p}(g,u,t);!function(t,e){const{x:n,y:r,fx:o,fy:i}=t,a=o||i?eo(e):e;o&&ro(o,a),i&&oo(i,a);const l=o||i?no(t,e):e;n&&ro(n,l),r&&oo(r,l)}(g,v);const x=Jr(g),{fx:w,fy:b}=x,k=w||b?no(g,v):v,$=w||b?function({fx:t,fy:e},n){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=eo(n),c=t&&kl(t),u=e&&kl(e);return{marginTop:e?u[0]:r,marginRight:t?l-c[1]:o,marginBottom:e?s-u[1]:i,marginLeft:t?c[0]:a,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:l,height:s}}(x,v):v,M=Zn(t),L=M.document,A=e.creator("svg").call(L.documentElement);let S=A;M.ownerSVGElement=A,M.className=c,M.projection=er(t,k),M.filterFacets=(t,e)=>Bo(m,{channels:e,groups:ko(t,e)}),M.getMarkState=t=>{const e=y.get(t),n=h.get(t);return{...e,channels:{...e.channels,...n?.channels}}},M.dispatchValue=t=>{S.value!==t&&(S.value=t,S.dispatchEvent(new Event("input",{bubbles:!0})))};const z=new Set;for(const[e,n]of y)if(null!=e.initializer){const r="super"===e.facet?$:k,o=e.initializer(n.data,n.facets,n.channels,x,r,M);if(void 0!==o.data&&(n.data=o.data),void 0!==o.facets&&(n.facets=o.facets),void 0!==o.channels){const{fx:r,fy:i,...a}=o.channels;hl(a),Object.assign(n.channels,a);for(const e of Object.values(a)){const{scale:n}=e;null!=n&&((O=ue.get(n))!==re&&O!==ce)&&(fl(e,t),z.add(n))}null==r&&null==i||h.set(e,!0)}}var O;if(z.size){const e=new Map;dl(e,y,t,(t=>z.has(t))),dl(d,y,t,(t=>z.has(t)));const n=function(t,e){for(const n in t){const r=t[n],o=e[n];void 0===r.label&&o&&(r.label=o.label)}return t}(Qr(e,t),g),{scales:r,...o}=Jr(n);Object.assign(g,n),Object.assign(x,o),Object.assign(x.scales,r)}let E,R;void 0!==m&&(E={x:w?.domain(),y:b?.domain()},m=function(t,{x:e,y:n}){return e&&=Ao(e),n&&=Ao(n),t.filter(e&&n?t=>e.has(t.x)&&n.has(t.y):e?t=>e.has(t.x):t=>n.has(t.y)).sort(e&&n?(t,r)=>e.get(t.x)-e.get(r.x)||n.get(t.y)-n.get(r.y):e?(t,n)=>e.get(t.x)-e.get(n.x):(t,e)=>n.get(t.y)-n.get(e.y))}(m,E),R=function(t,e,{marginTop:n,marginLeft:r}){return t&&e?({x:o,y:i})=>`translate(${t(o)-r},${e(i)-n})`:t?({x:e})=>`translate(${t(e)-r},0)`:({y:t})=>`translate(0,${e(t)-n})`}(w,b,v));for(const[t,e]of y)e.values=t.scale(e.channels,x,M);const{width:C,height:T}=v;e.select(A).attr("class",c).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",C).attr("height",T).attr("viewBox",`0 0 ${C} ${T}`).attr("aria-label",l).attr("aria-description",s).call((t=>t.append("style").text(`:where(.${c}) {\n  --plot-background: white;\n  display: block;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n}\n:where(.${c} text),\n:where(.${c} tspan) {\n  white-space: pre;\n}`))).call(Hn,r);for(const t of u){const{channels:n,values:r,facets:o}=y.get(t);if(void 0===m||"super"===t.facet){let e=null;if(o&&(e=o[0],e=t.filter(e,n,r),0===e.length))continue;const i=t.render(e,x,r,$,M);if(null==i)continue;A.appendChild(i)}else{let i;for(const a of m){if(!(t.facetAnchor?.(m,E,a)??!a.empty))continue;let l=null;if(o){const e=h.has(t);if(l=o[e?a.i:0],l=t.filter(l,n,r),0===l.length)continue;e||l!==o[0]||(l=St(l)),l.fx=a.x,l.fy=a.y,l.fi=a.i}const s=t.render(l,x,r,k,M);if(null!=s){(i??=e.select(A).append("g")).append((()=>s)).datum(a);for(const t of["aria-label","aria-description","aria-hidden","transform"])s.hasAttribute(t)&&(i.attr(t,s.getAttribute(t)),s.removeAttribute(t))}}i?.selectChildren().attr("transform",R)}}const B=function(t,e,n){const r=[];for(const[o,i]of qa){const a=n[o];if(a?.legend&&o in t){const n=i(t[o],Fa(e,t[o],a),(e=>t[e]));null!=n&&r.push(n)}}return r}(g,M,t),{figure:N=null!=o||null!=i||null!=a||B.length>0}=t;N&&(S=L.createElement("figure"),S.className=`${c}-figure`,S.style.maxWidth="initial",null!=o&&S.append(al(L,o,"h2")),null!=i&&S.append(al(L,i,"h3")),S.append(...B,A),null!=a&&S.append(function(t,e){const n=t.createElement("figcaption");return n.append(e),n}(L,a))),S.scale=function(t){return e=>{if(!ue.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return t[e]}}(x.scales),S.legend=function(t,e,n={}){return(r,o)=>{if(!qa.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return qa.get(r)(t[r],Fa(e,n[r],o),(e=>t[e]))}}(g,M,t);const I=function(){const t=An;return An=0,Ln=void 0,t}();return I>0&&e.select(A).append("text").attr("x",C).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${I.toLocaleString("en-US")} warning${1===I?"":"s"}. Please check the console.`),S}function al(t,e,n){if(e.ownerDocument)return e;const r=t.createElement(n);return r.append(e),r}function ll(t){return t.flat(1/0).filter((t=>null!=t)).map(sl)}function sl(t){return"function"==typeof t.render?t:new cl(t)}No.prototype.plot=function({marks:t=[],...e}={}){return il({...e,marks:[...t,this]})};class cl extends No{constructor(t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function ul(t,e){for(const n in t)fl(t[n],e);return t}function fl(t,e){const{scale:n,transform:r=!0}=t;if(null==n||!r)return;const{type:o,percent:i,interval:a,transform:l=(i?t=>100*t:Nt(a,o))}=e[n]??{};null!=l&&(t.value=ht(t.value,l),t.transform=!1)}function hl(t){for(const e in t)un(e,t[e])}function dl(t,e,n,r=H){for(const{channels:o}of e.values())for(const e in o){const i=o[e],{scale:a}=i;if(null!=a&&r(a))if("projection"===a){if(!sr(n)){const e=void 0===n.x?.domain,r=void 0===n.y?.domain;if(e||r){const[n,o]=ur(i);e&&pl(t,"x",n),r&&pl(t,"y",o)}}}else pl(t,a,i)}return t}function pl(t,e,n){const r=t.get(e);void 0!==r?r.push(n):t.set(e,[n])}function ml(t,e,n){if(null===t.facet||"super"===t.facet)return;const{fx:r,fy:o}=t;if(null!=r||null!=o){const e=ft(t.data??r??o);if(void 0===e)throw new Error(`missing facet data in ${t.ariaLabel}`);if(null===e)return;const i={};return null!=r&&(i.fx=ln(e,{value:r,scale:"fx"})),null!=o&&(i.fy=ln(e,{value:o,scale:"fy"})),ul(i,n),{channels:i,groups:ko(e,i)}}if(void 0===e)return;const{channels:i,groups:a,data:l}=e;if("auto"!==t.facet||t.data===l)return{channels:i,groups:a};l.length>0&&(a.size>1||1===a.size&&i.fx&&i.fy&&[...a][0][1].size>1)&&ft(t.data)?.length===l.length&&Sn(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function yl(t,e={}){return xe({...e,x:null,y:null},((e,n,r,o,i,a)=>a.getMarkState(t)))}function gl(t,e,n,r,o,i,a){if(!e)return;const l=/^\s*both\s*$/i.test(e);a=function(t,e,{line:n=e.line,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h=e.label,labelAnchor:d,labelArrow:p=e.labelArrow,labelOffset:m}){return{anchor:t,line:n,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h,labelAnchor:d,labelArrow:p,labelOffset:m}}(l?r:e,i,a);const{line:s}=a;n!==ha&&n!==pa||!s||Jt(s)||t.push(Ua(function(t){const{anchor:e,line:n}=t;return{anchor:e,facetAnchor:e+"-empty",stroke:!0===n?void 0:n}}(a))),t.push(n(a)),l&&t.push(n({...a,anchor:o,label:null}))}function vl(t,e,n,r){e&&!Jt(e)&&t.push(n(function(t,{stroke:e=(Vt(t)?t:void 0),ticks:n=(xl(t)?t:void 0),tickSpacing:r,ariaLabel:o,ariaDescription:i}){return{stroke:e,ticks:n,tickSpacing:r,ariaLabel:o,ariaDescription:i}}(e,r)))}function xl(t){switch(typeof t){case"number":return!0;case"string":return!Vt(t)}return qt(t)||"function"==typeof t?.range}function wl(t,e){const n=`${e}-axis `;return t.some((t=>t.ariaLabel?.startsWith(n)))}function bl(t,e){for(const n of e)for(const e in n.channels){const{scale:r}=n.channels[e];if(r===t||"projection"===r)return!0}return!1}function kl(t){const e=t.domain();let n=t(e[0]),r=t(e[e.length-1]);return r<n&&([n,r]=[r,n]),[n,r+t.bandwidth()]}const $l=new Map([["basis",e.curveBasis],["basis-closed",e.curveBasisClosed],["basis-open",e.curveBasisOpen],["bundle",e.curveBundle],["bump-x",e.curveBumpX],["bump-y",e.curveBumpY],["cardinal",e.curveCardinal],["cardinal-closed",e.curveCardinalClosed],["cardinal-open",e.curveCardinalOpen],["catmull-rom",e.curveCatmullRom],["catmull-rom-closed",e.curveCatmullRomClosed],["catmull-rom-open",e.curveCatmullRomOpen],["linear",e.curveLinear],["linear-closed",e.curveLinearClosed],["monotone-x",e.curveMonotoneX],["monotone-y",e.curveMonotoneY],["natural",e.curveNatural],["step",e.curveStep],["step-after",e.curveStepAfter],["step-before",e.curveStepBefore]]);function Ml(t=e.curveLinear,n){if("function"==typeof t)return t;const r=$l.get(`${t}`.toLowerCase());if(!r)throw new Error(`unknown curve: ${t}`);if(void 0!==n){if("beta"in r)return r.beta(n);if("tension"in r)return r.tension(n);if("alpha"in r)return r.alpha(n)}return r}function Ll(t=Al,e){return"function"!=typeof t&&"auto"===`${t}`.toLowerCase()?Al:Ml(t,e)}function Al(t){return e.curveLinear(t)}function Sl(t={y:"count"},e={}){[t,e]=Bl(t,e);const{x:n,y:r}=e;return Tl(Nl(n,e,X),null,null,r,t,ai(e))}function zl(t={x:"count"},e={}){[t,e]=Bl(t,e);const{x:n,y:r}=e;return Tl(null,Nl(r,e,X),n,null,t,li(e))}function Ol(t={fill:"count"},e={}){[t,e]=Bl(t,e);const{x:n,y:r}=function(t){let{x:e,y:n}=t;return e=Nl(e,t),n=Nl(n,t),[e.value,n.value]=kt(e.value,n.value),{x:e,y:n}}(e);return Tl(n,r,null,null,t,ai(li(e)))}function El(t,e,n={}){if(null==n?.interval)return n;const{reduce:r=Qe}=n,o={filter:null};return null!=n[e]&&(o[e]=r),null!=n[`${e}1`]&&(o[`${e}1`]=r),null!=n[`${e}2`]&&(o[`${e}2`]=r),t(o,n)}function Rl(t={}){return El(Sl,"y",jo(t,"x"))}function Cl(t={}){return El(zl,"x",jo(t,"y"))}function Tl(t,e,n,r,{data:o=Ze,filter:i=tn,sort:a,reverse:l,...s}={},c={}){t=Il(t),e=Il(e),s=function(t,e){return Ne(t,e,Wl)}(s,c),o=ql(o,X),a=null==a?void 0:Wl("sort",a,c),i=null==i?void 0:jl("filter",i,c),null!=n&&Be(s,"x","x1","x2")&&(n=null),null!=r&&Be(s,"y","y1","y2")&&(r=null);const[u,f]=Rt(t),[h,d]=Rt(t),[p,m]=Rt(e),[y,g]=Rt(e),[v,x]=null!=n?[n,"x"]:null!=r?[r,"y"]:[],[w,b]=Rt(v),{x:k,y:$,z:M,fill:L,stroke:A,x1:S,x2:z,y1:O,y2:E,domain:R,cumulative:C,thresholds:T,interval:B,...N}=c,[I,P]=Rt(M),[W]=lt(L),[j]=lt(A),[F,D]=Rt(W),[Y,_]=Rt(j);return{..."z"in c&&{z:I||M},..."fill"in c&&{fill:F||L},..."stroke"in c&&{stroke:Y||A},...ve(N,((n,r,c)=>{const u=Bt(q(n,v),c?.[x]),h=q(n,M),p=q(n,W),y=q(n,j),w=Xe(s,{z:h,fill:p,stroke:y}),k=[],$=[],L=u&&b([]),A=h&&P([]),S=p&&D([]),z=y&&_([]),O=t&&f([]),E=t&&d([]),R=e&&m([]),C=e&&g([]),T=function(t,e,n){const r=t?.(n),o=e?.(n);return r&&o?function*(t){const e=r.bin(t);for(const[t,[i,a]]of r.entries()){const r=o.bin(e[t]);for(const[t,[e,l]]of o.entries())yield[r[t],{data:n,x1:i,y1:e,x2:a,y2:l}]}}:r?function*(t){const e=r.bin(t);for(const[t,[o,i]]of r.entries())yield[e[t],{data:n,x1:o,x2:i}]}:function*(t){const e=o.bin(t);for(const[t,[r,i]]of o.entries())yield[e[t],{data:n,y1:r,y2:i}]}}(t,e,n);let B=0;for(const t of s)t.initialize(n);a&&a.initialize(n),i&&i.initialize(n);for(const t of r){const e=[];for(const e of s)e.scope("facet",t);a&&a.scope("facet",t),i&&i.scope("facet",t);for(const[r,l]of We(t,w))for(const[t,c]of We(l,u))for(const[l,f]of T(c))if(!i||i.reduce(l,f)){e.push(B++),$.push(o.reduceIndex(l,n,f)),u&&L.push(t),h&&A.push(w===h?r:h[(l.length>0?l:c)[0]]),p&&S.push(w===p?r:p[(l.length>0?l:c)[0]]),y&&z.push(w===y?r:y[(l.length>0?l:c)[0]]),O&&(O.push(f.x1),E.push(f.x2)),R&&(R.push(f.y1),C.push(f.y2));for(const t of s)t.reduce(l,f);a&&a.reduce(l)}k.push(e)}return Ue(k,a,l),{data:$,facets:k}})),...!Be(s,"x")&&(u?{x1:u,x2:h,x:Tt(u,h)}:{x:k,x1:S,x2:z}),...!Be(s,"y")&&(p?{y1:p,y2:y,y:Tt(p,y)}:{y:$,y1:O,y2:E}),...w&&{[x]:w},...Object.fromEntries(s.map((({name:t,output:e})=>[t,e])))}}function Bl({cumulative:t,domain:e,thresholds:n,interval:r,...o},i){return[o,{cumulative:t,domain:e,thresholds:n,interval:r,...i}]}function Nl(t,{cumulative:e,domain:n,thresholds:r,interval:o},i){return void 0===(t={...jt(t)}).domain&&(t.domain=n),void 0===t.cumulative&&(t.cumulative=e),void 0===t.thresholds&&(t.thresholds=r),void 0===t.interval&&(t.interval=o),void 0===t.value&&(t.value=i),t.thresholds=Pl(t.thresholds,t.interval),t}function Il(t){if(null==t)return;const{value:n,cumulative:r,domain:o=e.extent,thresholds:i}=t,a=t=>{let a,l=q(t,n);if(Yt(l)||(function(t){return Wt(t)&&"function"==typeof t?.floor&&t.floor()instanceof Date}(s=i)||qt(s)&&Yt(s))){l=ht(l,at,Float64Array);let[t,n]="function"==typeof o?o(l):o,r="function"!=typeof i||Wt(i)?i:i(l,t,n);"number"==typeof r&&(r=e.utcTickInterval(t,n,r)),Wt(r)&&(o===e.extent&&(t=r.floor(t),n=r.offset(r.floor(n))),r=r.range(t,r.offset(n))),a=r}else{l=nt(l);let[t,n]="function"==typeof o?o(l):o,r="function"!=typeof i||Wt(i)?i:i(l,t,n);if("number"==typeof r)if(o===e.extent){let o=e.tickIncrement(t,n,r);if(isFinite(o))if(o>0){let e=Math.round(t/o),i=Math.round(n/o);e*o<=t||--e,i*o>n||++i;let a=i-e+1;r=new Float64Array(a);for(let t=0;t<a;++t)r[t]=(e+t)*o}else if(o<0){o=-o;let e=Math.round(t*o),i=Math.round(n*o);e/o<=t||--e,i/o>n||++i;let a=i-e+1;r=new Float64Array(a);for(let t=0;t<a;++t)r[t]=(e+t)/o}else r=[t];else r=[t]}else r=e.ticks(t,n,r);else Wt(r)&&(o===e.extent&&(t=r.floor(t),n=r.offset(r.floor(n))),r=r.range(t,r.offset(n)));a=r}var s;const c=[];if(1===a.length)c.push([a[0],a[0]]);else for(let t=1;t<a.length;++t)c.push([a[t-1],a[t]]);return c.bin=(r<0?Gl:r>0?_l:Yl)(c,a,l),c};return a.label=Ct(n),a}function Pl(t,n,r=Dl){if(void 0===t)return void 0===n?r:Pt(n);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return e.thresholdFreedmanDiaconis;case"scott":return e.thresholdScott;case"sturges":return e.thresholdSturges;case"auto":return Dl}return R(t)}return t}function Wl(t,e,n){return Ie(t,e,n,jl)}function jl(t,e,n){return Pe(t,e,n,ql)}function ql(t,e){return je(t,e,Fl)}function Fl(t){switch(`${t}`.toLowerCase()){case"x":return Ul;case"x1":return Vl;case"x2":return Zl;case"y":return Hl;case"y1":return Ql;case"y2":return Jl}throw new Error(`invalid bin reduce: ${t}`)}function Dl(t,n,r){return Math.min(200,e.thresholdScott(t,n,r))}function Yl(t,n,r){return n=nt(n),o=>{const i=t.map((()=>[]));for(const t of o)i[e.bisect(n,r[t])-1]?.push(t);return i}}function _l(t,e,n){const r=Yl(t,e,n);return t=>{const e=r(t);for(let t=1,n=e.length;t<n;++t){const n=e[t-1],r=e[t];for(const t of n)r.push(t)}return e}}function Gl(t,e,n){const r=Yl(t,e,n);return t=>{const e=r(t);for(let t=e.length-2;t>=0;--t){const n=e[t+1],r=e[t];for(const t of n)r.push(t)}return e}}function Xl(t,e){const n=(+t+ +e)/2;return t instanceof Date?new Date(n):n}const Ul={reduceIndex:(t,e,{x1:n,x2:r})=>Xl(n,r)},Hl={reduceIndex:(t,e,{y1:n,y2:r})=>Xl(n,r)},Vl={reduceIndex:(t,e,{x1:n})=>n},Zl={reduceIndex:(t,e,{x2:n})=>n},Ql={reduceIndex:(t,e,{y1:n})=>n},Jl={reduceIndex:(t,e,{y2:n})=>n};function Kl(t={}){return pt(t)?t:{...t,x:X}}function ts(t={}){return mt(t)?t:{...t,y:X}}function es(t={},e={}){1===arguments.length&&([t,e]=is(t));const{y1:n,y:r=n,x:o,...i}=e,[a,l,s,c]=ls(r,o,"y","x",t,i);return{...a,y1:n,y:l,x1:s,x2:c,x:Tt(s,c)}}function ns(t={},e={}){1===arguments.length&&([t,e]=is(t));const{x1:n,x:r=n,y:o,...i}=e,[a,l,s,c]=ls(r,o,"x","y",t,i);return{...a,x1:n,x:l,y1:s,y2:c,y:Tt(s,c)}}function rs({x:t,x1:e,x2:n,...r}={}){return r=jo(r,"y"),void 0===e&&void 0===n?es({x:t,...r}):([e,n]=bt(t,e,n),{...r,x1:e,x2:n})}function os({y:t,y1:e,y2:n,...r}={}){return r=jo(r,"x"),void 0===e&&void 0===n?ns({y:t,...r}):([e,n]=bt(t,e,n),{...r,y1:e,y2:n})}function is(t){const{offset:e,order:n,reverse:r,...o}=t;return[{offset:e,order:n,reverse:r},o]}const as={length:!0};function ls(t,n=U,i,a,{offset:l,order:s,reverse:c},u){if(null===n)throw new Error(`stack requires ${a}`);const f=$t(u),[h,d]=Rt(t),[p,m]=Et(n),[y,g]=Et(n);return p.hint=y.hint=as,l=function(t){if(null==t)return;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return cs;case"center":case"silhouette":return us;case"wiggle":return fs}throw new Error(`unknown offset: ${t}`)}(l),s=function(t,n,i){if(void 0===t&&n===fs)return ps(r);if(null==t)return;if("string"==typeof t){const n=t.startsWith("-"),a=n?o:r;switch((n?t.slice(1):t).toLowerCase()){case"value":case i:return function(t){return(e,n,r)=>(e,n)=>t(r[e],r[n])}(a);case"z":return function(t){return(e,n,r,o)=>(e,n)=>t(o[e],o[n])}(a);case"sum":return function(t){return gs(t,((t,n,r,o)=>e.groupSort(Mt(t),(t=>e.sum(t,(t=>r[t]))),(t=>o[t]))))}(a);case"appearance":return function(t){return gs(t,((t,n,r,o)=>e.groupSort(Mt(t),(t=>n[e.greatest(t,(t=>r[t]))]),(t=>o[t]))))}(a);case"inside-out":return ps(a)}return ms(_(t))}if("function"==typeof t)return(1===t.length?ms:ys)(t);if(Array.isArray(t))return a=t,gs(r,(()=>a));var a;throw new Error(`invalid order: ${t}`)}(s,l,a),[ve(u,((r,o,a)=>{({data:r,facets:o}=function(t,e){if(1===e.length)return{data:t,facets:e};const n=t.length,r=new Uint8Array(n);let o=0;for(const t of e)for(const e of t)r[e]&&++o,r[e]=1;if(0===o)return{data:t,facets:e};const i=(t=dt(t))[j]=new Uint32Array(n+o);e=e.map((t=>dt(t,Uint32Array)));let a=n;r.fill(0);for(const n of e)for(let e=0,o=n.length;e<o;++e){const o=n[e];r[o]?(n[e]=a,t[a]=t[o],i[a]=o,++a):i[o]=o,r[o]=1}return{data:t,facets:e}}(r,o));const u=null==t?void 0:d(Bt(q(r,t),a?.[i])),h=q(r,n,Float64Array),p=q(r,f),y=s&&s(r,u,h,p),v=r.length,x=m(new Float64Array(v)),w=g(new Float64Array(v)),b=[];for(const t of o){const n=u?Array.from(e.group(t,(t=>u[t])).values()):[t];if(y)for(const t of n)t.sort(y);for(const t of n){let e=0,n=0;c&&t.reverse();for(const r of t){const t=h[r];t<0?e=w[r]=(x[r]=e)+t:t>0?n=w[r]=(x[r]=n)+t:w[r]=x[r]=n}}b.push(n)}return l&&l(b,x,w,p),{data:r,facets:o}})),h,p,y]}function ss(t,e){let n=0,r=0;for(const o of t){const t=e[o];t<n&&(n=t),t>r&&(r=t)}return[n,r]}function cs(t,e,n){for(const r of t)for(const t of r){const[r,o]=ss(t,n);for(const i of t){const t=1/(o-r||1);e[i]=t*(e[i]-r),n[i]=t*(n[i]-r)}}}function us(t,e,n){for(const r of t){for(const t of r){const[r,o]=ss(t,n);for(const i of t){const t=(o+r)/2;e[i]-=t,n[i]-=t}}hs(r,e,n)}ds(t,e,n)}function fs(t,n,r,o){for(const i of t){const t=new e.InternMap;let a=0;for(const l of i){let i=-1;const s=l.map((t=>Math.abs(r[t]-n[t]))),c=l.map((e=>{i=o?o[e]:++i;const a=r[e]-n[e],l=t.has(i)?a-t.get(i):0;return t.set(i,a),l})),u=[0,...e.cumsum(c)];for(const t of l)n[t]+=a,r[t]+=a;const f=e.sum(s);f&&(a-=e.sum(s,((t,e)=>(c[e]/2+u[e])*t))/f)}hs(i,n,r)}ds(t,n,r)}function hs(t,n,r){const o=e.min(t,(t=>e.min(t,(t=>n[t]))));for(const e of t)for(const t of e)n[t]-=o,r[t]-=o}function ds(t,n,r){const o=t.length;if(1===o)return;const i=t.map((t=>t.flat())),a=i.map((t=>(e.min(t,(t=>n[t]))+e.max(t,(t=>r[t])))/2)),l=e.min(a);for(let t=0;t<o;t++){const e=l-a[t];for(const o of i[t])n[o]+=e,r[o]+=e}}function ps(t){return gs(t,((t,n,r,o)=>{const i=Mt(t),a=e.groupSort(i,(t=>n[e.greatest(t,(t=>r[t]))]),(t=>o[t])),l=e.rollup(i,(t=>e.sum(t,(t=>r[t]))),(t=>o[t])),s=[],c=[];let u=0;for(const t of a)u<0?(u+=l.get(t),s.push(t)):(u-=l.get(t),c.push(t));return c.reverse().concat(s)}))}function ms(t){return e=>{const n=q(e,t);return(t,e)=>r(n[t],n[e])}}function ys(t){return e=>(n,r)=>t(e[n],e[r])}function gs(t,n){return(r,o,i,a)=>{if(!a)throw new Error("missing channel: z");const l=new e.InternMap(n(r,o,i,a).map(((t,e)=>[t,e])));return(e,n)=>t(l.get(a[e]),l.get(a[n]))}}const vs={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class xs extends No{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,z:a,curve:l,tension:s}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0},z:{value:$t(e),optional:!0}},e,vs),this.z=a,this.curve=Ml(l,s)}filter(t){return t}render(t,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l}=r;return Qn("svg:g",i).call(jn,this,o,i).call(Yn,this,n,0,0).call((n=>n.selectAll().data(Pn(t,[a,l,s,c],this,r)).enter().append("path").call(qn,this).call(Nn,this,r).attr("d",e.area().curve(this.curve).defined((t=>t>=0)).x0((t=>a[t])).y0((t=>l[t])).x1((t=>s[t])).y1((t=>c[t]))))).node()}}function ws(t,e){return void 0===e?ks(t,{x:Q,y:J}):new xs(t,e)}function bs(t,e){const{y:n=G,...r}=Cl(e);return new xs(t,rs(Kl({...r,y1:n,y2:void 0})))}function ks(t,e){const{x:n=G,...r}=Rl(e);return new xs(t,os(ts({...r,x1:n,x2:void 0})))}const $s={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Ms extends No{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,curve:a,tension:l}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,$s),this.curve=Ll(a,l),Vo(this,e)}project(t,e,n){this.curve!==Al&&super.project(t,e,n)}render(t,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l}=r,{curve:u}=this;return Qn("svg:g",i).call(jn,this,o,i).call(Yn,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(qn,this).attr("d",u===Al&&i.projection?function(t,n,r,o,i){const a=e.geoPath(t);return n=nt(n),r=nt(r),o=nt(o),i=nt(i),t=>a({type:"LineString",coordinates:[[n[t],r[t]],[o[t],i[t]]]})}(i.projection,a,l,s,c):t=>{const n=e.pathRound(),r=u(n);return r.lineStart(),r.point(a[t],l[t]),r.point(s[t],c[t]),r.lineEnd(),n}).call(Bn,this,r).call(ri,this,r,i))).node()}}function Ls(t,{x:e,x1:n,x2:r,y:o,y1:i,y2:a,...l}={}){return[n,r]=As(e,n,r),[i,a]=As(o,i,a),new Ms(t,{...l,x1:n,x2:r,y1:i,y2:a})}function As(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[n]}else if(void 0===n)return[e]}else{if(void 0===e)return void 0===n?[t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const Ss={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class zs extends No{constructor(t,n={}){const{x1:r,y1:o,x2:i,y2:a,bend:l=0,headAngle:s=60,headLength:c=8,inset:u=0,insetStart:f=u,insetEnd:h=u,sweep:d}=n;super(t,{x1:{value:r,scale:"x"},y1:{value:o,scale:"y"},x2:{value:i,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0}},n,Ss),this.bend=!0===l?22.5:Math.max(-90,Math.min(90,l)),this.headAngle=+s,this.headLength=+c,this.insetStart=+f,this.insetEnd=+h,this.sweep=function(t=1){if("number"==typeof t)return tt(Math.sign(t));if("function"==typeof t)return(e,n,r,o)=>Math.sign(t(e,n,r,o));switch(ut(t,"sweep",["+x","-x","+y","-y"])){case"+x":return(t,n,r)=>e.ascending(t,r);case"-x":return(t,n,r)=>e.descending(t,r);case"+y":return(t,n,r,o)=>e.ascending(n,o);case"-y":return(t,n,r,o)=>e.descending(n,o)}}(d)}render(t,e,n,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a,SW:c}=n,{strokeWidth:u,bend:f,headAngle:h,headLength:d,insetStart:p,insetEnd:m}=this,y=c?t=>c[t]:tt(void 0===u?1:u),g=h*Ho/2,v=d/1.5;return Qn("svg:g",o).call(jn,this,r,o).call(Yn,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(qn,this).attr("d",(t=>{let e=i[t],n=a[t],r=l[t],o=s[t];const c=Math.hypot(r-e,o-n);if(c<=p+m)return null;let u=Math.atan2(o-n,r-e);const h=Math.min(v*y(t),c/3),d=this.sweep(e,n,r,o)*f*Ho,x=Math.hypot(c/Math.tan(d),c)/2;if(p||m)if(x<1e5){const t=Math.sign(d),[i,a]=function([t,e],[n,r],o,i){const a=n-t,l=r-e,s=Math.hypot(a,l),c=i*Math.sqrt(o*o-s*s/4)/s;return[(t+n)/2-l*c,(e+r)/2+a*c]}([e,n],[r,o],x,t);if(p&&([e,n]=Os([i,a,x],[e,n,p],-t*Math.sign(p))),m){const[e,n]=Os([i,a,x],[r,o,m],t*Math.sign(m));u+=Math.atan2(n-a,e-i)-Math.atan2(o-a,r-i),r=e,o=n}}else{const t=r-e,i=o-n,a=Math.hypot(t,i);p&&(e+=t/a*p,n+=i/a*p),m&&(r-=t/a*m,o-=i/a*m)}const w=u+d,b=w+g,k=w-g,$=r-h*Math.cos(b),M=o-h*Math.sin(b),L=r-h*Math.cos(k),A=o-h*Math.sin(k);return`M${e},${n}${x<1e5?`A${x},${x} 0,0,${d>0?1:0} `:"L"}${r},${o}${h?`M${$},${M}L${r},${o}L${L},${A}`:""}`})).call(Bn,this,n))).node()}}function Os([t,e,n],[r,o,i],a){const l=r-t,s=o-e,c=Math.hypot(l,s),u=(l*l+s*s-i*i+n*n)/(2*c),f=a*Math.sqrt(n*n-u*u);return[t+(l*u+s*f)/c,e+(s*u-l*f)/c]}class Es extends No{constructor(t,e,n={},r){super(t,e,n,r);const{inset:o=0,insetTop:i=o,insetRight:a=o,insetBottom:l=o,insetLeft:s=o,rx:c,ry:u}=n;this.insetTop=Z(i),this.insetRight=Z(a),this.insetBottom=Z(l),this.insetLeft=Z(s),this.rx=_n(c,"auto"),this.ry=_n(u,"auto")}render(t,e,n,r,o){const{rx:i,ry:a}=this;return Qn("svg:g",o).call(jn,this,r,o).call(this._transform,this,e).call((o=>o.selectAll().data(t).enter().append("rect").call(qn,this).attr("x",this._x(e,n,r)).attr("width",this._width(e,n,r)).attr("y",this._y(e,n,r)).attr("height",this._height(e,n,r)).call(Dn,"rx",i).call(Dn,"ry",a).call(Bn,this,n))).node()}_x(t,{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e?t=>e[t]+r:n+r}_y(t,{y:e},{marginTop:n}){const{insetTop:r}=this;return e?t=>e[t]+r:n+r}_width({x:t},{x:e},{marginRight:n,marginLeft:r,width:o}){const{insetLeft:i,insetRight:a}=this,l=e&&t?t.bandwidth():o-n-r;return Math.max(0,l-i-a)}_height({y:t},{y:e},{marginTop:n,marginBottom:r,height:o}){const{insetTop:i,insetBottom:a}=this,l=e&&t?t.bandwidth():o-n-r;return Math.max(0,l-i-a)}}const Rs={ariaLabel:"bar"};class Cs extends Es{constructor(t,e={}){const{x1:n,x2:r,y:o}=e;super(t,{x1:{value:n,scale:"x"},x2:{value:r,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},e,Rs)}_transform(t,e,{x:n}){t.call(Yn,e,{x:n},0,0)}_x({x:t},{x1:e,x2:n},{marginLeft:r}){const{insetLeft:o}=this;return yo(t)?r+o:t=>Math.min(e[t],n[t])+o}_width({x:t},{x1:e,x2:n},{marginRight:r,marginLeft:o,width:i}){const{insetLeft:a,insetRight:l}=this;return yo(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(n[t]-e[t])-a-l)}}class Ts extends Es{constructor(t,e={}){const{x:n,y1:r,y2:o}=e;super(t,{y1:{value:r,scale:"y"},y2:{value:o,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e,Rs)}_transform(t,e,{y:n}){t.call(Yn,e,{y:n},0,0)}_y({y:t},{y1:e,y2:n},{marginTop:r}){const{insetTop:o}=this;return yo(t)?r+o:t=>Math.min(e[t],n[t])+o}_height({y:t},{y1:e,y2:n},{marginTop:r,marginBottom:o,height:i}){const{insetTop:a,insetBottom:l}=this;return yo(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(n[t]-e[t])-a-l)}}function Bs(t,e={}){return yt(e)||(e={...e,y:G,x2:X}),new Cs(t,rs(pi(Kl(e))))}function Ns(t,e={}){return yt(e)||(e={...e,x:G,y2:X}),new Ts(t,os(mi(ts(e))))}const Is={ariaLabel:"cell"};class Ps extends Es{constructor(t,{x:e,y:n,...r}={}){super(t,{x:{value:e,scale:"x",type:"band",optional:!0},y:{value:n,scale:"y",type:"band",optional:!0}},r,Is)}_transform(t,e){t.call(Yn,e,{},0,0)}}function Ws(t,{x:e,y:n,...r}={}){return[e,n]=kt(e,n),new Ps(t,{...r,x:e,y:n})}const js={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function qs(t){return void 0===t.sort&&void 0===t.reverse?Le({channel:"-r"},t):t}class Fs extends No{constructor(t,n={}){const{x:r,y:o,r:i,rotate:a,symbol:s=e.symbolCircle,frameAnchor:c}=n,[u,f]=st(a,0),[h,d]=function(t){if(null==t||me(t))return[void 0,t];if("string"==typeof t){const e=pe.get(`${t}`.toLowerCase());if(e)return[void 0,e]}return[t,void 0]}(s),[p,m]=st(i,null==h?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},r:{value:p,scale:"r",filter:l,optional:!0},rotate:{value:u,optional:!0},symbol:{value:h,scale:"auto",optional:!0}},qs(n),js),this.r=m,this.rotate=f,this.symbol=d,this.frameAnchor=te(c);const{channels:y}=this,{symbol:g}=y;if(g){const{fill:t,stroke:e}=y;g.hint={fill:t?t.value===g.value?"color":"currentColor":this.fill??"currentColor",stroke:e?e.value===g.value?"color":"currentColor":this.stroke??"none"}}}render(t,n,r,o,i){const{x:a,y:l}=n,{x:c,y:u,r:f,rotate:h,symbol:d}=r,{r:p,rotate:m,symbol:y}=this,[g,v]=Vn(this,o),x=y===e.symbolCircle,w=f?void 0:p*p*Math.PI;return s(p)&&(t=[]),Qn("svg:g",i).call(jn,this,o,i).call(Yn,this,{x:c&&a,y:u&&l}).call((n=>n.selectAll().data(t).enter().append(x?"circle":"path").call(qn,this).call(x?t=>{t.attr("cx",c?t=>c[t]:g).attr("cy",u?t=>u[t]:v).attr("r",f?t=>f[t]:p)}:t=>{t.attr("transform",Mi`translate(${c?t=>c[t]:g},${u?t=>u[t]:v})${h?t=>` rotate(${h[t]})`:m?` rotate(${m})`:""}`).attr("d",f&&d?t=>{const n=e.pathRound();return d[t].draw(n,f[t]*f[t]*Math.PI),n}:f?t=>{const n=e.pathRound();return y.draw(n,f[t]*f[t]*Math.PI),n}:d?t=>{const n=e.pathRound();return d[t].draw(n,w),n}:(()=>{const t=e.pathRound();return y.draw(t,w),t})())}).call(Bn,this,r))).node()}}function Ds(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=kt(e,n)),new Fs(t,{...r,x:e,y:n})}const Ys={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class _s extends No{constructor(t,e={}){const{x:n,y:r,z:o,curve:i,tension:a}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:$t(e),optional:!0}},e,Ys),this.z=o,this.curve=Ll(i,a),Vo(this,e)}filter(t){return t}project(t,e,n){this.curve!==Al&&super.project(t,e,n)}render(t,n,r,o,i){const{x:a,y:l}=r,{curve:s}=this;return Qn("svg:g",i).call(jn,this,o,i).call(Yn,this,n).call((n=>n.selectAll().data(Pn(t,[a,l],this,r)).enter().append("path").call(qn,this).call(Nn,this,r).call(oi,this,r,i).attr("d",s===Al&&i.projection?function(t,n,r){const o=e.geoPath(t);return n=nt(n),r=nt(r),t=>{let e=[];const i=[e];for(const o of t)-1===o?(e=[],i.push(e)):e.push([n[o],r[o]]);return o({type:"MultiLineString",coordinates:i})}}(i.projection,a,l):e.line().curve(s).defined((t=>t>=0)).x((t=>a[t])).y((t=>l[t]))))).node()}}function Gs(t,{x:e,y:n,...r}={}){return[e,n]=kt(e,n),new _s(t,{...r,x:e,y:n})}function Xs(t,{x:e=X,y:n=G,...r}={}){return new _s(t,Cl({...r,x:e,y:n}))}function Us(t,{x:e=G,y:n=X,...r}={}){return new _s(t,Rl({...r,x:e,y:n}))}const Hs={ariaLabel:"rect"};class Vs extends No{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,inset:a=0,insetTop:l=a,insetRight:s=a,insetBottom:c=a,insetLeft:u=a,rx:f,ry:h}=e;super(t,{x1:{value:n,scale:"x",type:null!=n&&null==o?"band":void 0,optional:!0},y1:{value:r,scale:"y",type:null!=r&&null==i?"band":void 0,optional:!0},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,Hs),this.insetTop=Z(l),this.insetRight=Z(s),this.insetBottom=Z(c),this.insetLeft=Z(u),this.rx=_n(f,"auto"),this.ry=_n(h,"auto")}render(t,e,n,r,o){const{x:i,y:a}=e,{x1:l,y1:s,x2:c,y2:u}=n,{marginTop:f,marginRight:h,marginBottom:d,marginLeft:p,width:m,height:y}=r,{projection:g}=o,{insetTop:v,insetRight:x,insetBottom:w,insetLeft:b,rx:k,ry:$}=this,M=(i?.bandwidth?i.bandwidth():0)-b-x,L=(a?.bandwidth?a.bandwidth():0)-v-w;return Qn("svg:g",o).call(jn,this,r,o).call(Yn,this,{},0,0).call((e=>e.selectAll().data(t).enter().append("rect").call(qn,this).attr("x",!l||!g&&yo(i)?p+b:c?t=>Math.min(l[t],c[t])+b:t=>l[t]+b).attr("y",!s||!g&&yo(a)?f+v:u?t=>Math.min(s[t],u[t])+v:t=>s[t]+v).attr("width",!l||!g&&yo(i)?m-h-p-x-b:c?t=>Math.max(0,Math.abs(c[t]-l[t])+M):M).attr("height",!s||!g&&yo(a)?y-f-d-v-w:u?t=>Math.max(0,Math.abs(s[t]-u[t])+L):L).call(Dn,"rx",k).call(Dn,"ry",$).call(Bn,this,n))).node()}}function Zs(t,e){return new Vs(t,hi(di(e)))}function Qs(t,e={}){return yt(e)||(e={...e,y:G,x2:X,interval:1}),new Vs(t,rs(di(Kl(e))))}function Js(t,e={}){return yt(e)||(e={...e,x:G,y2:X,interval:1}),new Vs(t,os(hi(ts(e))))}function Ks(t,e){e=function({x:t,y:e,color:n,size:r,fx:o,fy:i,mark:a}={}){xt(t)||(t=nc(t));xt(e)||(e=nc(e));xt(n)||(n=Vt(n)?{color:n}:nc(n));xt(r)||(r=nc(r));xt(o)&&({value:o}=nc(o));xt(i)&&({value:i}=nc(i));null!=a&&(a=`${a}`.toLowerCase());return{x:t,y:e,color:n,size:r,fx:o,fy:i,mark:a}}(e);const{x:n,y:r,color:o,size:i}=e,a=ec(t,n),l=ec(t,r),s=ec(t,o),c=ec(t,i);let u,f,h,{fx:d,fy:p,x:{value:m,reduce:y,zero:g,...v},y:{value:x,reduce:w,zero:b,...k},color:{value:$,color:M,reduce:L},size:{value:A,reduce:S},mark:z}=e;if(void 0===y&&(y=null==w&&null==m&&null==A&&null!=x?"count":null),void 0===w&&(w=null==y&&null==x&&null==A&&null!=m?"count":null),void 0!==S||null!=A||null!=L||null!=y||null!=w||null!=m&&!Dt(a)||null!=x&&!Dt(l)||(S="count"),void 0===g&&(g=!!rc(y)||void 0),void 0===b&&(b=!!rc(w)||void 0),null==m&&null==x)throw new Error("must specify x or y");if(null!=y&&null==x)throw new Error("reducing x requires y");if(null!=w&&null==m)throw new Error("reducing y requires x");switch(void 0===z&&(z=null!=A||null!=S?"dot":rc(y)||rc(w)||null!=L?"bar":null!=m&&null!=x?Dt(a)||Dt(l)||null==y&&null==w&&!tc(a)&&!tc(l)?"dot":"line":null!=m||null!=x?"rule":null),z){case"dot":h=Ds,f="stroke";break;case"line":h=a&&l||null!=y||null!=w?b||null!=w||a&&tc(a)?Us:g||null!=y||l&&tc(l)?Xs:Gs:a?Xs:Us,f="stroke",ic(s)&&(u=null);break;case"area":h=!b&&null==w&&(g||null!=y||l&&tc(l))?bs:ks,f="fill",ic(s)&&(u=null);break;case"rule":h=a?bi:ki,f="stroke";break;case"bar":h=null!=y?Dt(l)?oc(y)&&a&&Dt(a)?Ws:Bs:Qs:null!=w?Dt(a)?oc(w)&&l&&Dt(l)?Ws:Ns:Js:null!=L||null!=S?a&&Dt(a)&&l&&Dt(l)?Ws:a&&Dt(a)?Ns:l&&Dt(l)?Bs:Zs:!a||!Xt(a)||l&&Xt(l)?!l||!Xt(l)||a&&Xt(a)?Ws:Ns:Bs,f="fill";break;default:throw new Error(`invalid mark: ${z}`)}let O,E={fx:d,fy:p,x:a??void 0,y:l??void 0,[f]:s??M,z:u,r:c??void 0,tip:!0},R={[f]:L??void 0,r:S??void 0};if(null!=y&&null!=w)throw new Error("cannot reduce both x and y");return null!=w?(R.y=w,O=Dt(a)?Ee:Sl):null!=y?(R.x=y,O=Dt(l)?Re:zl):null==L&&null==S||(a&&l?O=Dt(a)&&Dt(l)?Ce:Dt(a)?zl:Dt(l)?Sl:Ol:a?O=Dt(a)?Ee:Sl:l&&(O=Dt(l)?Re:zl)),O!==Ol&&O!==Sl||(E.x={value:a,...v}),O!==Ol&&O!==zl||(E.y={value:l,...k}),void 0===g&&(g=a&&!(O===Ol||O===Sl)&&(h===Bs||h===bs||h===Qs||h===ki)),void 0===b&&(b=l&&!(O===Ol||O===zl)&&(h===Ns||h===ks||h===Js||h===bi)),{fx:d??null,fy:p??null,x:{value:m??null,reduce:y??null,zero:!!g,...v},y:{value:x??null,reduce:w??null,zero:!!b,...k},color:{value:$??null,reduce:L??null,...void 0!==M&&{color:M}},size:{value:A??null,reduce:S??null},mark:z,markImpl:lc[h],markOptions:E,transformImpl:lc[O],transformOptions:R,colorMode:f}}function tc(t){let n,r;for(const o of t){if(null==o)continue;if(void 0===n){n=o;continue}const t=Math.sign(e.ascending(n,o));if(t){if(void 0!==r&&t!==r)return!1;n=o,r=t}}return!0}function ec(t,e){const n=q(t,e.value);return n&&(n.label=Ct(e.value)),n}function nc(t){return function(t){if(null==t)return!1;if("function"==typeof t.reduceIndex)return!0;if("function"==typeof t.reduce&&gt(t))return!0;if(/^p\d{2}$/i.test(t))return!0;switch(`${t}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}(t)?{reduce:t}:{value:t}}function rc(t){return/^(?:distinct|count|sum|proportion)$/i.test(t)}function oc(t){return/^(?:first|last|mode)$/i.test(t)}function ic(t){return!!t&&new e.InternSet(t).size>t.length>>1}const ac={dot:Ds,line:Gs,lineX:Xs,lineY:Us,areaX:bs,areaY:ks,ruleX:bi,ruleY:ki,barX:Bs,barY:Ns,rect:Zs,rectX:Qs,rectY:Js,cell:Ws,bin:Ol,binX:Sl,binY:zl,group:Ce,groupX:Ee,groupY:Re},lc=Object.fromEntries(Object.entries(ac).map((([t,e])=>[e,t])));function sc(t,e={}){let{x:n,x1:r,x2:o}=e;void 0===n&&void 0===r&&void 0===o&&(e={...e,x:n=X});const i={};return null!=n&&(i.x=t),null!=r&&(i.x1=t),null!=o&&(i.x2=t),uc(i,e)}function cc(t,e={}){let{y:n,y1:r,y2:o}=e;void 0===n&&void 0===r&&void 0===o&&(e={...e,y:n=X});const i={};return null!=n&&(i.y=t),null!=r&&(i.y1=t),null!=o&&(i.y2=t),uc(i,e)}function uc(t={},n={}){const r=$t(n),o=Object.entries(t).map((([t,e])=>{const r=Ot(t,n);if(null==r)throw new Error(`missing channel: ${t}`);const[o,i]=Et(r);return{key:t,input:r,output:o,setOutput:i,map:fc(e)}}));return{...ve(n,((t,n)=>{const i=q(t,r),a=o.map((({input:e})=>q(t,e))),l=o.map((({setOutput:e})=>e(new Array(t.length))));for(const t of n)for(const n of i?e.group(t,(t=>i[t])).values():[t])o.forEach((({map:t},e)=>t.mapIndex(n,a[e],l[e])));return{data:t,facets:n}})),...Object.fromEntries(o.map((({key:t,output:e})=>[t,e])))}}function fc(t){if(null==t)throw new Error("missing map");if("function"==typeof t.mapIndex)return t;if("function"==typeof t.map&&gt(t))return function(t){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:t.map.bind(t)}}(t);if("function"==typeof t)return hc(At(t));switch(`${t}`.toLowerCase()){case"cumsum":return dc;case"rank":return hc(((t,n)=>e.rank(t,(t=>n[t]))));case"quantile":return hc(((t,n)=>function(t,n){const r=e.count(t,n)-1;return e.rank(t,n).map((t=>t/r))}(t,(t=>n[t]))))}throw new Error(`invalid map: ${t}`)}function hc(t){return{mapIndex(e,n,r){const o=t(e,n);if(o.length!==e.length)throw new Error("map function returned a mismatched length");for(let t=0,n=e.length;t<n;++t)r[e[t]]=o[t]}}}const dc={mapIndex(t,e,n){let r=0;for(const o of t)n[o]=r+=e[o]}};function pc(t={}){"number"==typeof t&&(t={k:t});let{k:n,reduce:r,shift:o,anchor:i,strict:a}=t;if(void 0===i&&void 0!==o&&(i=function(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}(o),Sn(`Warning: the shift option is deprecated; please use anchor "${i}" instead.`)),!((n=Math.floor(n))>0))throw new Error(`invalid k: ${n}`);return function(t="mean"){if("string"==typeof t){if(/^p\d{2}$/i.test(t))return mc(et(t));switch(t.toLowerCase()){case"deviation":return mc(e.deviation);case"max":return yc(((t,n)=>e.max(t,(t=>n[t]))));case"mean":return vc;case"median":return mc(e.median);case"min":return yc(((t,n)=>e.min(t,(t=>n[t]))));case"mode":return yc(((t,n)=>e.mode(t,(t=>n[t]))));case"sum":return gc;case"variance":return mc(e.variance);case"difference":return $c;case"ratio":return Mc;case"first":return Lc;case"last":return Ac}}if("function"!=typeof t)throw new Error(`invalid reduce: ${t}`);return yc(At(t))}(r)(n,function(t="middle",e){switch(`${t}`.toLowerCase()){case"middle":return e-1>>1;case"start":return 0;case"end":return e-1}throw new Error(`invalid anchor: ${t}`)}(i,n),a)}function mc(t){return(e,n,r)=>r?{mapIndex(r,o,i){const a=t=>null==o[t]?NaN:+o[t];let l=0;for(let t=0;t<e-1;++t)isNaN(a(t))&&++l;for(let o=0,s=r.length-e+1;o<s;++o)isNaN(a(o+e-1))&&++l,i[r[o+n]]=0===l?t(St(r,o,o+e),a):NaN,isNaN(a(o))&&--l}}:{mapIndex(r,o,i){const a=t=>null==o[t]?NaN:+o[t];for(let o=-n;o<0;++o)i[r[o+n]]=t(St(r,0,o+e),a);for(let o=0,l=r.length-n;o<l;++o)i[r[o+n]]=t(St(r,o,o+e),a)}}}function yc(t){return(e,r,o)=>o?{mapIndex(o,i,a){let l=0;for(let t=0;t<e-1;++t)l+=n(i[o[t]]);for(let s=0,c=o.length-e+1;s<c;++s)l+=n(i[o[s+e-1]]),l===e&&(a[o[s+r]]=t(St(o,s,s+e),i)),l-=n(i[o[s]])}}:{mapIndex(n,o,i){for(let a=-r;a<0;++a)i[n[a+r]]=t(St(n,0,a+e),o);for(let a=0,l=n.length-r;a<l;++a)i[n[a+r]]=t(St(n,a,a+e),o)}}}function gc(t,e,n){return n?{mapIndex(n,r,o){let i=0,a=0;for(let e=0;e<t-1;++e){const t=r[n[e]];null===t||isNaN(t)?++i:a+=+t}for(let l=0,s=n.length-t+1;l<s;++l){const s=r[n[l]],c=r[n[l+t-1]];null===c||isNaN(c)?++i:a+=+c,o[n[l+e]]=0===i?a:NaN,null===s||isNaN(s)?--i:a-=+s}}}:{mapIndex(n,r,o){let i=0;const a=n.length;for(let o=0,l=Math.min(a,t-e-1);o<l;++o)i+=+r[n[o]]||0;for(let l=-e,s=a-e;l<s;++l)i+=+r[n[l+t-1]]||0,o[n[l+e]]=i,i-=+r[n[l]]||0}}}function vc(t,e,n){if(n){const r=gc(t,e,n);return{mapIndex(n,o,i){r.mapIndex(n,o,i);for(let r=0,o=n.length-t+1;r<o;++r)i[n[r+e]]/=t}}}return{mapIndex(n,r,o){let i=0,a=0;const l=n.length;for(let o=0,s=Math.min(l,t-e-1);o<s;++o){let t=r[n[o]];null===t||isNaN(t=+t)||(i+=t,++a)}for(let s=-e,c=l-e;s<c;++s){let l=r[n[s+t-1]],c=r[n[s]];null===l||isNaN(l=+l)||(i+=l,++a),o[n[s+e]]=i/a,null===c||isNaN(c=+c)||(i-=c,--a)}}}}function xc(t,e,r,o){for(let i=r+o;r<i;++r){const o=t[e[r]];if(n(o))return o}}function wc(t,e,r,o){for(let i=r+o-1;i>=r;--i){const r=t[e[i]];if(n(r))return r}}function bc(t,e,n,r){for(let o=n+r;n<o;++n){let r=t[e[n]];if(null!==r&&!isNaN(r=+r))return r}}function kc(t,e,n,r){for(let o=n+r-1;o>=n;--o){let n=t[e[o]];if(null!==n&&!isNaN(n=+n))return n}}function $c(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i){const a=r[n[i]],l=r[n[i+t-1]];o[n[i+e]]=null===a||null===l?NaN:l-a}}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=kc(r,n,i,t)-bc(r,n,i,t)}}}function Mc(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i){const a=r[n[i]],l=r[n[i+t-1]];o[n[i+e]]=null===a||null===l?NaN:l/a}}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=kc(r,n,i,t)/bc(r,n,i,t)}}}function Lc(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i)o[n[i+e]]=r[n[i]]}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=xc(r,n,i,t)}}}function Ac(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i)o[n[i+e]]=r[n[i+t-1]]}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=wc(r,n,i,t)}}}const Sc={n:20,k:2,color:"currentColor",opacity:.2,strict:!0,anchor:"end"};function zc({n:t=Sc.n,k:n=0,strict:r=Sc.strict,anchor:o=Sc.anchor}={}){return pc({k:t,reduce:t=>e.mean(t)+n*(e.deviation(t)||0),strict:r,anchor:o})}const Oc={ariaLabel:"tick",fill:null,stroke:"currentColor"};class Ec extends No{constructor(t,e,n){super(t,e,n,Oc),Vo(this,n)}render(t,e,n,r,o){return Qn("svg:g",o).call(jn,this,r,o).call(this._transform,this,e).call((i=>i.selectAll().data(t).enter().append("line").call(qn,this).attr("x1",this._x1(e,n,r)).attr("x2",this._x2(e,n,r)).attr("y1",this._y1(e,n,r)).attr("y2",this._y2(e,n,r)).call(Bn,this,n).call(ri,this,n,o))).node()}}class Rc extends Ec{constructor(t,e={}){const{x:n,y:r,inset:o=0,insetTop:i=o,insetBottom:a=o}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y",type:"band",optional:!0}},e),this.insetTop=Z(i),this.insetBottom=Z(a)}_transform(t,e,{x:n}){t.call(Yn,e,{x:n},zn,0)}_x1(t,{x:e}){return t=>e[t]}_x2(t,{x:e}){return t=>e[t]}_y1({y:t},{y:e},{marginTop:n}){const{insetTop:r}=this;return e&&t?t=>e[t]+r:n+r}_y2({y:t},{y:e},{height:n,marginBottom:r}){const{insetBottom:o}=this;return e&&t?n=>e[n]+t.bandwidth()-o:n-r-o}}class Cc extends Ec{constructor(t,e={}){const{x:n,y:r,inset:o=0,insetRight:i=o,insetLeft:a=o}=e;super(t,{y:{value:r,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e),this.insetRight=Z(i),this.insetLeft=Z(a)}_transform(t,e,{y:n}){t.call(Yn,e,{y:n},0,zn)}_x1({x:t},{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e&&t?t=>e[t]+r:n+r}_x2({x:t},{x:e},{width:n,marginRight:r}){const{insetRight:o}=this;return e&&t?n=>e[n]+t.bandwidth()-o:n-r-o}_y1(t,{y:e}){return t=>e[t]}_y2(t,{y:e}){return t=>e[t]}}function Tc(t,{x:e=X,...n}={}){return new Rc(t,{...n,x:e})}function Bc(t,{y:e=X,...n}={}){return new Cc(t,{...n,y:e})}function Nc(t){const e=Ic(t),n=Pc(t);return t.map((t=>t<e||t>n?t:NaN))}function Ic(t){const n=2.5*Wc(t)-1.5*jc(t);return e.min(t,(t=>t>=n?t:NaN))}function Pc(t){const n=2.5*jc(t)-1.5*Wc(t);return e.max(t,(t=>t<=n?t:NaN))}function Wc(t){return e.quantile(t,.25)}function jc(t){return e.quantile(t,.75)}const qc={ariaLabel:"raster",stroke:null,pixelSize:1};function Fc(t,e){const n=+t;if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}function Dc(t,e){const n=Math.floor(t);if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}class Yc extends No{constructor(t,e,n={},r){let{width:o,height:i,x:a,y:l,x1:s=(null==a?0:void 0),y1:c=(null==l?0:void 0),x2:u=(null==a?o:void 0),y2:f=(null==l?i:void 0),pixelSize:h=r.pixelSize,blur:d=0,interpolate:p}=n;if(null!=o&&(o=Dc(o,"width")),null!=i&&(i=Dc(i,"height")),null!=s&&(s=Fc(s,"x1")),null!=c&&(c=Fc(c,"y1")),null!=u&&(u=Fc(u,"x2")),null!=f&&(f=Fc(f,"y2")),null==a&&(null==s||null==u))throw new Error("missing x");if(null==l&&(null==c||null==f))throw new Error("missing y");null!=t&&null!=o&&null!=i&&(void 0===a&&null!=s&&null!=u&&(a=function(t,e,n){return{transform(r){const o=r.length,i=new Float64Array(o),a=(e-t)/n,l=t+a/2;for(let t=0;t<o;++t)i[t]=t%n*a+l;return i}}}(s,u,o)),void 0===l&&null!=c&&null!=f&&(l=function(t,e,n,r){return{transform(o){const i=o.length,a=new Float64Array(i),l=(e-t)/r,s=t+l/2;for(let t=0;t<i;++t)a[t]=Math.floor(t/n)%r*l+s;return a}}}(c,f,o,i))),super(t,{x:{value:a,scale:"x",optional:!0},y:{value:l,scale:"y",optional:!0},x1:{value:null==s?null:[s],scale:"x",optional:!0,filter:null},y1:{value:null==c?null:[c],scale:"y",optional:!0,filter:null},x2:{value:null==u?null:[u],scale:"x",optional:!0,filter:null},y2:{value:null==f?null:[f],scale:"y",optional:!0,filter:null},...e},n,r),this.width=o,this.height=i,this.pixelSize=Fc(h,"pixelSize"),this.blur=Fc(d,"blur"),this.interpolate=null==a||null==l?null:function(t){if("function"==typeof t)return t;if(null==t)return Vc;switch(`${t}`.toLowerCase()){case"none":return Vc;case"nearest":return Kc;case"barycentric":return Zc();case"random-walk":return tu()}throw new Error(`invalid interpolate: ${t}`)}(p)}}class _c extends Yc{constructor(t,e={}){const{imageRendering:n}=e;if(null==t){const{fill:t,fillOpacity:n}=e;void 0!==st(n)[0]&&(e=Hc("fillOpacity",e)),void 0!==lt(t)[0]&&(e=Hc("fill",e))}super(t,void 0,e,qc),this.imageRendering=_n(n,"auto")}scale(t,{color:e,...n},r){return super.scale(t,n,r)}render(t,n,r,o,i){const a=n[r.channels.fill?.scale]??(t=>t),{x:l,y:s}=r,{document:c}=i,[u,f,h,d]=Xc(r,o,i),p=h-u,m=d-f,{pixelSize:y,width:g=Math.round(Math.abs(p)/y),height:v=Math.round(Math.abs(m)/y)}=this,x=g*v;let{fill:w,fillOpacity:b}=r,k=0;if(this.interpolate){const e=g/p,n=v/m,r=ht(l,(t=>(t-u)*e),Float64Array),o=ht(s,(t=>(t-f)*n),Float64Array);w&&(w=this.interpolate(t,g,v,r,o,w)),b&&(b=this.interpolate(t,g,v,r,o,b))}else null==this.data&&t&&(k=t.fi*x);const $=c.createElement("canvas");$.width=g,$.height=v;const M=$.getContext("2d"),L=M.createImageData(g,v),A=L.data;let{r:S,g:z,b:O}=e.rgb(this.fill)??{r:0,g:0,b:0},E=255*(this.fillOpacity??1);for(let t=0;t<x;++t){const n=t<<2;if(w){const r=a(w[t+k]);if(null==r){A[n+3]=0;continue}({r:S,g:z,b:O}=e.rgb(r))}b&&(E=255*b[t+k]),A[n+0]=S,A[n+1]=z,A[n+2]=O,A[n+3]=E}return this.blur>0&&e.blurImage(L,this.blur),M.putImageData(L,0,0),Qn("svg:g",i).call(jn,this,o,i).call(Yn,this,n).call((t=>t.append("image").attr("transform",`translate(${u},${f}) scale(${Math.sign(h-u)},${Math.sign(d-f)})`).attr("width",Math.abs(p)).attr("height",Math.abs(m)).attr("preserveAspectRatio","none").call(Dn,"image-rendering",this.imageRendering).call(qn,this).attr("xlink:href",$.toDataURL()))).node()}}function Gc(t,e,n){arguments.length<3&&(n=e,e=null);let{x:r,y:o,[t]:i,...a}=n;return void 0===r&&void 0===o&&function(t){if(!qt(t))return!1;for(const e of t)if(null!=e)return"object"==typeof e&&"0"in e&&"1"in e}(e)&&(r=Q,o=J,void 0===i&&(i=K)),[e,{...a,x:r,y:o,[t]:i}]}function Xc({x1:t,y1:e,x2:n,y2:r},o,{projection:i}){const{width:a,height:l,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}=o;return[t&&null==i?t[0]:f,e&&null==i?e[0]:s,n&&null==i?n[0]:a-c,r&&null==i?r[0]:l-u]}function Uc({x1:t,y1:e,x2:n,y2:r},o,i,a){const l={};return t&&(l.x1=t),e&&(l.y1=e),n&&(l.x2=n),r&&(l.y2=r),Xc(cn(l,o),i,a)}function Hc(t,e={}){const{[t]:n}=e;if("function"!=typeof n)throw new Error(`invalid ${t}: not a function`);return xe({...e,[t]:void 0},(function(r,o,i,a,l,s){const{x:c,y:u}=a;if(!c)throw new Error("missing scale: x");if(!u)throw new Error("missing scale: y");const[f,h,d,p]=Uc(i,a,l,s),m=d-f,y=p-h,{pixelSize:g}=this,{width:v=Math.round(Math.abs(m)/g),height:x=Math.round(Math.abs(y)/g)}=e,w=new Array(v*x*(o?o.length:1)),b=m/v,k=y/x;let $=0;for(const t of o??[void 0])for(let e=.5;e<x;++e)for(let r=.5;r<v;++r,++$)w[$]=n(c.invert(f+r*b),u.invert(h+e*k),t);return{data:w,facets:o,channels:{[t]:{value:w,scale:"auto"}}}}))}function Vc(t,e,n,r,o,i){const a=new Array(e*n);for(const l of t)r[l]<0||r[l]>=e||o[l]<0||o[l]>=n||(a[Math.floor(o[l])*e+Math.floor(r[l])]=i[l]);return a}function Zc({random:t=e.randomLcg(42)}={}){return(n,r,o,i,a,l)=>{const{points:s,triangles:c,hull:u}=e.Delaunay.from(n,(t=>i[t]),(t=>a[t])),f=new l.constructor(r*o).fill(NaN),h=new Uint8Array(r*o),d=function(t,e){return Xt(t)||Yt(t)?eu:function(t){return(e,n,r,o,i,a,l,s)=>{const c=t(l,s);return c<n?e:c<n+o?r:i}}(e)}(l,t);for(let t=0;t<c.length;t+=3){const e=c[t],i=c[t+1],a=c[t+2],u=s[2*e],p=s[2*i],m=s[2*a],y=s[2*e+1],g=s[2*i+1],v=s[2*a+1],x=Math.min(u,p,m),w=Math.max(u,p,m),b=Math.min(y,g,v),k=Math.max(y,g,v),$=(g-v)*(u-m)+(y-v)*(m-p);if(!$)continue;const M=l[n[e]],L=l[n[i]],A=l[n[a]];for(let t=Math.floor(x);t<w;++t)for(let e=Math.floor(b);e<k;++e){if(t<0||t>=r||e<0||e>=o)continue;const n=t+.5,i=e+.5,a=((g-v)*(n-m)+(i-v)*(m-p))/$;if(a<0)continue;const l=((v-y)*(n-m)+(i-v)*(u-m))/$;if(l<0)continue;const s=1-a-l;if(s<0)continue;const c=t+r*e;f[c]=d(M,a,L,l,A,s,t,e),h[c]=1}}return function(t,e,n,r,o,i,a,l,s,c){n=Float64Array.from(l,(t=>n[s[t]])),r=Float64Array.from(l,(t=>r[s[t]])),o=Array.from(l,(t=>o[s[t]]));const u=n.length,f=Array.from({length:u},((t,e)=>function(t,e,n){const r=e.length,o=e.at(t-2),i=n.at(t-2),a=e.at(t-1),l=n.at(t-1),s=e[t],c=n[t],u=e.at(t+1-r),f=n.at(t+1-r),h=a-s,d=l-c,p=o-a,m=i-l,y=s-u,g=c-f,v=Math.hypot(h,d),x=Math.hypot(p,m),w=Math.hypot(y,g);return(t,e)=>{const n=t-a,r=e-l,o=t-s,i=e-c;return Jc(n,r,o,i)>-1e-6&&Jc(n,r,h,d)*x-Jc(n,r,p,m)*v>-1e-6&&Jc(o,i,y,g)*v-Jc(o,i,h,d)*w<=0}}(e,n,r)));let h=0;for(let l=0;l<a;++l){const a=l+.5;for(let s=0;s<i;++s){const d=s+i*l;if(!e[d]){const e=s+.5;for(let i=0;i<u;++i){const p=(u+h+(i%2?(i+1)/2:-i/2))%u;if(f[p](e,a)){const i=Qc(n.at(p-1),r.at(p-1),n[p],r[p],e,a);t[d]=c(o.at(p-1),i,o[p],1-i,o[p],0,s,l),h=p;break}}}}}}(f,h,i,a,l,r,o,u,n,d),f}}function Qc(t,e,n,r,o,i){const a=n-t,l=r-e,s=a*(n-o)+l*(r-i),c=a*(o-t)+l*(i-e);return s>0&&c>0?s/(s+c):+(s>c)}function Jc(t,e,n,r){return t*r-n*e}function Kc(t,n,r,o,i,a){const l=new a.constructor(n*r),s=e.Delaunay.from(t,(t=>o[t]),(t=>i[t]));let c,u;for(let e=.5,o=0;e<r;++e){u=c;for(let r=.5;r<n;++r,++o)u=s.find(r,e,u),.5===r&&(c=u),l[o]=a[t[u]]}return l}function tu({random:t=e.randomLcg(42),minDistance:n=.5,maxSteps:r=2}={}){return(o,i,a,l,s,c)=>{const u=new c.constructor(i*a),f=e.Delaunay.from(o,(t=>l[t]),(t=>s[t]));let h,d,p;for(let e=.5,m=0;e<a;++e){d=h;for(let a=.5;a<i;++a,++m){let i,y=a,g=e;p=d=f.find(y,g,d),.5===a&&(h=d);let v=0;for(;(i=Math.hypot(l[o[p]]-y,s[o[p]]-g))>n&&v<r;){const n=2*t(a,e,v)*Math.PI;y+=Math.cos(n)*i,g+=Math.sin(n)*i,p=f.find(y,g,p),++v}u[m]=c[o[p]]}}return u}}function eu(t,e,n,r,o,i){return e*t+r*n+i*o}const nu={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};class ru extends Yc{constructor(t,{smooth:n=!0,value:r,...o}={}){const i=Rn({},o,nu);if(void 0===r)for(const t in i)if(null!=i[t].value){if(void 0!==r)throw new Error("ambiguous contour value");r=o[t],o[t]="value"}if(null!=r){const t={transform:t=>t.map((t=>t.value)),label:Ct(r)};for(const e in i)"value"===o[e]&&(o[e]=t)}if(null==t){if(null==r)throw new Error("missing contour value");o=Hc("value",{value:r,...o}),r=null}else{let{interpolate:t}=o;void 0===r&&(r=X),void 0===t&&(o.interpolate="nearest")}super(t,{value:{value:r,optional:!0}},function({thresholds:t,interval:n,...r}){return t=Pl(t,n,e.thresholdSturges),xe(r,(function(n,r,o,i,a,l){const[s,c,u,f]=Uc(o,i,a,l),h=u-s,d=f-c,{pixelSize:p,width:m=Math.round(Math.abs(h)/p),height:y=Math.round(Math.abs(d)/p)}=this,g=m/h,v=y/d,x=o.value.value,w=[];if(this.interpolate){const{x:t,y:e}=cr(o,i,l),n=ht(t,(t=>(t-s)*g),Float64Array),a=ht(e,(t=>(t-c)*v),Float64Array),u=[o.x,o.y,o.value],f=[n,a,x];for(const t of r){const e=this.filter(t,u,f);w.push(this.interpolate(e,m,y,n,a,x))}}else if(r){const t=m*y,e=r.length;for(let n=0;n<e;++n)w.push(x.slice(n*t,n*t+t))}else w.push(x);if(this.blur>0)for(const t of w)e.blur2({data:t,width:m,height:y},this.blur);const b=function(t,n,r,o){if("function"==typeof t?.range)return t.range(t.floor(r),o);"function"==typeof t&&(t=t(n,r,o));if("number"!=typeof t)return ft(t);const i=e.ticks(...e.nice(r,o,t),t);for(;i[i.length-1]>=o;)i.pop();for(;i[1]<r;)i.shift();return i}(t,x,...function(t){return[e.min(t,(t=>e.min(t,ou))),e.max(t,(t=>e.max(t,ou)))]}(w));if(null===b)throw new Error(`unsupported thresholds: ${t}`);const{contour:k}=e.contours().size([m,y]).smooth(this.smooth),$=[],M=[];for(const t of w)M.push(e.range($.length,$.push(...ht(b,(e=>k(t,e))))));for(const{coordinates:t}of $)for(const e of t)for(const t of e)for(const e of t)e[0]=e[0]/g+s,e[1]=e[1]/v+c;return{data:$,facets:M,channels:sn(this.contourChannels,$)}}))}(o),nu);const a={geometry:{value:X}};for(const t in this.channels){const e=this.channels[t],{scale:n}=e;"x"!==n&&"y"!==n&&"value"!==t&&(a[t]=e,delete this.channels[t])}this.contourChannels=a,this.smooth=!!n}filter(t,{x:e,y:n,value:r,...o},i){return super.filter(t,o,i)}render(t,n,r,o,i){const{geometry:a}=r,l=e.geoPath();return Qn("svg:g",i).call(jn,this,o,i).call(Yn,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(qn,this).attr("d",(t=>l(a[t]))).call(Bn,this,r)})).node()}}function ou(t){return isFinite(t)?t:NaN}function iu(t,e,n={}){const{x:r,y:o,maxRadius:i}=n,a=t({px:r,py:o,maxRadius:i}),l=[];null!=r&&l.push(bi(e,su("x",{...a,inset:-6},n))),null!=o&&l.push(ki(e,su("y",{...a,inset:-6},n))),null!=r&&l.push(Ei(e,cu("x",{...a,dy:9,frameAnchor:"bottom",lineAnchor:"top"},n))),null!=o&&l.push(Ei(e,cu("y",{...a,dx:-9,frameAnchor:"left",textAnchor:"end"},n)));for(const t of l)t.ariaLabel=`crosshair ${t.ariaLabel}`;return Io(...l)}function au(t,{channels:e,...n},{facet:r,facetAnchor:o,fx:i,fy:a,[t]:l,channels:s,transform:c,initializer:u}){return{...n,facet:r,facetAnchor:o,fx:i,fy:a,[t]:l,channels:{...e,...s},transform:c,initializer:lu(t,u)}}function lu(t,e){return null==e?e:function(n,r,{x:o,y:i,px:a,py:l,...s},...c){const{channels:{x:u,y:f,...h}={},...d}=e.call(this,n,r,{...s,x:a,y:l},...c);return{channels:{...h,...u&&{px:u,..."x"===t&&{x:u}},...f&&{py:f,..."y"===t&&{y:f}}},...d}}}function su(t,e,n){const{color:r="currentColor",opacity:o=.2,ruleStroke:i=r,ruleStrokeOpacity:a=o,ruleStrokeWidth:l}=n;return{...au(t,e,n),stroke:i,strokeOpacity:a,strokeWidth:l}}function cu(t,e,n){const{color:r="currentColor",textFill:o=r,textFillOpacity:i,textStroke:a="var(--plot-background)",textStrokeOpacity:l,textStrokeWidth:s=5}=n;return{...au(t,e,uu(t,n)),fill:o,fillOpacity:i,stroke:a,strokeOpacity:l,strokeWidth:s}}function uu(t,e){return xe(e,((e,n,r)=>({channels:{text:{value:vn(r,t)?.value}}})))}const fu={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},hu={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},du={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},pu={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},mu={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class yu extends No{constructor(t,e={}){const{x:n,y:r,z:o,curve:i,tension:a}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},e,fu),this.curve=Ml(i,a),Vo(this,e)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,{curve:f}=this,[h,d]=Vn(this,o),p=s?t=>s[t]:tt(h),m=c?t=>c[t]:tt(d),y=this;function g(t){let n=-1;const o=[],a={};for(const t in r)a[t]=[];const l=[],s=[],c=[],u=[];function h(e,i){e=t[e],i=t[i],o.push(++n),l[n]=p(e),c[n]=m(e),s[n]=p(i),u[n]=m(i);for(const t in r)a[t].push(r[t][i])}const{halfedges:d,hull:g,triangles:v}=e.Delaunay.from(t,p,m);for(let t=0;t<d.length;++t){const e=d[t];e>t&&h(v[t],v[e])}for(let t=0;t<g.length;++t)h(g[t],g[(t+1)%g.length]);e.select(this).selectAll().data(o).enter().append("path").call(qn,y).attr("d",(t=>{const n=e.pathRound(),r=f(n);return r.lineStart(),r.point(l[t],c[t]),r.point(s[t],u[t]),r.lineEnd(),n})).call(Bn,y,a).call(ri,y,a,i)}return Qn("svg:g",i).call(jn,this,o,i).call(Yn,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(g):e=>e.datum(t).each(g)).node()}}class gu extends No{constructor(t,e={},n,r=(({z:t})=>t)){const{x:o,y:i}=e;super(t,{x:{value:o,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:r(e),optional:!0}},e,n)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,[f,h]=Vn(this,o),d=s?t=>s[t]:tt(f),p=c?t=>c[t]:tt(h),m=this;function y(t){const n=e.Delaunay.from(t,d,p);e.select(this).append("path").datum(t[0]).call(qn,m).attr("d",m._render(n,o)).call(Bn,m,r)}return Qn("svg:g",i).call(jn,this,o,i).call(Yn,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(y):e=>e.datum(t).each(y)).node()}}class vu extends gu{constructor(t,e={}){super(t,e,hu),this.fill="none"}_render(t){return t.render()}}class xu extends gu{constructor(t,e={}){super(t,e,du,$t)}_render(t){return t.renderHull()}}class wu extends No{constructor(t,e={}){const{x:n,y:r,z:o}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},e,pu)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,[f,h]=Vn(this,o),d=s?t=>s[t]:tt(f),p=c?t=>c[t]:tt(h),m=this;function y(t){const n=ku(e.Delaunay.from(t,d,p),o);e.select(this).selectAll().data(t).enter().append("path").call(qn,m).attr("d",((t,e)=>n.renderCell(e))).call(Bn,m,r)}return Qn("svg:g",i).call(jn,this,o,i).call(Yn,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(y):e=>e.datum(t).each(y)).node()}}class bu extends gu{constructor(t,e){super(t,e,mu),this.fill="none"}_render(t,e){return ku(t,e).render()}}function ku(t,e){const{width:n,height:r,marginTop:o,marginRight:i,marginBottom:a,marginLeft:l}=e;return t.voronoi([l,o,n-i,r-a])}function $u(t,e,{x:n,y:r,...o}={}){return[n,r]=kt(n,r),new t(e,{...o,x:n,y:r})}const Mu={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Lu extends No{constructor(t,{x:n,y:r,z:o,weight:i,fill:a,stroke:l,...s}={}){const c=Su(a)&&(a="currentColor",!0),u=Su(l)&&(l="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:$t({z:o,fill:a,stroke:l}),optional:!0},weight:{value:i,optional:!0}},function(t,n,r){const o=100;let{bandwidth:i,thresholds:a}=t;return i=void 0===i?20:+i,a=void 0===a?20:"function"==typeof a?.[Symbol.iterator]?nt(a):+a,xe(t,(function(t,l,s,c,u,f){const h=s.weight?nt(s.weight.value):null,d=s.z?.value,{z:p}=this,[m,y]=Vn(this,u),{width:g,height:v}=u,{x:x,y:w}=cr(s,c,f),b=Object.fromEntries(Object.entries(s).filter((([t])=>!Au.has(t))).map((([t,e])=>[t,{...e,value:[]}]))),k=n&&[],$=r&&[],M=e.contourDensity().x(x?t=>x[t]:m).y(w?t=>w[t]:y).weight(h?t=>h[t]:1).size([g,v]).bandwidth(i),L=[];for(const t of l){const e=[];L.push(e);for(const n of d?In(t,d,p):[t]){const t=M.contours(n);e.push([n,t])}}let A=a;if(!(A instanceof P)){let t=0;for(const e of L)for(const[,n]of e){const e=n.max;e>t&&(t=e)}A=Float64Array.from({length:a-1},((e,n)=>t*o*(n+1)/a))}const S=[],z=[];for(const t of L){const e=[];S.push(e);for(const[n,r]of t)for(const t of A){e.push(z.length),z.push(r(t/o)),k&&k.push(t),$&&$.push(t);for(const t in b)b[t].value.push(s[t].value[n[0]])}}return k&&k.push(0),$&&$.push(0),{data:t,facets:S,channels:{...b,...k&&{fill:{value:k,scale:"color"}},...$&&{stroke:{value:$,scale:"color"}},contours:{value:z}}}}))}({...s,fill:a,stroke:l},c,u),Mu),c&&(this.fill=void 0),u&&(this.stroke=void 0),this.z=o}filter(t){return t}render(t,n,r,o,i){const{contours:a}=r,l=e.geoPath();return Qn("svg:g",i).call(jn,this,o,i).call(Yn,this,{}).call((e=>e.selectAll().data(t).enter().append("path").call(qn,this).call(Bn,this,r).attr("d",(t=>l(a[t]))))).node()}}const Au=new Set(["x","y","z","weight"]);function Su(t){return/^density$/i.test(t)}function zu(t,e,n){return void 0===e&&void 0===n?e=n=Ou(t):void 0===e?(n=Ou(n),e=void 0===t?n:Ou(t)):void 0===n?(e=Ou(e),n=void 0===t?e:Ou(t)):(e=Ou(e),n=Ou(n)),[e,n]}function Ou(t){let e;const{value:n,label:r=Ct(n)}=jt(t);return{transform:t=>e||(e=q(t,n)),label:r}}function Eu(t){return(e,n,r,o,i,a)=>{const{x1:l,x2:s}=r,{height:c}=o,u=new Float32Array(l.length),f=new Float32Array(s.length);(t===to(n.y)<0?u:f).fill(c);const h=a(e,n,{...r,x2:l,y2:f},o,i),d=a(e,n,{...r,x1:s,y1:u},o,i),p=h.querySelector("g")??h,m=d.querySelector("g")??d;for(let t=0;p.firstChild;t+=2){const e=En(),n=Qn("svg:clipPath",i).attr("id",e).node();n.appendChild(p.firstChild),m.childNodes[t].setAttribute("clip-path",`url(#${e})`),m.insertBefore(n,m.childNodes[t])}return d}}const Ru={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Cu extends No{constructor(t,e={}){const[n,r]=st(e.r,3);super(t,{geometry:{value:e.geometry,scale:"projection"},r:{value:n,scale:"r",filter:l,optional:!0}},qs(e),Ru),this.r=r}render(t,n,r,o,i){const{geometry:a,r:l}=r,c=e.geoPath(i.projection??function({x:t,y:n}){if(t||n)return t??=t=>t,n??=t=>t,e.geoTransform({point(e,r){this.stream.point(t(e),n(r))}})}(n)),{r:u}=this;return s(u)?t=[]:void 0!==u&&c.pointRadius(u),Qn("svg:g",i).call(jn,this,o,i).call(Yn,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(qn,this).attr("d",l?t=>c.pointRadius(l[t])(a[t]):t=>c(a[t])).call(Bn,this,r)})).node()}}function Tu(t,{geometry:e=X,...n}={}){switch(t?.type){case"FeatureCollection":t=t.features;break;case"GeometryCollection":t=t.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":t=[t]}return new Cu(t,{geometry:e,...n})}const Bu=.5,Nu=0;function Iu(t,e,n,r,o){const i=o*(1.5/fe),a=new Map;for(const l of e){let e=n[l],s=r[l];if(isNaN(e)||isNaN(s))continue;let c=Math.round(s=(s-Nu)/i),u=Math.round(e=(e-Bu)/o-(1&c)/2),f=s-c;if(3*Math.abs(f)>1){let t=e-u,n=u+(e<u?-1:1)/2,r=c+(s<c?-1:1),o=e-n,i=s-r;t*t+f*f>o*o+i*i&&(u=n+(1&c?1:-1)/2,c=r)}const h=`${u},${c}`;let d=a.get(h);void 0===d&&(d={index:[],extent:{data:t,x:(u+(1&c)/2)*o+Bu,y:c*i+Nu}},a.set(h,d)),d.index.push(l)}return a.values()}const Pu={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};class Wu extends No{constructor({binWidth:t=20,clip:e=!0,...n}={}){super(Y,void 0,{clip:e,...n},Pu),this.binWidth=Z(t)}render(t,e,n,r,o){const{binWidth:i}=this,{marginTop:a,marginRight:l,marginBottom:s,marginLeft:c,width:u,height:f}=r,h=c-Bu,d=u-l-Bu,p=a-Nu,m=f-s-Nu,y=i/2,g=y*he,v=g/2,x=2*y,w=1.5*g,b=Math.floor(h/x),k=Math.ceil(d/x),$=Math.floor((p+v)/w),M=Math.ceil((m-v)/w)+1,L=`m0,${ju(-g)}l${ju(y)},${ju(v)}v${ju(g)}l${ju(-y)},${ju(v)}`;let A=L;for(let t=$;t<M;++t)for(let e=b;e<k;++e)A+=`M${ju(e*x+(1&t)*y)},${ju(t*w)}${L}`;return Qn("svg:g",o).datum(0).call(jn,this,r,o).call(Yn,this,{},zn+Bu,zn+Nu).call((t=>t.append("path").call(qn,this).call(Bn,this,n).attr("d",A))).node()}}function ju(t){return Math.round(1e3*t)/1e3}const qu={ariaLabel:"image",fill:null,stroke:null};class Fu extends No{constructor(t,e={}){let{x:n,y:r,r:o,width:i,height:a,rotate:s,src:c,preserveAspectRatio:u,crossOrigin:f,frameAnchor:h,imageRendering:d}=e;null==o&&(o=void 0),void 0===o&&void 0===i&&void 0===a?i=a=16:void 0===i&&void 0!==a?i=a:void 0===a&&void 0!==i&&(a=i);const[p,m]="string"==typeof(y=c)&&(function(t){return/^\.*\//.test(t)}(y)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(y))?[void 0,y]:[y,void 0];var y;const[g,v]=st(o),[x,w]=st(i,void 0!==v?2*v:void 0),[b,k]=st(a,void 0!==v?2*v:void 0),[$,M]=st(s,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},r:{value:g,scale:"r",filter:l,optional:!0},width:{value:x,filter:l,optional:!0},height:{value:b,filter:l,optional:!0},rotate:{value:$,optional:!0},src:{value:p,optional:!0}},qs(e),qu),this.src=m,this.width=w,this.rotate=M,this.height=k,this.r=v,this.preserveAspectRatio=_n(u,"xMidYMid"),this.crossOrigin=V(f),this.frameAnchor=te(h),this.imageRendering=_n(d,"auto")}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y:s,width:c,height:u,r:f,rotate:h,src:d}=n,{r:p,width:m,height:y,rotate:g}=this,[v,x]=Vn(this,r);return Qn("svg:g",o).call(jn,this,r,o).call(Yn,this,{x:l&&i,y:s&&a}).call((e=>e.selectAll().data(t).enter().append("image").call(qn,this).attr("x",Du(l,c,f,v,m,p)).attr("y",Du(s,u,f,x,y,p)).attr("width",c?t=>c[t]:void 0!==m?m:f?t=>2*f[t]:2*p).attr("height",u?t=>u[t]:void 0!==y?y:f?t=>2*f[t]:2*p).attr("transform",h?t=>`rotate(${h[t]})`:g?`rotate(${g})`:null).attr("transform-origin",h||g?Mi`${l?t=>l[t]:v}px ${s?t=>s[t]:x}px`:null).call(Dn,"href",d?t=>d[t]:this.src).call(Dn,"preserveAspectRatio",this.preserveAspectRatio).call(Dn,"crossorigin",this.crossOrigin).call(Dn,"image-rendering",this.imageRendering).call(Dn,"clip-path",f?t=>`circle(${f[t]}px)`:void 0!==p?`circle(${p}px)`:null).call(Bn,this,n))).node()}}function Du(t,e,n,r,o,i){return e&&t?n=>t[n]-e[n]/2:e?t=>r-e[t]/2:t&&void 0!==o?e=>t[e]-o/2:void 0!==o?r-o/2:n&&t?e=>t[e]-n[e]:n?t=>r-n[t]:t?e=>t[e]-i:r-i}function Yu(t,e,n){var r=0===t||1===t?0:Math.exp(Gu(e+n)-Gu(e)-Gu(n)+e*Math.log(t)+n*Math.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+n+2)?r*_u(t,e,n)/e:1-r*_u(1-t,n,e)/n)}function _u(t,e,n){var r,o,i,a,l=1e-30,s=1,c=e+n,u=e+1,f=e-1,h=1,d=1-c*t/u;for(Math.abs(d)<l&&(d=l),a=d=1/d;s<=100&&(d=1+(o=s*(n-s)*t/((f+(r=2*s))*(e+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=(d=1/d)*h,d=1+(o=-(e+s)*(c+s)*t/((e+r)*(u+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=i=(d=1/d)*h,!(Math.abs(i-1)<3e-7));s++);return a}function Gu(t){var e,n,r,o=0,i=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=e=t)+5.5,r-=(e+.5)*Math.log(r);o<6;o++)a+=i[o]/++n;return Math.log(2.506628274631*a/e)-r}function Xu(t,e){var n=function(t,e,n){var r,o,i,a,l,s,c,u,f,h,d=e-1,p=n-1,m=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&n>=1?(i=t<.5?t:1-t,s=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(i))))/(1+a*(.99229+.04481*a))-a,t<.5&&(s=-s),c=(s*s-3)/6,u=2/(1/(2*e-1)+1/(2*n-1)),f=s*Math.sqrt(c+u)/u-(1/(2*n-1)-1/(2*e-1))*(c+5/6-2/(3*u)),s=e/(e+n*Math.exp(2*f))):(r=Math.log(e/(e+n)),o=Math.log(n/(e+n)),s=t<(a=Math.exp(e*r)/e)/(f=a+(l=Math.exp(n*o)/n))?Math.pow(e*f*t,1/e):1-Math.pow(n*f*(1-t),1/n)),h=-Gu(e)-Gu(n)+Gu(e+n);m<10;m++){if(0===s||1===s)return s;if((s-=a=(l=(Yu(s,e,n)-t)/(a=Math.exp(d*Math.log(s)+p*Math.log(1-s)+h)))/(1-.5*Math.min(1,l*(d/s-p/(1-s)))))<=0&&(s=.5*(s+a)),s>=1&&(s=.5*(s+a+1)),Math.abs(a)<1e-8*s&&m>0)break}return s}(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}const Uu={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Hu extends No{constructor(t,e={}){const{x:n,y:r,z:o,ci:i=.95,precision:a=4}=e;if(super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:$t(e),optional:!0}},e,Uu),this.z=o,this.ci=+i,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${i}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,e,n,r,o){const{x:i,y:a,z:l}=n,{ci:s}=this;return Qn("svg:g",o).call(jn,this,r,o).call(Yn,this,e).call((e=>e.selectAll().data(l?In(t,l,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(qn,this).call(Nn,this,{...n,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,i,a))).call(s&&!Jt(this.fill)?t=>t.select(Vu).attr("stroke","none").call(qn,this).call(Nn,this,{...n,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,i,a))):()=>{}))))).node()}}function Vu(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(e.namespaces.svg,"path"),this)}class Zu extends Hu{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:o,precision:i}=this,[a,l]=e.extent(t,(t=>r[t])),s=Ju(t,r,n),c=Ku(t,r,n,(1-o)/2,s);return e.area().y((t=>t)).x0((t=>c(t,-1))).x1((t=>c(t,1)))(e.range(a,l-i/2,i).concat(l))}_renderLine(t,n,r){const[o,i]=e.extent(t,(t=>r[t])),a=Ju(t,r,n);return`M${a(o)},${o}L${a(i)},${i}`}}class Qu extends Hu{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:o,precision:i}=this,[a,l]=e.extent(t,(t=>n[t])),s=Ju(t,n,r),c=Ku(t,n,r,(1-o)/2,s);return e.area().x((t=>t)).y0((t=>c(t,-1))).y1((t=>c(t,1)))(e.range(a,l-i/2,i).concat(l))}_renderLine(t,n,r){const[o,i]=e.extent(t,(t=>n[t])),a=Ju(t,n,r);return`M${o},${a(o)}L${i},${a(i)}`}}function Ju(t,e,n){let r=0,o=0,i=0,a=0;for(const l of t){const t=e[l],s=n[l];r+=t,o+=s,i+=t*s,a+=t*t}const l=t.length,s=(l*i-r*o)/(l*a-r*r),c=(o-s*r)/l;return t=>s*t+c}function Ku(t,n,r,o,i){const a=e.sum(t,(t=>n[t]))/t.length;let l=0,s=0;for(const e of t)l+=(n[e]-a)**2,s+=(r[e]-i(n[e]))**2;const c=Math.sqrt(s/(t.length-2)),u=Xu(o,t.length-2);return(e,n)=>{const r=i(e),o=c*Math.sqrt(1/t.length+(e-a)**2/l);return r+n*u*o}}function tf({path:t=X,delimiter:n,frameAnchor:r,treeLayout:o=e.tree,treeSort:i,treeSeparation:a,treeAnchor:l,treeFilter:s,...c}={}){l=nf(l),i=af(i),null!=s&&(s=hf(s)),void 0===r&&(r=l.frameAnchor);const u=sf(n),f=Lf(c,hf),[h,d]=Et(),[p,m]=Et();return{x:h,y:p,frameAnchor:r,...ve(c,((n,r)=>{const c=u(q(n,t)),h=d([]),p=m([]);let y=-1;const g=[],v=[],x=e.stratify().path((t=>c[t])),w=o();w.nodeSize&&w.nodeSize([1,1]),w.separation&&void 0!==a&&w.separation(a??U);for(const t of f)t[Mf]=t[kf]([]);for(const t of r){const e=[],r=x(t.filter((t=>null!=c[t]))).each((t=>t.data=n[t.data]));null!=i&&r.sort(i),w(r);for(const t of r.descendants())if(null==s||s(t)){e.push(++y),g[y]=t.data,l.position(t,y,h,p);for(const e of f)e[Mf][y]=e[$f](t)}v.push(e)}return{data:g,facets:v}})),...Object.fromEntries(f)}}function ef({path:t=X,delimiter:n,curve:r="bump-x",stroke:o="#555",strokeWidth:i=1.5,strokeOpacity:a=.5,treeLayout:l=e.tree,treeSort:s,treeSeparation:c,treeAnchor:u,treeFilter:f,...h}={}){u=nf(u),s=af(s),null!=f&&(f=df(f)),h={curve:r,stroke:o,strokeWidth:i,strokeOpacity:a,...h};const d=sf(n),p=Lf(h,df),[m,y]=Et(),[g,v]=Et(),[x,w]=Et(),[b,k]=Et();return{x1:m,x2:g,y1:x,y2:b,...ve(h,((n,r)=>{const o=d(q(n,t)),i=y([]),a=v([]),h=w([]),m=k([]);let g=-1;const x=[],b=[],$=e.stratify().path((t=>o[t])),M=l();M.nodeSize&&M.nodeSize([1,1]),M.separation&&void 0!==c&&M.separation(c??U);for(const t of p)t[Mf]=t[kf]([]);for(const t of r){const e=[],r=$(t.filter((t=>null!=o[t]))).each((t=>t.data=n[t.data]));null!=s&&r.sort(s),M(r);for(const{source:t,target:n}of r.links())if(null==f||f(n,t)){e.push(++g),x[g]=n.data,u.position(t,g,i,h),u.position(n,g,a,m);for(const e of p)e[Mf][g]=e[$f](n,t)}b.push(e)}return{data:x,facets:b}})),...Object.fromEntries(p)}}function nf(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return rf;case"right":return of}throw new Error(`invalid tree anchor: ${t}`)}const rf={frameAnchor:"left",dx:6,position({x:t,y:e},n,r,o){r[n]=e,o[n]=-t}},of={frameAnchor:"right",dx:-6,position({x:t,y:e},n,r,o){r[n]=-e,o[n]=-t}};function af(t){return null==t||"function"==typeof t?t:`${t}`.trim().toLowerCase().startsWith("node:")?lf(hf(t)):lf(function(t){return e=>e.data?.[t]}(t))}function lf(t){return(e,n)=>r(t(e),t(n))}function sf(t="/"){if("/"===(t=`${t}`))return t=>t;if(1!==t.length)throw new Error("delimiter must be exactly one character");const e=t.charCodeAt(0);return t=>t.map((t=>function(t,e){if(e===cf)throw new Error("delimiter cannot be backslash");let n=!1;for(let r=0,o=t.length;r<o;++r){switch(t.charCodeAt(r)){case cf:if(!n){n=!0;continue}break;case e:n?(t=t.slice(0,r-1)+t.slice(r),--r,--o):t=t.slice(0,r)+"/"+t.slice(r+1);break;case uf:n?(t=t.slice(0,r)+"\\\\"+t.slice(r),r+=2,o+=2):(t=t.slice(0,r)+"\\"+t.slice(r),++r,++o)}n=!1}return t}(t,e)))}const cf=92,uf=47;function ff(t){return gt(t)&&"function"==typeof t.node}function hf(t){if(ff(t))return t.node;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return mf;case"node:path":return pf;case"node:internal":return vf;case"node:external":return xf;case"node:depth":return yf;case"node:height":return gf}throw new Error(`invalid node value: ${t}`)}}function df(t){if(ff(t))return t.node;if(gt(e=t)&&"function"==typeof e.link)return t.link;var e;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return wf(mf);case"parent:path":return wf(pf);case"parent:depth":return wf(yf);case"parent:height":return wf(gf);case"node:name":return mf;case"node:path":return pf;case"node:internal":return vf;case"node:external":return xf;case"node:depth":return yf;case"node:height":return gf}throw new Error(`invalid link value: ${t}`)}}function pf(t){return t.id}function mf(t){return function(t){let e=t.length;for(;--e>0&&!bf(t,e););return function(t){let e=!1;for(let n=0,r=t.length;n<r;++n){switch(t.charCodeAt(n)){case cf:if(!e){e=!0;continue}case uf:e&&(t=t.slice(0,n-1)+t.slice(n),--n,--r)}e=!1}return t}(t.slice(e+1))}(t.id)}function yf(t){return t.depth}function gf(t){return t.height}function vf(t){return!!t.children}function xf(t){return!t.children}function wf(t){return(e,n)=>null==n?void 0:t(n)}function bf(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}const kf=2,$f=3,Mf=4;function Lf(t,e){const n=[];for(const r in t){const o=t[r],i=e(o);void 0!==i&&n.push([r,...Et(o),i])}return n}function Af(t,{fill:n,stroke:r,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:l,strokeMiterlimit:s,strokeDasharray:c,strokeDashoffset:u,marker:f,markerStart:h=f,markerEnd:d=f,dot:p=Qt(h)&&Qt(d),text:m="node:name",textStroke:y="var(--plot-background)",title:g="node:path",dx:v,dy:x,textAnchor:w,treeLayout:b=e.tree,textLayout:k=(b===e.tree||b===e.cluster?"mirrored":"normal"),tip:$,...M}={}){if(void 0===v&&(v=nf(M.treeAnchor).dx),void 0!==w)throw new Error("textAnchor is not a configurable tree option");function L(e){return Ei(t,tf({treeLayout:b,text:m,fill:void 0===n?"currentColor":n,stroke:y,dx:v,dy:x,title:g,...e,...M}))}return k=ut(k,"textLayout",["mirrored","normal"]),Io(Ls(t,ef({treeLayout:b,markerStart:h,markerEnd:d,stroke:void 0!==r?r:void 0===n?"node:internal":n,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:l,strokeMiterlimit:s,strokeDasharray:c,strokeDashoffset:u,...M})),p?Ds(t,tf({treeLayout:b,fill:void 0===n?"node:internal":n,title:g,tip:$,...M})):null,null!=m?"mirrored"===k?[L({textAnchor:"start",treeFilter:"node:external"}),L({textAnchor:"end",treeFilter:"node:internal",dx:-v})]:L():null)}function Sf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function zf(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)>=0?(i=a,o=a-1):r=a+1}return i}function Of(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)>0?(i=a,o=a-1):r=a+1}return i}function Ef(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)<0?(i=a,r=a+1):o=a-1}return i}function Rf(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)<=0?(i=a,r=a+1):o=a-1}return i}function Cf(t,e,n,r,o){for(;r<=o;){var i=r+o>>>1,a=t[i],l=void 0!==n?n(a,e):a-e;if(0===l)return i;l<=0?r=i+1:o=i-1}return-1}function Tf(t,e,n,r,o,i){return"function"==typeof n?i(t,e,n,void 0===r?0:0|r,void 0===o?t.length-1:0|o):i(t,e,void 0,void 0===n?0:0|n,void 0===r?t.length-1:0|r)}var Bf={ge:function(t,e,n,r,o){return Tf(t,e,n,r,o,zf)},gt:function(t,e,n,r,o){return Tf(t,e,n,r,o,Of)},lt:function(t,e,n,r,o){return Tf(t,e,n,r,o,Ef)},le:function(t,e,n,r,o){return Tf(t,e,n,r,o,Rf)},eq:function(t,e,n,r,o){return Tf(t,e,n,r,o,Cf)}},Nf=function(t){if(!t||0===t.length)return new Vf(null);return new Vf(Hf(t))};function If(t,e,n,r,o){this.mid=t,this.left=e,this.right=n,this.leftPoints=r,this.rightPoints=o,this.count=(e?e.count:0)+(n?n.count:0)+r.length}var Pf=If.prototype;function Wf(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function jf(t,e){var n=Hf(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function qf(t,e){var n=t.intervals([]);n.push(e),jf(t,n)}function Ff(t,e){var n=t.intervals([]),r=n.indexOf(e);return r<0?0:(n.splice(r,1),jf(t,n),1)}function Df(t,e,n){for(var r=0;r<t.length&&t[r][0]<=e;++r){var o=n(t[r]);if(o)return o}}function Yf(t,e,n){for(var r=t.length-1;r>=0&&t[r][1]>=e;--r){var o=n(t[r]);if(o)return o}}function _f(t,e){for(var n=0;n<t.length;++n){var r=e(t[n]);if(r)return r}}function Gf(t,e){return t-e}function Xf(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function Uf(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function Hf(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(Gf);var r=e[e.length>>1],o=[],i=[],a=[];for(n=0;n<t.length;++n){var l=t[n];l[1]<r?o.push(l):r<l[0]?i.push(l):a.push(l)}var s=a,c=a.slice();return s.sort(Xf),c.sort(Uf),new If(r,Hf(o),Hf(i),s,c)}function Vf(t){this.root=t}Pf.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},Pf.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?qf(this,t):this.left.insert(t):this.left=Hf([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?qf(this,t):this.right.insert(t):this.right=Hf([t]);else{var n=Bf.ge(this.leftPoints,t,Xf),r=Bf.ge(this.rightPoints,t,Uf);this.leftPoints.splice(n,0,t),this.rightPoints.splice(r,0,t)}},Pf.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?Ff(this,t):2===(i=this.left.remove(t))?(this.left=null,this.count-=1,1):(1===i&&(this.count-=1),i):0;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?Ff(this,t):2===(i=this.right.remove(t))?(this.right=null,this.count-=1,1):(1===i&&(this.count-=1),i):0;if(1===this.count)return this.leftPoints[0]===t?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,r=this.left;r.right;)n=r,r=r.right;if(n===this)r.right=this.right;else{var o=this.left,i=this.right;n.count-=r.count,n.right=r.left,r.left=o,r.right=i}Wf(this,r),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?Wf(this,this.left):Wf(this,this.right);return 1}for(o=Bf.ge(this.leftPoints,t,Xf);o<this.leftPoints.length&&this.leftPoints[o][0]===t[0];++o)if(this.leftPoints[o]===t){this.count-=1,this.leftPoints.splice(o,1);for(i=Bf.ge(this.rightPoints,t,Uf);i<this.rightPoints.length&&this.rightPoints[i][1]===t[1];++i)if(this.rightPoints[i]===t)return this.rightPoints.splice(i,1),1}return 0},Pf.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return Df(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return Yf(this.rightPoints,t,e)}return _f(this.leftPoints,e)},Pf.queryInterval=function(t,e,n){var r;if(t<this.mid&&this.left&&(r=this.left.queryInterval(t,e,n)))return r;if(e>this.mid&&this.right&&(r=this.right.queryInterval(t,e,n)))return r;return e<this.mid?Df(this.leftPoints,e,n):t>this.mid?Yf(this.rightPoints,t,n):_f(this.leftPoints,n)};var Zf=Vf.prototype;Zf.insert=function(t){this.root?this.root.insert(t):this.root=new If(t[0],null,null,[t],[t])},Zf.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),0!==e}return!1},Zf.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},Zf.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(Zf,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(Zf,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});var Qf=Sf(Nf);const Jf=({marginLeft:t})=>[1,t],Kf=({width:t,marginRight:e})=>[-1,t-e],th=({width:t,marginLeft:e,marginRight:n})=>[0,(e+t-n)/2],eh=({marginTop:t})=>[1,t],nh=({height:t,marginBottom:e})=>[-1,t-e],rh=({height:t,marginTop:e,marginBottom:n})=>[0,(e+t-n)/2];function oh(t){return"string"==typeof t?{anchor:t}:t}function ih(t){const{anchor:e,padding:n,...r}=t,{r:o}=r;return[{anchor:e,padding:n,r:o},r]}function ah(t,e,n,r,o,i){if(null!=o&&"number"!=typeof o){let{channels:t,sort:e,reverse:n}=i;t=ne(t),void 0===t?.r&&(i={...i,channels:{...t,r:{value:o,scale:"r"}}}),void 0===e&&void 0===n&&(i.sort={channel:"-r"})}return xe(i,(function(i,s,c,u,f,h){let{[e]:d,r:p}=c;if(!c[e])throw new Error(`missing channel: ${e}`);({[e]:d}=cr(c,u,h));const m=p?void 0:void 0!==o?Z(o):void 0!==this.r?this.r:3;p&&(p=q(p.value,u[p.scale]||X,Float64Array));let[y,g]=n(f);const v=y?sh:lh,x=new Float64Array(d.length),w=p?t=>p[t]:()=>m;for(let t of s){const e=Qf();t=t.filter(p?t=>a(d[t])&&l(p[t]):t=>a(d[t]));const n=new Float64Array(2*t.length+2);for(const o of t){const t=w(o),i=y?t+r:0,a=d[o]-t,l=d[o]+t;let s=2;e.queryInterval(a-r,l+r,(([,,t])=>{const e=x[t]-i,a=d[o]-d[t],l=r+(p?p[o]+p[t]:2*m),c=Math.sqrt(l*l-a*a);n[s++]=e-c,n[s++]=e+c}));let c=n.slice(0,s);y&&(c=c.filter((t=>t>=0)));t:for(const t of c.sort(v)){for(let e=0;e<s;e+=2)if(n[e]+1e-6<t&&t<n[e+1]-1e-6)continue t;x[o]=t+i;break}e.insert([a,l,o])}}y||(y=1);for(const t of s)for(const e of t)x[e]=x[e]*y+g;return{data:i,facets:s,channels:{[t]:{value:x,source:null},[e]:{value:d,source:c[e]},...p&&{r:{value:p,source:c.r}}}}}))}function lh(t,e){return Math.abs(t)-Math.abs(e)}function sh(t,e){return t-e}function ch(t){if(void 0===t)return dh;if("function"==typeof t)return uh(At(t));if(/^p\d{2}$/i.test(t))return fh(et(t));switch(`${t}`.toLowerCase()){case"deviation":return mh;case"first":return dh;case"last":return ph;case"max":return yh;case"mean":return gh;case"median":return vh;case"min":return xh;case"sum":return wh;case"extent":return hh}throw new Error(`invalid basis: ${t}`)}function uh(t){return{mapIndex(e,n,r){const o=+t(e,n);for(const t of e)r[t]=null===n[t]?NaN:n[t]/o}}}function fh(t){return uh(((e,n)=>t(e,(t=>n[t]))))}const hh={mapIndex(t,n,r){const[o,i]=e.extent(t,(t=>n[t])),a=i-o;for(const e of t)r[e]=null===n[e]?NaN:(n[e]-o)/a}},dh=uh(((t,e)=>{for(let r=0;r<t.length;++r){const o=e[t[r]];if(n(o))return o}})),ph=uh(((t,e)=>{for(let r=t.length-1;r>=0;--r){const o=e[t[r]];if(n(o))return o}})),mh={mapIndex(t,n,r){const o=e.mean(t,(t=>n[t])),i=e.deviation(t,(t=>n[t]));for(const e of t)r[e]=null===n[e]?NaN:i?(n[e]-o)/i:0}},yh=fh(e.max),gh=fh(e.mean),vh=fh(e.median),xh=fh(e.min),wh=fh(e.sum);function bh(t){if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"min":return Ah;case"max":return Sh}throw new Error(`unknown selector: ${t}`)}function kh(t){return zh(null,Mh,t)}function $h(t){return zh(null,Lh,t)}function*Mh(t){yield t[0]}function*Lh(t){yield t[t.length-1]}function*Ah(t,n){yield e.least(t,(t=>n[t]))}function*Sh(t,n){yield e.greatest(t,(t=>n[t]))}function zh(t,n,r){if(null!=t){if(null==r[t])throw new Error(`missing channel: ${t}`);t=r[t]}const o=$t(r);return ve(r,((r,i)=>{const a=q(r,o),l=q(r,t),s=[];for(const t of i){const r=[];for(const o of a?e.group(t,(t=>a[t])).values():[t])for(const t of n(o,l))r.push(t);s.push(r)}return{data:r,facets:s}}))}t.Area=xs,t.Arrow=zs,t.BarX=Cs,t.BarY=Ts,t.Cell=Ps,t.Contour=ru,t.Density=Lu,t.Dot=Fs,t.Frame=Xa,t.Geo=Cu,t.Hexgrid=Wu,t.Image=Fu,t.Line=_s,t.Link=Ms,t.Mark=No,t.Raster=_c,t.Rect=Vs,t.RuleX=xi,t.RuleY=wi,t.Text=Si,t.TickX=Rc,t.TickY=Cc,t.Tip=Za,t.Vector=na,t.area=ws,t.areaX=bs,t.areaY=ks,t.arrow=function(t,{x:e,x1:n,x2:r,y:o,y1:i,y2:a,...l}={}){return[n,r]=As(e,n,r),[i,a]=As(o,i,a),new zs(t,{...l,x1:n,x2:r,y1:i,y2:a})},t.auto=function(t,e){const n=Ks(t,e),{fx:r,fy:o,x:{zero:i},y:{zero:a},markOptions:l,transformOptions:s,colorMode:c}=n,u=ac[n.markImpl],f=ac[n.transformImpl],h=null!=r||null!=o?Ua({strokeOpacity:.1}):null,d=[i?bi([0]):null,a?ki([0]):null],p=u(t,f?f(s,l):l);return"stroke"===c?Io(h,d,p):Io(h,p,d)},t.autoSpec=Ks,t.axisFx=ma,t.axisFy=da,t.axisX=pa,t.axisY=ha,t.barX=Bs,t.barY=Ns,t.bin=Ol,t.binX=Sl,t.binY=zl,t.bollinger=zc,t.bollingerX=function(t,{x:e=X,y:n,k:r=Sc.k,color:o=Sc.color,opacity:i=Sc.opacity,fill:a=o,fillOpacity:l=i,stroke:s=o,strokeOpacity:c,strokeWidth:u,...f}={}){return Io(Qt(a)?null:bs(t,uc({x1:zc({k:-r,...f}),x2:zc({k:r,...f})},{x1:e,x2:e,y:n,fill:a,fillOpacity:l,...f})),Qt(s)?null:Xs(t,uc({x:zc(f)},{x:e,y:n,stroke:s,strokeOpacity:c,strokeWidth:u,...f})))},t.bollingerY=function(t,{x:e,y:n=X,k:r=Sc.k,color:o=Sc.color,opacity:i=Sc.opacity,fill:a=o,fillOpacity:l=i,stroke:s=o,strokeOpacity:c,strokeWidth:u,...f}={}){return Io(Qt(a)?null:ks(t,uc({y1:zc({k:-r,...f}),y2:zc({k:r,...f})},{x:e,y1:n,y2:n,fill:a,fillOpacity:l,...f})),Qt(s)?null:Us(t,uc({y:zc(f)},{x:e,y:n,stroke:s,strokeOpacity:c,strokeWidth:u,...f})))},t.boxX=function(t,{x:e=X,y:n=null,fill:r="#ccc",fillOpacity:o,stroke:i="currentColor",strokeOpacity:a,strokeWidth:l=2,sort:s,...c}={}){const u=null!=n?Re:Oe;return Io(ki(t,u({x1:Ic,x2:Pc},{x:e,y:n,stroke:i,strokeOpacity:a,...c})),Bs(t,u({x1:"p25",x2:"p75"},{x:e,y:n,fill:r,fillOpacity:o,...c})),Tc(t,u({x:"p50"},{x:e,y:n,stroke:i,strokeOpacity:a,strokeWidth:l,sort:s,...c})),Ds(t,uc({x:Nc},{x:e,y:n,z:n,stroke:i,strokeOpacity:a,...c})))},t.boxY=function(t,{y:e=X,x:n=null,fill:r="#ccc",fillOpacity:o,stroke:i="currentColor",strokeOpacity:a,strokeWidth:l=2,sort:s,...c}={}){const u=null!=n?Ee:Oe;return Io(bi(t,u({y1:Ic,y2:Pc},{x:n,y:e,stroke:i,strokeOpacity:a,...c})),Ns(t,u({y1:"p25",y2:"p75"},{x:n,y:e,fill:r,fillOpacity:o,...c})),Bc(t,u({y:"p50"},{x:n,y:e,stroke:i,strokeOpacity:a,strokeWidth:l,sort:s,...c})),Ds(t,uc({y:Nc},{x:n,y:e,z:n,stroke:i,strokeOpacity:a,...c})))},t.cell=Ws,t.cellX=function(t,{x:e=G,fill:n,stroke:r,...o}={}){return void 0===n&&void 0===lt(r)[0]&&(n=X),new Ps(t,{...o,x:e,fill:n,stroke:r})},t.cellY=function(t,{y:e=G,fill:n,stroke:r,...o}={}){return void 0===n&&void 0===lt(r)[0]&&(n=X),new Ps(t,{...o,y:e,fill:n,stroke:r})},t.centroid=function({geometry:t=X,...n}={}){return xe({...n,x:null,y:null},((n,r,o,i,a,{projection:l})=>{const s=q(n,t),c=s.length,u=new Float64Array(c),f=new Float64Array(c),h=e.geoPath(l);for(let t=0;t<c;++t)[u[t],f[t]]=h.centroid(s[t]);return{data:n,facets:r,channels:{x:{value:u,scale:null==l?"x":null,source:null},y:{value:f,scale:null==l?"y":null,source:null}}}}))},t.circle=function(t,e){return Ds(t,{...e,symbol:"circle"})},t.cluster=function(t,n){return Af(t,{...n,treeLayout:e.cluster})},t.column=Et,t.contour=function(){return new ru(...Gc("value",...arguments))},t.crosshair=function(t,e){return iu(Do,t,e)},t.crosshairX=function(t,e={}){return iu(Yo,t,e)},t.crosshairY=function(t,e={}){return iu(_o,t,e)},t.delaunayLink=function(t,e){return $u(yu,t,e)},t.delaunayMesh=function(t,e){return $u(vu,t,e)},t.density=function(t,{x:e,y:n,...r}={}){return[e,n]=kt(e,n),new Lu(t,{...r,x:e,y:n})},t.differenceY=function(t,{x1:e,x2:n,y1:r,y2:o,x:i=(void 0===e&&void 0===n?G:void 0),y:a=(void 0===r&&void 0===o?X:void 0),fill:l,positiveFill:s="#3ca951",negativeFill:c="#4269d0",fillOpacity:u=1,positiveFillOpacity:f=u,negativeFillOpacity:h=u,stroke:d,strokeOpacity:p,z:m=lt(d)[0],clip:y,tip:g,render:v,...x}={}){return[e,n]=zu(i,e,n),[r,o]=zu(a,r,o),e===n&&r===o&&(r=Ou(0)),({tip:g}=jo({tip:g},"x")),Io(Qt(s)?null:Object.assign(ws(t,{x1:e,x2:n,y1:r,y2:o,z:m,fill:s,fillOpacity:f,render:Po(v,Eu(!0)),clip:y,...x}),{ariaLabel:"positive difference"}),Qt(c)?null:Object.assign(ws(t,{x1:e,x2:n,y1:r,y2:o,z:m,fill:c,fillOpacity:h,render:Po(v,Eu(!1)),clip:y,...x}),{ariaLabel:"negative difference"}),Gs(t,{x:n,y:o,z:m,stroke:d,strokeOpacity:p,tip:g,clip:!0,...x}))},t.dodgeX=function(t={},e={}){1===arguments.length&&([t,e]=ih(t));let{anchor:n="left",padding:r=1,r:o=e.r}=oh(t);switch(`${n}`.toLowerCase()){case"left":n=Jf;break;case"right":n=Kf;break;case"middle":n=th;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return ah("x","y",n,Z(r),o,e)},t.dodgeY=function(t={},e={}){1===arguments.length&&([t,e]=ih(t));let{anchor:n="bottom",padding:r=1,r:o=e.r}=oh(t);switch(`${n}`.toLowerCase()){case"top":n=eh;break;case"bottom":n=nh;break;case"middle":n=rh;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return ah("y","x",n,Z(r),o,e)},t.dot=Ds,t.dotX=function(t,{x:e=X,...n}={}){return new Fs(t,gi({...n,x:e}))},t.dotY=function(t,{y:e=X,...n}={}){return new Fs(t,yi({...n,y:e}))},t.filter=function(t,e){return ke(e,$e(t))},t.find=function(t){if("function"!=typeof t)throw new Error(`invalid test function: ${t}`);return{reduceIndex:(e,n,{data:r})=>n[e.find((e=>t(r[e],e,r)))]}},t.formatIsoDate=$n,t.formatMonth=function(t="en-US",e="short"){const n=bn(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2e3,+t)))?void 0:n.format(t)},t.formatWeekday=function(t="en-US",e="short"){const n=kn(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2001,0,+t)))?void 0:n.format(t)},t.frame=Ua,t.geo=Tu,t.geoCentroid=function({geometry:t=X,...n}={}){let r;return{...n,x:{transform:n=>Float64Array.from(r=q(q(n,t),e.geoCentroid),(([t])=>t))},y:{transform:()=>Float64Array.from(r,(([,t])=>t))}}},t.graticule=function({strokeOpacity:t=.1,...n}={}){return Tu(e.geoGraticule10(),{strokeOpacity:t,...n})},t.gridFx=ba,t.gridFy=xa,t.gridX=wa,t.gridY=va,t.group=Ce,t.groupX=Ee,t.groupY=Re,t.groupZ=Oe,t.hexagon=function(t,e){return Ds(t,{...e,symbol:"hexagon"})},t.hexbin=function(t={fill:"count"},{binWidth:e,...n}={}){const{z:r}=n;return e=void 0===e?20:Z(e),Be(t=Fe(t,n),"fill")&&(n.channels={...n.channels,fill:{value:[]}}),void 0===n.symbol&&(n.symbol="hexagon"),void 0!==n.r||Be(t,"r")||(n.r=e/2),xe(n,((n,o,i,a,l,s)=>{let{x:c,y:u,z:f,fill:h,stroke:d,symbol:p}=i;if(void 0===c)throw new Error("missing channel: x");if(void 0===u)throw new Error("missing channel: y");({x:c,y:u}=cr(i,a,s)),f=f?f.value:q(n,r),h=h?.value,d=d?.value,p=p?.value;const m=Xe(t,{z:f,fill:h,stroke:d,symbol:p}),y=f&&[],g=h&&[],v=d&&[],x=p&&[],w=[],b=[],k=[];let $=-1;for(const e of t)e.initialize(n);for(const r of o){const o=[];for(const e of t)e.scope("facet",r);for(const[i,a]of We(r,m))for(const{index:r,extent:l}of Iu(n,a,c,u,e)){o.push(++$),b.push(l.x),k.push(l.y),f&&y.push(m===f?i:f[r[0]]),h&&g.push(m===h?i:h[r[0]]),d&&v.push(m===d?i:d[r[0]]),p&&x.push(m===p?i:p[r[0]]);for(const e of t)e.reduce(r,l)}w.push(o)}const M=i.x.scale,L=i.y.scale;return{data:n,facets:w,channels:{x:{value:b,source:a[M]?{value:ht(b,a[M].invert),scale:M}:null},y:{value:k,source:a[L]?{value:ht(k,a[L].invert),scale:L}:null},...f&&{z:{value:y}},...h&&{fill:{value:g,scale:"auto"}},...d&&{stroke:{value:v,scale:"auto"}},...p&&{symbol:{value:x,scale:"auto"}},...Object.fromEntries(t.map((({name:t,output:n})=>[t,{scale:"auto",label:n.label,radius:"r"===t?e/2:void 0,value:n.transform()}])))}}}))},t.hexgrid=function(t){return new Wu(t)},t.hull=function(t,e){return $u(xu,t,e)},t.identity=X,t.image=function(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=kt(e,n)),new Fu(t,{...r,x:e,y:n})},t.indexOf=G,t.initializer=xe,t.interpolateNearest=Kc,t.interpolateNone=Vc,t.interpolatorBarycentric=Zc,t.interpolatorRandomWalk=tu,t.legend=function(t={}){for(const[e,n]of qa){const r=t[e];if(vt(r)){const o=Zn(t);let i;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&vt(t.color)?"color":void 0)}=t;i={fill:e,stroke:n}}return n(lo(e,r,i),Fa(o,r,t),(e=>vt(t[e])?lo(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")},t.line=Gs,t.lineX=Xs,t.lineY=Us,t.linearRegressionX=function(t,{y:e=G,x:n=X,stroke:r,fill:o=(Qt(r)?"currentColor":r),...i}={}){return new Zu(t,Cl({...i,x:n,y:e,fill:o,stroke:r}))},t.linearRegressionY=function(t,{x:e=G,y:n=X,stroke:r,fill:o=(Qt(r)?"currentColor":r),...i}={}){return new Qu(t,Rl({...i,x:e,y:n,fill:o,stroke:r}))},t.link=Ls,t.map=uc,t.mapX=sc,t.mapY=cc,t.marks=Io,t.normalize=ch,t.normalizeX=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),sc(ch(t),e)},t.normalizeY=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),cc(ch(t),e)},t.plot=il,t.pointer=Do,t.pointerX=Yo,t.pointerY=_o,t.raster=function(){const[t,e]=Gc("fill",...arguments);return new _c(t,null==t||void 0!==e.fill||void 0!==e.fillOpacity?e:{...e,fill:X})},t.rect=Zs,t.rectX=Qs,t.rectY=Js,t.reverse=function({sort:t,...e}={}){return{...ke(e,Me),sort:wt(t)?t:null}},t.ruleX=bi,t.ruleY=ki,t.scale=function(t={}){let e;for(const n in t)if(ue.has(n)&&vt(t[n])){if(void 0!==e)throw new Error("ambiguous scale definition; multiple scales found");e=xo(lo(n,t[n]))}if(void 0===e)throw new Error("invalid scale definition; no scale found");return e},t.select=function(t,e={}){if("string"==typeof t)switch(t.toLowerCase()){case"first":return kh(e);case"last":return $h(e)}if("function"==typeof t)return zh(null,t,e);let n,r;for(n in t){if(void 0!==r)throw new Error("ambiguous selector; multiple inputs");r=bh(t[n])}if(void 0===r)throw new Error(`invalid selector: ${t}`);return zh(n,r,e)},t.selectFirst=kh,t.selectLast=$h,t.selectMaxX=function(t){return zh("x",Sh,t)},t.selectMaxY=function(t){return zh("y",Sh,t)},t.selectMinX=function(t){return zh("x",Ah,t)},t.selectMinY=function(t){return zh("y",Ah,t)},t.shiftX=function(t,n){return function(t,n,r={}){let o,i=1;if("number"==typeof n)i=n,o=(t,e)=>+t+e;else{if("string"==typeof n){const t=n.startsWith("-")?-1:1;[n,i]=O(n.replace(/^[+-]/,"")),i*=t}n=It(n),o=(t,e)=>n.offset(t,e)}const a=`${t}2`,l=uc({[`${t}1`]:t=>t.map((t=>o(t,i))),[a]:t=>t},r),s=l[a].transform;return l[a].transform=()=>{const t=s(),[n,r]=e.extent(t);return t.domain=i<0?[n,o(r,i)]:[o(n,i),r],t},l}("x",t,n)},t.shuffle=function({seed:t,sort:n,...r}={}){return{...ke(r,ze(null==t?Math.random:e.randomLcg(t))),sort:wt(n)?n:null}},t.sort=Le,t.sphere=function({strokeWidth:t=1.5,...e}={}){return Tu({type:"Sphere"},{strokeWidth:t,...e})},t.spike=function(t,e={}){const{shape:n=ta,stroke:r=Zi.stroke,strokeWidth:o=1,fill:i=r,fillOpacity:a=.3,anchor:l="start",...s}=e;return ra(t,{...s,shape:n,stroke:r,strokeWidth:o,fill:i,fillOpacity:a,anchor:l})},t.stackX=es,t.stackX1=function(t={},e={}){1===arguments.length&&([t,e]=is(t));const{y1:n,y:r=n,x:o}=e,[i,a,l]=ls(r,o,"y","x",t,e);return{...i,y1:n,y:a,x:l}},t.stackX2=function(t={},e={}){1===arguments.length&&([t,e]=is(t));const{y1:n,y:r=n,x:o}=e,[i,a,,l]=ls(r,o,"y","x",t,e);return{...i,y1:n,y:a,x:l}},t.stackY=ns,t.stackY1=function(t={},e={}){1===arguments.length&&([t,e]=is(t));const{x1:n,x:r=n,y:o}=e,[i,a,l]=ls(r,o,"x","y",t,e);return{...i,x1:n,x:a,y:l}},t.stackY2=function(t={},e={}){1===arguments.length&&([t,e]=is(t));const{x1:n,x:r=n,y:o}=e,[i,a,,l]=ls(r,o,"x","y",t,e);return{...i,x1:n,x:a,y:l}},t.text=Ei,t.textX=Ri,t.textY=Ci,t.tickX=Tc,t.tickY=Bc,t.tip=Qa,t.transform=ve,t.tree=Af,t.treeLink=ef,t.treeNode=tf,t.valueof=q,t.vector=ra,t.vectorX=oa,t.vectorY=ia,t.version="0.6.13",t.voronoi=function(t,e){return $u(wu,t,e)},t.voronoiMesh=function(t,e){return $u(bu,t,e)},t.window=pc,t.windowX=function(t={},e){return 1===arguments.length&&(e=t),sc(pc(t),e)},t.windowY=function(t={},e){return 1===arguments.length&&(e=t),cc(pc(t),e)}}));
